==== RUNNING BASELINE FOR 1024 WITH fp32 ====
2025-05-23 16:25:06,461 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_1024/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-23 16:25:06,463 - root - INFO - Setting up DataLoaders...
2025-05-23 16:25:07,580 - root - INFO - Setting up Model...
2025-05-23 16:25:14,234 - root - INFO - Starting training!
2025-05-23 16:25:14,686 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 2276.45 | Training tokens per second (%): 77.54 | MFU (%): 0.95 | TFLOPs: 9.40
2025-05-23 16:25:15,193 - root - INFO - Step: 5 | Loss: 11.88 | Tokens per second: 8128.75 | Training tokens per second (%): 40.14 | MFU (%): 3.39 | TFLOPs: 33.55
2025-05-23 16:25:15,812 - root - INFO - Step: 10 | Loss: 11.77 | Tokens per second: 8311.11 | Training tokens per second (%): 83.77 | MFU (%): 3.47 | TFLOPs: 34.30
2025-05-23 16:25:16,437 - root - INFO - Step: 15 | Loss: 11.39 | Tokens per second: 8240.40 | Training tokens per second (%): 57.17 | MFU (%): 3.44 | TFLOPs: 34.01
2025-05-23 16:25:17,059 - root - INFO - Step: 20 | Loss: 11.16 | Tokens per second: 8266.81 | Training tokens per second (%): 75.68 | MFU (%): 3.45 | TFLOPs: 34.12
2025-05-23 16:25:22,100 - root - INFO - Checkpoint saved in 5.0403 seconds
2025-05-23 16:25:22,100 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:25:22,736 - root - INFO - Step: 25 | Loss: 10.91 | Tokens per second: 902.44 | Training tokens per second (%): 70.53 | MFU (%): 0.38 | TFLOPs: 3.72
2025-05-23 16:25:23,358 - root - INFO - Step: 30 | Loss: 10.38 | Tokens per second: 8262.91 | Training tokens per second (%): 68.73 | MFU (%): 3.45 | TFLOPs: 34.11
2025-05-23 16:25:23,971 - root - INFO - Step: 35 | Loss: 10.48 | Tokens per second: 8392.26 | Training tokens per second (%): 49.82 | MFU (%): 3.50 | TFLOPs: 34.64
2025-05-23 16:25:24,586 - root - INFO - Step: 40 | Loss: 10.70 | Tokens per second: 8371.33 | Training tokens per second (%): 39.80 | MFU (%): 3.49 | TFLOPs: 34.55
2025-05-23 16:25:29,529 - root - INFO - Checkpoint saved in 4.9429 seconds
2025-05-23 16:25:29,530 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:25:30,166 - root - INFO - Step: 45 | Loss: 10.09 | Tokens per second: 918.07 | Training tokens per second (%): 62.34 | MFU (%): 0.38 | TFLOPs: 3.79
2025-05-23 16:25:30,777 - root - INFO - Step: 50 | Loss: 10.19 | Tokens per second: 8410.95 | Training tokens per second (%): 40.70 | MFU (%): 3.51 | TFLOPs: 34.72
2025-05-23 16:25:31,397 - root - INFO - Step: 55 | Loss: 10.62 | Tokens per second: 8304.09 | Training tokens per second (%): 71.37 | MFU (%): 3.47 | TFLOPs: 34.28
2025-05-23 16:25:32,013 - root - INFO - Step: 60 | Loss: 10.21 | Tokens per second: 8343.54 | Training tokens per second (%): 79.02 | MFU (%): 3.48 | TFLOPs: 34.44
2025-05-23 16:25:36,644 - root - INFO - Checkpoint saved in 4.6306 seconds
2025-05-23 16:25:36,645 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:25:37,285 - root - INFO - Step: 65 | Loss: 10.43 | Tokens per second: 971.72 | Training tokens per second (%): 73.18 | MFU (%): 0.41 | TFLOPs: 4.01
2025-05-23 16:25:37,910 - root - INFO - Step: 70 | Loss: 10.13 | Tokens per second: 8229.99 | Training tokens per second (%): 44.98 | MFU (%): 3.43 | TFLOPs: 33.97
2025-05-23 16:25:38,528 - root - INFO - Step: 75 | Loss: 9.77 | Tokens per second: 8332.76 | Training tokens per second (%): 46.62 | MFU (%): 3.48 | TFLOPs: 34.39
2025-05-23 16:25:39,143 - root - INFO - Step: 80 | Loss: 9.82 | Tokens per second: 8362.34 | Training tokens per second (%): 57.97 | MFU (%): 3.49 | TFLOPs: 34.52
2025-05-23 16:25:43,781 - root - INFO - Checkpoint saved in 4.6378 seconds
2025-05-23 16:25:43,782 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:25:44,388 - root - INFO - Step: 85 | Loss: 10.02 | Tokens per second: 976.71 | Training tokens per second (%): 64.18 | MFU (%): 0.41 | TFLOPs: 4.03
2025-05-23 16:25:45,015 - root - INFO - Step: 90 | Loss: 9.72 | Tokens per second: 8206.27 | Training tokens per second (%): 93.67 | MFU (%): 3.42 | TFLOPs: 33.87
2025-05-23 16:25:45,658 - root - INFO - Step: 95 | Loss: 9.57 | Tokens per second: 7992.53 | Training tokens per second (%): 88.40 | MFU (%): 3.34 | TFLOPs: 32.99
2025-05-23 16:25:46,311 - root - INFO - Step: 100 | Loss: 9.60 | Tokens per second: 7882.57 | Training tokens per second (%): 100.00 | MFU (%): 3.29 | TFLOPs: 32.54
2025-05-23 16:25:50,953 - root - INFO - Checkpoint saved in 4.6416 seconds
2025-05-23 16:25:50,954 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:25:51,581 - root - INFO - Step: 105 | Loss: 9.71 | Tokens per second: 972.07 | Training tokens per second (%): 46.11 | MFU (%): 0.41 | TFLOPs: 4.01
2025-05-23 16:25:52,214 - root - INFO - Step: 110 | Loss: 9.80 | Tokens per second: 8128.21 | Training tokens per second (%): 43.05 | MFU (%): 3.39 | TFLOPs: 33.55
2025-05-23 16:25:52,831 - root - INFO - Step: 115 | Loss: 9.60 | Tokens per second: 8334.04 | Training tokens per second (%): 39.90 | MFU (%): 3.48 | TFLOPs: 34.40
2025-05-23 16:25:53,451 - root - INFO - Step: 120 | Loss: 9.42 | Tokens per second: 8296.88 | Training tokens per second (%): 66.80 | MFU (%): 3.46 | TFLOPs: 34.25
2025-05-23 16:25:58,067 - root - INFO - Checkpoint saved in 4.6156 seconds
2025-05-23 16:25:58,069 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:25:58,712 - root - INFO - Step: 125 | Loss: 9.76 | Tokens per second: 973.73 | Training tokens per second (%): 58.54 | MFU (%): 0.41 | TFLOPs: 4.02
2025-05-23 16:25:59,338 - root - INFO - Step: 130 | Loss: 9.75 | Tokens per second: 8219.65 | Training tokens per second (%): 42.27 | MFU (%): 3.43 | TFLOPs: 33.93
2025-05-23 16:25:59,959 - root - INFO - Step: 135 | Loss: 9.21 | Tokens per second: 8283.50 | Training tokens per second (%): 63.54 | MFU (%): 3.46 | TFLOPs: 34.19
2025-05-23 16:26:00,579 - root - INFO - Step: 140 | Loss: 9.29 | Tokens per second: 8300.19 | Training tokens per second (%): 45.02 | MFU (%): 3.46 | TFLOPs: 34.26
2025-05-23 16:26:05,201 - root - INFO - Checkpoint saved in 4.6215 seconds
2025-05-23 16:26:05,202 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:26:05,838 - root - INFO - Step: 145 | Loss: 8.96 | Tokens per second: 974.09 | Training tokens per second (%): 59.90 | MFU (%): 0.41 | TFLOPs: 4.02
2025-05-23 16:26:06,451 - root - INFO - Step: 150 | Loss: 9.42 | Tokens per second: 8392.34 | Training tokens per second (%): 67.87 | MFU (%): 3.50 | TFLOPs: 34.64
2025-05-23 16:26:07,081 - root - INFO - Step: 155 | Loss: 9.29 | Tokens per second: 8165.17 | Training tokens per second (%): 87.15 | MFU (%): 3.41 | TFLOPs: 33.70
2025-05-23 16:26:07,698 - root - INFO - Step: 160 | Loss: 8.70 | Tokens per second: 8344.48 | Training tokens per second (%): 64.86 | MFU (%): 3.48 | TFLOPs: 34.44
2025-05-23 16:26:12,325 - root - INFO - Checkpoint saved in 4.6269 seconds
2025-05-23 16:26:12,326 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:26:12,972 - root - INFO - Step: 165 | Loss: 8.94 | Tokens per second: 971.24 | Training tokens per second (%): 45.74 | MFU (%): 0.41 | TFLOPs: 4.01
2025-05-23 16:26:13,600 - root - INFO - Step: 170 | Loss: 9.24 | Tokens per second: 8193.63 | Training tokens per second (%): 78.38 | MFU (%): 3.42 | TFLOPs: 33.82
2025-05-23 16:26:14,224 - root - INFO - Step: 175 | Loss: 9.17 | Tokens per second: 8243.29 | Training tokens per second (%): 57.73 | MFU (%): 3.44 | TFLOPs: 34.02
2025-05-23 16:26:14,844 - root - INFO - Step: 180 | Loss: 8.85 | Tokens per second: 8300.17 | Training tokens per second (%): 58.32 | MFU (%): 3.46 | TFLOPs: 34.26
2025-05-23 16:26:19,469 - root - INFO - Checkpoint saved in 4.6244 seconds
2025-05-23 16:26:19,470 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:26:20,108 - root - INFO - Step: 185 | Loss: 9.23 | Tokens per second: 973.20 | Training tokens per second (%): 50.92 | MFU (%): 0.41 | TFLOPs: 4.02
2025-05-23 16:26:20,735 - root - INFO - Step: 190 | Loss: 8.84 | Tokens per second: 8210.08 | Training tokens per second (%): 62.42 | MFU (%): 3.43 | TFLOPs: 33.89
2025-05-23 16:26:21,378 - root - INFO - Step: 195 | Loss: 8.71 | Tokens per second: 7993.11 | Training tokens per second (%): 50.66 | MFU (%): 3.34 | TFLOPs: 32.99
2025-05-23 16:26:21,999 - root - INFO - Step: 200 | Loss: 9.07 | Tokens per second: 8291.29 | Training tokens per second (%): 52.85 | MFU (%): 3.46 | TFLOPs: 34.22
2025-05-23 16:26:26,626 - root - INFO - Checkpoint saved in 4.6276 seconds
2025-05-23 16:26:26,628 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:26:27,258 - root - INFO - Step: 205 | Loss: 8.34 | Tokens per second: 973.96 | Training tokens per second (%): 38.81 | MFU (%): 0.41 | TFLOPs: 4.02
2025-05-23 16:26:27,877 - root - INFO - Step: 210 | Loss: 8.65 | Tokens per second: 8310.82 | Training tokens per second (%): 67.71 | MFU (%): 3.47 | TFLOPs: 34.30
2025-05-23 16:26:28,493 - root - INFO - Step: 215 | Loss: 8.52 | Tokens per second: 8350.79 | Training tokens per second (%): 48.05 | MFU (%): 3.49 | TFLOPs: 34.47
2025-05-23 16:26:29,111 - root - INFO - Step: 220 | Loss: 8.75 | Tokens per second: 8327.33 | Training tokens per second (%): 47.36 | MFU (%): 3.48 | TFLOPs: 34.37
2025-05-23 16:26:33,721 - root - INFO - Checkpoint saved in 4.6094 seconds
2025-05-23 16:26:33,722 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:26:34,361 - root - INFO - Step: 225 | Loss: 8.38 | Tokens per second: 975.84 | Training tokens per second (%): 59.55 | MFU (%): 0.41 | TFLOPs: 4.03
2025-05-23 16:26:34,978 - root - INFO - Step: 230 | Loss: 8.25 | Tokens per second: 8335.00 | Training tokens per second (%): 25.08 | MFU (%): 3.48 | TFLOPs: 34.40
2025-05-23 16:26:35,598 - root - INFO - Step: 235 | Loss: 8.53 | Tokens per second: 8295.07 | Training tokens per second (%): 43.71 | MFU (%): 3.46 | TFLOPs: 34.24
2025-05-23 16:26:36,225 - root - INFO - Step: 240 | Loss: 8.33 | Tokens per second: 8202.80 | Training tokens per second (%): 71.23 | MFU (%): 3.42 | TFLOPs: 33.86
2025-05-23 16:26:40,848 - root - INFO - Checkpoint saved in 4.6220 seconds
2025-05-23 16:26:40,849 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:26:41,499 - root - INFO - Step: 245 | Loss: 8.39 | Tokens per second: 971.50 | Training tokens per second (%): 58.46 | MFU (%): 0.41 | TFLOPs: 4.01
2025-05-23 16:26:42,136 - root - INFO - Step: 250 | Loss: 8.54 | Tokens per second: 8066.70 | Training tokens per second (%): 53.71 | MFU (%): 3.37 | TFLOPs: 33.30
2025-05-23 16:26:42,757 - root - INFO - Step: 255 | Loss: 9.02 | Tokens per second: 8281.37 | Training tokens per second (%): 42.27 | MFU (%): 3.46 | TFLOPs: 34.18
2025-05-23 16:26:43,383 - root - INFO - Step: 260 | Loss: 9.25 | Tokens per second: 8227.21 | Training tokens per second (%): 60.08 | MFU (%): 3.43 | TFLOPs: 33.96
2025-05-23 16:26:47,997 - root - INFO - Checkpoint saved in 4.6146 seconds
2025-05-23 16:26:47,999 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:26:48,631 - root - INFO - Step: 265 | Loss: 8.47 | Tokens per second: 976.08 | Training tokens per second (%): 50.68 | MFU (%): 0.41 | TFLOPs: 4.03
2025-05-23 16:26:49,249 - root - INFO - Step: 270 | Loss: 8.31 | Tokens per second: 8321.56 | Training tokens per second (%): 68.73 | MFU (%): 3.47 | TFLOPs: 34.35
2025-05-23 16:26:49,868 - root - INFO - Step: 275 | Loss: 8.55 | Tokens per second: 8310.10 | Training tokens per second (%): 47.05 | MFU (%): 3.47 | TFLOPs: 34.30
2025-05-23 16:26:50,492 - root - INFO - Step: 280 | Loss: 8.11 | Tokens per second: 8243.91 | Training tokens per second (%): 65.78 | MFU (%): 3.44 | TFLOPs: 34.03
2025-05-23 16:26:55,104 - root - INFO - Checkpoint saved in 4.6111 seconds
2025-05-23 16:26:55,105 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:26:55,749 - root - INFO - Step: 285 | Loss: 8.56 | Tokens per second: 974.62 | Training tokens per second (%): 73.09 | MFU (%): 0.41 | TFLOPs: 4.02
2025-05-23 16:26:56,371 - root - INFO - Step: 290 | Loss: 8.14 | Tokens per second: 8261.30 | Training tokens per second (%): 54.63 | MFU (%): 3.45 | TFLOPs: 34.10
2025-05-23 16:26:56,991 - root - INFO - Step: 295 | Loss: 7.91 | Tokens per second: 8302.66 | Training tokens per second (%): 44.59 | MFU (%): 3.47 | TFLOPs: 34.27
2025-05-23 16:26:57,632 - root - INFO - Step: 300 | Loss: 7.98 | Tokens per second: 8023.07 | Training tokens per second (%): 83.14 | MFU (%): 3.35 | TFLOPs: 33.12
2025-05-23 16:27:02,252 - root - INFO - Checkpoint saved in 4.6198 seconds
2025-05-23 16:27:02,254 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:27:02,903 - root - INFO - Step: 305 | Loss: 8.81 | Tokens per second: 971.90 | Training tokens per second (%): 64.26 | MFU (%): 0.41 | TFLOPs: 4.01
2025-05-23 16:27:03,522 - root - INFO - Step: 310 | Loss: 8.46 | Tokens per second: 8310.65 | Training tokens per second (%): 58.93 | MFU (%): 3.47 | TFLOPs: 34.30
2025-05-23 16:27:04,146 - root - INFO - Step: 315 | Loss: 7.74 | Tokens per second: 8247.76 | Training tokens per second (%): 64.43 | MFU (%): 3.44 | TFLOPs: 34.04
2025-05-23 16:27:04,770 - root - INFO - Step: 320 | Loss: 8.35 | Tokens per second: 8238.82 | Training tokens per second (%): 73.79 | MFU (%): 3.44 | TFLOPs: 34.01
2025-05-23 16:27:09,392 - root - INFO - Checkpoint saved in 4.6220 seconds
2025-05-23 16:27:09,394 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:27:10,046 - root - INFO - Step: 325 | Loss: 8.13 | Tokens per second: 970.92 | Training tokens per second (%): 49.69 | MFU (%): 0.41 | TFLOPs: 4.01
2025-05-23 16:27:10,673 - root - INFO - Step: 330 | Loss: 7.10 | Tokens per second: 8206.26 | Training tokens per second (%): 60.96 | MFU (%): 3.42 | TFLOPs: 33.87
2025-05-23 16:27:11,293 - root - INFO - Step: 335 | Loss: 8.48 | Tokens per second: 8307.66 | Training tokens per second (%): 24.41 | MFU (%): 3.47 | TFLOPs: 34.29
2025-05-23 16:27:11,912 - root - INFO - Step: 340 | Loss: 8.33 | Tokens per second: 8301.34 | Training tokens per second (%): 59.49 | MFU (%): 3.46 | TFLOPs: 34.26
2025-05-23 16:27:16,524 - root - INFO - Checkpoint saved in 4.6115 seconds
2025-05-23 16:27:16,525 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:27:17,168 - root - INFO - Step: 345 | Loss: 8.23 | Tokens per second: 974.66 | Training tokens per second (%): 63.32 | MFU (%): 0.41 | TFLOPs: 4.02
2025-05-23 16:27:17,791 - root - INFO - Step: 350 | Loss: 8.22 | Tokens per second: 8264.88 | Training tokens per second (%): 62.03 | MFU (%): 3.45 | TFLOPs: 34.11
2025-05-23 16:27:18,414 - root - INFO - Step: 355 | Loss: 8.13 | Tokens per second: 8250.74 | Training tokens per second (%): 36.93 | MFU (%): 3.44 | TFLOPs: 34.06
2025-05-23 16:27:19,040 - root - INFO - Step: 360 | Loss: 7.73 | Tokens per second: 8215.42 | Training tokens per second (%): 72.48 | MFU (%): 3.43 | TFLOPs: 33.91
2025-05-23 16:27:23,657 - root - INFO - Checkpoint saved in 4.6165 seconds
2025-05-23 16:27:23,659 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:27:24,304 - root - INFO - Step: 365 | Loss: 7.91 | Tokens per second: 973.27 | Training tokens per second (%): 82.03 | MFU (%): 0.41 | TFLOPs: 4.02
2025-05-23 16:27:24,930 - root - INFO - Step: 370 | Loss: 7.59 | Tokens per second: 8222.43 | Training tokens per second (%): 70.29 | MFU (%): 3.43 | TFLOPs: 33.94
2025-05-23 16:27:25,567 - root - INFO - Step: 375 | Loss: 8.38 | Tokens per second: 8066.90 | Training tokens per second (%): 91.58 | MFU (%): 3.37 | TFLOPs: 33.30
2025-05-23 16:27:26,213 - root - INFO - Step: 380 | Loss: 7.42 | Tokens per second: 7969.66 | Training tokens per second (%): 66.46 | MFU (%): 3.33 | TFLOPs: 32.90
2025-05-23 16:27:30,821 - root - INFO - Checkpoint saved in 4.6077 seconds
2025-05-23 16:27:30,822 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:27:31,470 - root - INFO - Step: 385 | Loss: 7.79 | Tokens per second: 974.39 | Training tokens per second (%): 48.44 | MFU (%): 0.41 | TFLOPs: 4.02
2025-05-23 16:27:32,096 - root - INFO - Step: 390 | Loss: 7.59 | Tokens per second: 8216.41 | Training tokens per second (%): 63.48 | MFU (%): 3.43 | TFLOPs: 33.91
2025-05-23 16:27:32,719 - root - INFO - Step: 395 | Loss: 7.94 | Tokens per second: 8261.50 | Training tokens per second (%): 73.14 | MFU (%): 3.45 | TFLOPs: 34.10
2025-05-23 16:27:33,347 - root - INFO - Step: 400 | Loss: 7.72 | Tokens per second: 8191.09 | Training tokens per second (%): 53.57 | MFU (%): 3.42 | TFLOPs: 33.81
2025-05-23 16:27:37,946 - root - INFO - Checkpoint saved in 4.5986 seconds
2025-05-23 16:27:37,947 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:27:37,947 - root - INFO - Training completed
2025-05-23 16:27:37,947 - root - INFO - Training run end: total time taken 143.71 seconds
==== BASELINE END ====
==== RUNNING PCCHECK FOR 1024 WITH fp32 ====
2025-05-23 16:27:42,243 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_1024/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-23 16:27:42,246 - root - INFO - Setting up DataLoaders...
2025-05-23 16:27:43,146 - root - INFO - Setting up Model...
Model size: 755041280, Optimizer size: 1510082852, Total size: 2265124132
BSIZE IS 2265124132
At checkpoint, bsize is 2265124132
2025-05-23 16:28:22,322 - root - INFO - Checkpointing warmup done
2025-05-23 16:28:22,323 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 16:28:22,647 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 3189.97 | Training tokens per second (%): 77.54 | MFU (%): 1.33 | TFLOPs: 13.17
2025-05-23 16:28:23,147 - root - INFO - Step: 5 | Loss: 11.89 | Tokens per second: 8246.89 | Training tokens per second (%): 40.14 | MFU (%): 3.44 | TFLOPs: 34.04
2025-05-23 16:28:23,739 - root - INFO - Step: 10 | Loss: 11.78 | Tokens per second: 8693.70 | Training tokens per second (%): 83.77 | MFU (%): 3.63 | TFLOPs: 35.88
2025-05-23 16:28:24,340 - root - INFO - Step: 15 | Loss: 11.40 | Tokens per second: 8557.89 | Training tokens per second (%): 57.17 | MFU (%): 3.57 | TFLOPs: 35.32
2025-05-23 16:28:24,949 - root - INFO - Step: 20 | Loss: 11.17 | Tokens per second: 8443.71 | Training tokens per second (%): 75.68 | MFU (%): 3.52 | TFLOPs: 34.85
2025-05-23 16:28:24,968 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:24,969 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:25,624 - root - INFO - Step: 25 | Loss: 10.91 | Tokens per second: 7620.41 | Training tokens per second (%): 70.53 | MFU (%): 3.18 | TFLOPs: 31.45
2025-05-23 16:28:26,287 - root - INFO - Step: 30 | Loss: 10.38 | Tokens per second: 7749.85 | Training tokens per second (%): 68.73 | MFU (%): 3.23 | TFLOPs: 31.99
2025-05-23 16:28:26,939 - root - INFO - Step: 35 | Loss: 10.48 | Tokens per second: 7900.21 | Training tokens per second (%): 49.82 | MFU (%): 3.30 | TFLOPs: 32.61
2025-05-23 16:28:27,537 - root - INFO - Step: 40 | Loss: 10.70 | Tokens per second: 8605.28 | Training tokens per second (%): 39.80 | MFU (%): 3.59 | TFLOPs: 35.52
2025-05-23 16:28:27,555 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:27,556 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:28,219 - root - INFO - Step: 45 | Loss: 10.09 | Tokens per second: 7533.03 | Training tokens per second (%): 62.34 | MFU (%): 3.14 | TFLOPs: 31.09
2025-05-23 16:28:28,865 - root - INFO - Step: 50 | Loss: 10.18 | Tokens per second: 7963.05 | Training tokens per second (%): 40.70 | MFU (%): 3.32 | TFLOPs: 32.87
2025-05-23 16:28:29,501 - root - INFO - Step: 55 | Loss: 10.62 | Tokens per second: 8094.60 | Training tokens per second (%): 71.37 | MFU (%): 3.38 | TFLOPs: 33.41
2025-05-23 16:28:30,106 - root - INFO - Step: 60 | Loss: 10.20 | Tokens per second: 8509.42 | Training tokens per second (%): 79.02 | MFU (%): 3.55 | TFLOPs: 35.12
2025-05-23 16:28:30,124 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:30,125 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:30,778 - root - INFO - Step: 65 | Loss: 10.42 | Tokens per second: 7651.59 | Training tokens per second (%): 73.18 | MFU (%): 3.19 | TFLOPs: 31.58
2025-05-23 16:28:31,432 - root - INFO - Step: 70 | Loss: 10.13 | Tokens per second: 7862.74 | Training tokens per second (%): 44.98 | MFU (%): 3.28 | TFLOPs: 32.45
2025-05-23 16:28:32,085 - root - INFO - Step: 75 | Loss: 9.77 | Tokens per second: 7877.80 | Training tokens per second (%): 46.62 | MFU (%): 3.29 | TFLOPs: 32.52
2025-05-23 16:28:32,695 - root - INFO - Step: 80 | Loss: 9.82 | Tokens per second: 8433.45 | Training tokens per second (%): 57.97 | MFU (%): 3.52 | TFLOPs: 34.81
2025-05-23 16:28:32,713 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:32,715 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:33,376 - root - INFO - Step: 85 | Loss: 10.01 | Tokens per second: 7556.27 | Training tokens per second (%): 64.18 | MFU (%): 3.15 | TFLOPs: 31.19
2025-05-23 16:28:34,071 - root - INFO - Step: 90 | Loss: 9.72 | Tokens per second: 7394.74 | Training tokens per second (%): 93.67 | MFU (%): 3.09 | TFLOPs: 30.52
2025-05-23 16:28:34,766 - root - INFO - Step: 95 | Loss: 9.56 | Tokens per second: 7398.07 | Training tokens per second (%): 88.40 | MFU (%): 3.09 | TFLOPs: 30.54
2025-05-23 16:28:35,407 - root - INFO - Step: 100 | Loss: 9.59 | Tokens per second: 8026.55 | Training tokens per second (%): 100.00 | MFU (%): 3.35 | TFLOPs: 33.13
2025-05-23 16:28:35,426 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:35,427 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:36,091 - root - INFO - Step: 105 | Loss: 9.71 | Tokens per second: 7520.56 | Training tokens per second (%): 46.11 | MFU (%): 3.14 | TFLOPs: 31.04
2025-05-23 16:28:36,775 - root - INFO - Step: 110 | Loss: 9.80 | Tokens per second: 7515.84 | Training tokens per second (%): 43.05 | MFU (%): 3.14 | TFLOPs: 31.02
2025-05-23 16:28:37,437 - root - INFO - Step: 115 | Loss: 9.60 | Tokens per second: 7766.91 | Training tokens per second (%): 39.90 | MFU (%): 3.24 | TFLOPs: 32.06
2025-05-23 16:28:38,047 - root - INFO - Step: 120 | Loss: 9.41 | Tokens per second: 8440.75 | Training tokens per second (%): 66.80 | MFU (%): 3.52 | TFLOPs: 34.84
2025-05-23 16:28:38,066 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:38,067 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x400840280000, PR_ADDR is 0x400840000000, PEER_CHECK_ADDR is 0x400840080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 2265124132
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400840180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 83, parall_iter is 0, num_threads is 4, last counter is 0, curr_counter is 1
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400840280000, curr_pr_arr is 0x400840280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400840280000!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008c72b0e00!
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40094e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009d5312a00!
Thread ID: 4, savenvm_thread_nd took 1688.151264 ms
Thread ID: 4, set_cpu took 0.059263 ms
Thread ID: 1, savenvm_thread_nd took 1691.742485 ms
Thread ID: 1, set_cpu took 0.087357 ms
Thread ID: 2, savenvm_thread_nd took 1702.981893 ms
Thread ID: 2, set_cpu took 0.060798 ms
Thread ID: 3, savenvm_thread_nd took 1703.270300 ms
Thread ID: 3, set_cpu took 0.062270 ms
Threads took 1703.511316 ms
MSYNC 9060496528 TOOK 337.816999 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400840180000, curr_checkpoint is 0x400840180000
0, 1
Parall_iter 1, Write new metadata at address 0x400840200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 89, parall_iter is 1, num_threads is 4, last counter is 1, curr_counter is 2
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a5c350000, curr_pr_arr is 0x400a5c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ae3380e00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a5c350000!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b6a3b1c00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bf13e2a00!
Thread ID: 5, savenvm_thread_nd took 1609.177235 ms
Thread ID: 5, set_cpu took 0.085053 ms
Thread ID: 8, savenvm_thread_nd took 1620.887125 ms
Thread ID: 8, set_cpu took 0.056671 ms
Thread ID: 6, savenvm_thread_nd took 1622.127089 ms
Thread ID: 6, set_cpu took 0.059038 ms
Thread ID: 7, savenvm_thread_nd took 1624.375214 ms
Thread ID: 7, set_cpu took 0.056638 ms
Threads took 1624.567272 ms
MSYNC 9060496528 TOOK 409.706951 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400840200000, curr_checkpoint is 0x400840200000
1, 2
Parall_iter 0, Write new metadata at address 0x400840180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 95, parall_iter is 0, num_threads is 4, last counter is 2, curr_counter is 3
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400840280000, curr_pr_arr is 0x400840280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008c72b0e00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400840280000!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40094e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009d5312a00!
Thread ID: 4, savenvm_thread_nd took 1666.485317 ms
Thread ID: 4, set_cpu took 0.051519 ms
Thread ID: 1, savenvm_thread_nd took 1669.775075 ms
Thread ID: 1, set_cpu took 0.084862 ms
Thread ID: 2, savenvm_thread_nd took 1680.585601 ms
Thread ID: 2, set_cpu took 0.063167 ms
Thread ID: 3, savenvm_thread_nd took 1682.048982 ms
Thread ID: 3, set_cpu took 0.045790 ms
Threads took 1682.218129 ms
MSYNC 9060496528 TOOK 387.782806 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400840180000, curr_checkpoint is 0x400840180000
0, 3
Parall_iter 1, Write new metadata at address 0x400840200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 101, parall_iter is 1, num_threads is 4, last counter is 3, curr_counter is 4
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a5c350000, curr_pr_arr is 0x400a5c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ae3380e00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a5c350000!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b6a3b1c00!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bf13e2a00!
Thread ID: 5, savenvm_thread_nd took 1802.272180 ms
Thread ID: 5, set_cpu took 0.087390 ms
Thread ID: 8, savenvm_thread_nd took 1810.176553 ms
Thread ID: 8, set_cpu took 0.052383 ms
Thread ID: 6, savenvm_thread_nd took 1820.843179 ms
Thread ID: 6, set_cpu took 0.068606 ms
Thread ID: 7, savenvm_thread_nd took 1822.506362 ms
Thread ID: 7, set_cpu took 0.045822 ms
Threads took 1822.823473 ms
MSYNC 9060496528 TOOK 333.802751 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400840200000, curr_checkpoint is 0x400840200000
1, 4
Parall_iter 0, Write new metadata at address 0x400840180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 1, parall_iter is 0, num_threads is 4, last counter is 4, curr_counter is 5
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400840280000, curr_pr_arr is 0x400840280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 1, CPU USE: 11
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40094e2e1c00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400840280000!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008c72b0e00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009d5312a00!
Thread ID: 4, savenvm_thread_nd took 1809.232582 ms
Thread ID: 4, set_cpu took 0.052671 ms
Thread ID: 1, savenvm_thread_nd took 1813.052564 ms
Thread ID: 1, set_cpu took 0.088573 ms
Thread ID: 2, savenvm_thread_nd took 1826.010161 ms
Thread ID: 2, set_cpu took 0.078110 ms
Thread ID: 3, savenvm_thread_nd took 1826.327431 ms
Thread ID: 3, set_cpu took 0.053502 ms
Threads took 1826.487970 ms
MSYNC 9060496528 TOOK 386.269667 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400840180000, curr_checkpoint is 0x400840180000
0, 5
Parall_iter 1, Write new metadata at address 0x400840200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 14, parall_iter is 1, num_threads is 4, last counter is 5, curr_counter is 6
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a5c3502025-05-23 16:28:38,736 - root - INFO - Step: 125 | Loss: 9.76 | Tokens per second: 7461.34 | Training tokens per second (%): 58.54 | MFU (%): 3.11 | TFLOPs: 30.80
2025-05-23 16:28:39,404 - root - INFO - Step: 130 | Loss: 9.75 | Tokens per second: 7702.29 | Training tokens per second (%): 42.27 | MFU (%): 3.21 | TFLOPs: 31.79
2025-05-23 16:28:40,085 - root - INFO - Step: 135 | Loss: 9.20 | Tokens per second: 7549.41 | Training tokens per second (%): 63.54 | MFU (%): 3.15 | TFLOPs: 31.16
2025-05-23 16:28:40,719 - root - INFO - Step: 140 | Loss: 9.28 | Tokens per second: 8111.19 | Training tokens per second (%): 45.02 | MFU (%): 3.39 | TFLOPs: 33.48
2025-05-23 16:28:40,738 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:40,739 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:41,430 - root - INFO - Step: 145 | Loss: 8.96 | Tokens per second: 7235.78 | Training tokens per second (%): 59.90 | MFU (%): 3.02 | TFLOPs: 29.87
2025-05-23 16:28:42,109 - root - INFO - Step: 150 | Loss: 9.42 | Tokens per second: 7572.07 | Training tokens per second (%): 67.87 | MFU (%): 3.16 | TFLOPs: 31.25
2025-05-23 16:28:42,785 - root - INFO - Step: 155 | Loss: 9.29 | Tokens per second: 7612.35 | Training tokens per second (%): 87.15 | MFU (%): 3.18 | TFLOPs: 31.42
2025-05-23 16:28:43,412 - root - INFO - Step: 160 | Loss: 8.70 | Tokens per second: 8201.93 | Training tokens per second (%): 64.86 | MFU (%): 3.42 | TFLOPs: 33.85
2025-05-23 16:28:43,432 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:43,433 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:44,132 - root - INFO - Step: 165 | Loss: 8.93 | Tokens per second: 7138.89 | Training tokens per second (%): 45.74 | MFU (%): 2.98 | TFLOPs: 29.47
2025-05-23 16:28:44,832 - root - INFO - Step: 170 | Loss: 9.24 | Tokens per second: 7342.57 | Training tokens per second (%): 78.38 | MFU (%): 3.06 | TFLOPs: 30.31
2025-05-23 16:28:45,489 - root - INFO - Step: 175 | Loss: 9.16 | Tokens per second: 7836.52 | Training tokens per second (%): 57.73 | MFU (%): 3.27 | TFLOPs: 32.35
2025-05-23 16:28:46,110 - root - INFO - Step: 180 | Loss: 8.84 | Tokens per second: 8288.29 | Training tokens per second (%): 58.32 | MFU (%): 3.46 | TFLOPs: 34.21
2025-05-23 16:28:46,129 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:46,131 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:46,814 - root - INFO - Step: 185 | Loss: 9.23 | Tokens per second: 7295.66 | Training tokens per second (%): 50.92 | MFU (%): 3.04 | TFLOPs: 30.11
2025-05-23 16:28:47,505 - root - INFO - Step: 190 | Loss: 8.84 | Tokens per second: 7446.81 | Training tokens per second (%): 62.42 | MFU (%): 3.11 | TFLOPs: 30.74
2025-05-23 16:28:48,197 - root - INFO - Step: 195 | Loss: 8.70 | Tokens per second: 7436.44 | Training tokens per second (%): 50.66 | MFU (%): 3.10 | TFLOPs: 30.69
2025-05-23 16:28:48,825 - root - INFO - Step: 200 | Loss: 9.06 | Tokens per second: 8184.98 | Training tokens per second (%): 52.85 | MFU (%): 3.42 | TFLOPs: 33.78
2025-05-23 16:28:48,845 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:48,846 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:49,514 - root - INFO - Step: 205 | Loss: 8.34 | Tokens per second: 7468.56 | Training tokens per second (%): 38.81 | MFU (%): 3.12 | TFLOPs: 30.83
2025-05-23 16:28:50,190 - root - INFO - Step: 210 | Loss: 8.65 | Tokens per second: 7600.02 | Training tokens per second (%): 67.71 | MFU (%): 3.17 | TFLOPs: 31.37
2025-05-23 16:28:50,861 - root - INFO - Step: 215 | Loss: 8.51 | Tokens per second: 7672.77 | Training tokens per second (%): 48.05 | MFU (%): 3.20 | TFLOPs: 31.67
2025-05-23 16:28:51,481 - root - INFO - Step: 220 | Loss: 8.75 | Tokens per second: 8291.58 | Training tokens per second (%): 47.36 | MFU (%): 3.46 | TFLOPs: 34.22
2025-05-23 16:28:51,500 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:51,501 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
000, curr_pr_arr is 0x400a5c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a5c350000!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b6a3b1c00!
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ae3380e00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bf13e2a00!
Thread ID: 5, savenvm_thread_nd took 1785.092245 ms
Thread ID: 5, set_cpu took 0.087838 ms
Thread ID: 8, savenvm_thread_nd took 1896.998988 ms
Thread ID: 8, set_cpu took 0.052702 ms
Thread ID: 6, savenvm_thread_nd took 1904.639752 ms
Thread ID: 6, set_cpu took 0.077534 ms
Thread ID: 7, savenvm_thread_nd took 1906.030974 ms
Thread ID: 7, set_cpu took 0.056735 ms
Threads took 1906.208505 ms
MSYNC 9060496528 TOOK 295.544340 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400840200000, curr_checkpoint is 0x400840200000
1, 6
Parall_iter 0, Write new metadata at address 0x400840180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 20, parall_iter is 0, num_threads is 4, last counter is 6, curr_counter is 7
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400840280000, curr_pr_arr is 0x400840280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008c72b0e00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400840280000!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40094e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009d5312a00!
Thread ID: 4, savenvm_thread_nd took 1731.069535 ms
Thread ID: 4, set_cpu took 0.046047 ms
Thread ID: 1, savenvm_thread_nd took 1734.315679 ms
Thread ID: 1, set_cpu took 0.082717 ms
Thread ID: 2, savenvm_thread_nd took 1744.360148 ms
Thread ID: 2, set_cpu took 0.066686 ms
Thread ID: 3, savenvm_thread_nd took 1745.882630 ms
Thread ID: 3, set_cpu took 0.048798 ms
Threads took 1746.056033 ms
MSYNC 9060496528 TOOK 358.510622 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x400840180000, curr_checkpoint is 0x400840180000
0, 7
Parall_iter 1, Write new metadata at address 0x400840200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 26, parall_iter is 1, num_threads is 4, last counter is 7, curr_counter is 8
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a5c350000, curr_pr_arr is 0x400a5c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ae3380e00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a5c350000!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b6a3b1c00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bf13e2a00!
Thread ID: 5, savenvm_thread_nd took 1758.883971 ms
Thread ID: 5, set_cpu took 0.083613 ms
Thread ID: 8, savenvm_thread_nd took 1768.771804 ms
Thread ID: 8, set_cpu took 0.041695 ms
Thread ID: 6, savenvm_thread_nd took 1773.164665 ms
Thread ID: 6, set_cpu took 0.060798 ms
Thread ID: 7, savenvm_thread_nd took 1774.221434 ms
Thread ID: 7, set_cpu took 0.049886 ms
Threads took 1774.395861 ms
MSYNC 9060496528 TOOK 346.740670 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x400840200000, curr_checkpoint is 0x400840200000
1, 8
Parall_iter 0, Write new metadata at address 0x400840180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 32, parall_iter is 0, num_threads is 4, last counter is 8, curr_counter is 9
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400840280000, curr_pr_arr is 0x400840280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400840280000!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009d5312a00!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008c72b0e00!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40094e2e1c00!
Thread ID: 4, savenvm_thread_nd took 1769.645122 ms
Thread ID: 4, set_cpu took 0.049534 ms
Thread ID: 1, savenvm_thread_nd took 1773.498575 ms
Thread ID: 1, set_cpu took 0.089277 ms
Thread ID: 2, savenvm_thread_nd took 1782.895479 ms
Thread ID: 2, set_cpu took 0.081213 ms
Thread ID: 3, savenvm_thread_nd took 1786.143606 ms
Thread ID: 3, set_cpu took 0.065502 ms
Threads took 1786.338127 ms
MSYNC 9060496528 TOOK 332.734559 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x400840180000, curr_checkpoint is 0x400840180000
0, 9
Parall_iter 1, Write new metadata at address 0x400840200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 59, parall_iter is 1, num_threads is 4, last counter is 9, curr_counter is 10
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a5c350000, curr_pr_arr is 0x400a5c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ae3380e00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a5c350000!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b6a3b1c00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bf13e2a00!
Thread ID: 5, savenvm_thread_nd took 1857.770429 ms
Thread ID: 5, set_cpu took 0.082046 ms
Thread ID: 8, savenvm_thread_nd took 1867.736340 ms
Thread ID: 8, set_cpu took 0.049823 ms
Thread ID: 6, savenvm_thread_nd took 1870.290024 ms
Thread ID: 6, set_cpu took 0.050751 ms
Thread ID: 7, savenvm_thread_nd took 1872.780543 ms
Thread ID: 7, set_cpu took 0.050462 ms
Threads took 1873.028919 ms
MSYNC 9060496528 TOOK 315.547327 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x400840200000, curr_checkpoint is 0x400840200000
1, 10
Parall_iter 0, Write new metadata at address 0x400840180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 66, parall_iter is 0, num_threads is 4, last counter is 10, curr_counter is 11
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400840280000, curr_pr_arr is 0x400840280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400840280000!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008c72b0e00!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40094e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr 2025-05-23 16:28:52,170 - root - INFO - Step: 225 | Loss: 8.37 | Tokens per second: 7459.58 | Training tokens per second (%): 59.55 | MFU (%): 3.11 | TFLOPs: 30.79
2025-05-23 16:28:52,828 - root - INFO - Step: 230 | Loss: 8.24 | Tokens per second: 7818.76 | Training tokens per second (%): 25.08 | MFU (%): 3.26 | TFLOPs: 32.27
2025-05-23 16:28:53,484 - root - INFO - Step: 235 | Loss: 8.52 | Tokens per second: 7841.87 | Training tokens per second (%): 43.71 | MFU (%): 3.27 | TFLOPs: 32.37
2025-05-23 16:28:54,091 - root - INFO - Step: 240 | Loss: 8.32 | Tokens per second: 8484.78 | Training tokens per second (%): 71.23 | MFU (%): 3.54 | TFLOPs: 35.02
2025-05-23 16:28:54,110 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:54,111 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:54,787 - root - INFO - Step: 245 | Loss: 8.39 | Tokens per second: 7379.42 | Training tokens per second (%): 58.46 | MFU (%): 3.08 | TFLOPs: 30.46
2025-05-23 16:28:55,469 - root - INFO - Step: 250 | Loss: 8.53 | Tokens per second: 7540.16 | Training tokens per second (%): 53.71 | MFU (%): 3.15 | TFLOPs: 31.12
2025-05-23 16:28:56,135 - root - INFO - Step: 255 | Loss: 9.02 | Tokens per second: 7733.29 | Training tokens per second (%): 42.27 | MFU (%): 3.23 | TFLOPs: 31.92
2025-05-23 16:28:56,747 - root - INFO - Step: 260 | Loss: 9.25 | Tokens per second: 8406.48 | Training tokens per second (%): 60.08 | MFU (%): 3.51 | TFLOPs: 34.70
2025-05-23 16:28:56,766 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:56,767 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:28:57,425 - root - INFO - Step: 265 | Loss: 8.46 | Tokens per second: 7584.38 | Training tokens per second (%): 50.68 | MFU (%): 3.17 | TFLOPs: 31.31
2025-05-23 16:28:58,099 - root - INFO - Step: 270 | Loss: 8.30 | Tokens per second: 7630.23 | Training tokens per second (%): 68.73 | MFU (%): 3.18 | TFLOPs: 31.49
2025-05-23 16:28:58,764 - root - INFO - Step: 275 | Loss: 8.55 | Tokens per second: 7734.64 | Training tokens per second (%): 47.05 | MFU (%): 3.23 | TFLOPs: 31.93
2025-05-23 16:28:59,379 - root - INFO - Step: 280 | Loss: 8.10 | Tokens per second: 8359.15 | Training tokens per second (%): 65.78 | MFU (%): 3.49 | TFLOPs: 34.50
2025-05-23 16:28:59,399 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:28:59,400 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:29:00,060 - root - INFO - Step: 285 | Loss: 8.55 | Tokens per second: 7559.90 | Training tokens per second (%): 73.09 | MFU (%): 3.16 | TFLOPs: 31.20
2025-05-23 16:29:00,732 - root - INFO - Step: 290 | Loss: 8.13 | Tokens per second: 7652.72 | Training tokens per second (%): 54.63 | MFU (%): 3.19 | TFLOPs: 31.59
2025-05-23 16:29:01,402 - root - INFO - Step: 295 | Loss: 7.91 | Tokens per second: 7671.02 | Training tokens per second (%): 44.59 | MFU (%): 3.20 | TFLOPs: 31.66
2025-05-23 16:29:02,027 - root - INFO - Step: 300 | Loss: 7.97 | Tokens per second: 8231.50 | Training tokens per second (%): 83.14 | MFU (%): 3.44 | TFLOPs: 33.98
2025-05-23 16:29:02,046 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:29:02,047 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:29:02,714 - root - INFO - Step: 305 | Loss: 8.81 | Tokens per second: 7482.84 | Training tokens per second (%): 64.26 | MFU (%): 3.12 | TFLOPs: 30.89
2025-05-23 16:29:03,383 - root - INFO - Step: 310 | Loss: 8.46 | Tokens per second: 7696.10 | Training tokens per second (%): 58.93 | MFU (%): 3.21 | TFLOPs: 31.77
2025-05-23 16:29:04,046 - root - INFO - Step: 315 | Loss: 7.73 | Tokens per second: 7751.13 | Training tokens per second (%): 64.43 | MFU (%): 3.23 | TFLOPs: 31.99
2025-05-23 16:29:04,666 - root - INFO - Step: 320 | Loss: 8.34 | Tokens per second: 8303.26 | Training tokens per second (%): 73.79 | MFU (%): 3.47 | TFLOPs: 34.27
2025-05-23 16:29:04,685 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:29:04,686 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:29:05,346 - root - INFO - Step: 325 | Loss: 8.13 | Tokens per second: 7557.66 | Training tokens per second (%): 49.69 | MFU (%): 3.15 | TFLOPs: 31.19
2025-05-23 16:29:06,023 - root - INFO - Step: 330 | Loss: 7.10 | Tokens per second: 7594.92 | Training tokens per second (%): 60.96 | MFU (%): 3.17 | TFLOPs: 31.35
2025-05-23 16:29:06,685 - root - INFO - Step: 335 | Loss: 8.48 | Tokens per second: 7782.03 | Training tokens per second (%): 24.41 | MFU (%): 3.25 | TFLOPs: 32.12
is 0x4009d5312a00!
Thread ID: 4, savenvm_thread_nd took 1616.772241 ms
Thread ID: 4, set_cpu took 0.050142 ms
Thread ID: 1, savenvm_thread_nd took 1624.121557 ms
Thread ID: 1, set_cpu took 0.090173 ms
Thread ID: 2, savenvm_thread_nd took 1631.904076 ms
Thread ID: 2, set_cpu took 0.066526 ms
Thread ID: 3, savenvm_thread_nd took 1634.268581 ms
Thread ID: 3, set_cpu took 0.050815 ms
Threads took 1634.456640 ms
MSYNC 9060496528 TOOK 429.847951 ms
CAS was successful! new counter is 11, is_distributed is 0
******** checkp_info saved in 0x400840180000, curr_checkpoint is 0x400840180000
0, 11
Parall_iter 1, Write new metadata at address 0x400840200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 90, parall_iter is 1, num_threads is 4, last counter is 11, curr_counter is 12
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a5c350000, curr_pr_arr is 0x400a5c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b6a3b1c00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a5c350000!
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ae3380e00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bf13e2a00!
Thread ID: 5, savenvm_thread_nd took 1826.499490 ms
Thread ID: 5, set_cpu took 0.086878 ms
Thread ID: 8, savenvm_thread_nd took 1853.566620 ms
Thread ID: 8, set_cpu took 0.043198 ms
Thread ID: 7, savenvm_thread_nd took 1856.616832 ms
Thread ID: 7, set_cpu took 0.052735 ms
Thread ID: 6, savenvm_thread_nd took 1861.286133 ms
Thread ID: 6, set_cpu took 0.070718 ms
Threads took 1861.513455 ms
MSYNC 9060496528 TOOK 337.126972 ms
CAS was successful! new counter is 12, is_distributed is 0
******** checkp_info saved in 0x400840200000, curr_checkpoint is 0x400840200000
1, 12
Parall_iter 0, Write new metadata at address 0x400840180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 96, parall_iter is 0, num_threads is 4, last counter is 12, curr_counter is 13
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400840280000, curr_pr_arr is 0x400840280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400840280000!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008c72b0e00!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40094e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009d5312a00!
Thread ID: 4, savenvm_thread_nd took 1805.708335 ms
Thread ID: 4, set_cpu took 0.046046 ms
Thread ID: 1, savenvm_thread_nd took 1825.935539 ms
Thread ID: 1, set_cpu took 0.082590 ms
Thread ID: 3, savenvm_thread_nd took 1894.414811 ms
Thread ID: 3, set_cpu took 0.052702 ms
Thread ID: 2, savenvm_thread_nd took 1895.474330 ms
Thread ID: 2, set_cpu took 0.060607 ms
Threads took 1895.649622 ms
MSYNC 9060496528 TOOK 285.420864 ms
CAS was successful! new counter is 13, is_distributed is 0
******** checkp_info saved in 0x400840180000, curr_checkpoint is 0x400840180000
0, 13
Parall_iter 1, Write new metadata at address 0x400840200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 123, parall_iter is 1, num_threads is 4, last counter is 13, curr_counter is 14
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a5c350000, curr_pr_arr is 0x400a5c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ae3380e00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a5c350000!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b6a3b1c00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bf13e2a00!
Thread ID: 8, savenvm_thread_nd took 1840.514881 ms
Thread ID: 8, set_cpu took 0.054366 ms
Thread ID: 5, savenvm_thread_nd took 1880.732529 ms
Thread ID: 5, set_cpu took 0.087293 ms
Thread ID: 6, savenvm_thread_nd took 1907.236539 ms
Thread ID: 6, set_cpu took 0.062910 ms
Thread ID: 7, savenvm_thread_nd took 2030.665787 ms
Thread ID: 7, set_cpu took 0.054814 ms
Threads took 2030.849142 ms
MSYNC 9060496528 TOOK 120.899434 ms
CAS was successful! new counter is 14, is_distributed is 0
******** checkp_info saved in 0x400840200000, curr_checkpoint is 0x400840200000
1, 14
Parall_iter 0, Write new metadata at address 0x400840180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 1, parall_iter is 0, num_threads is 4, last counter is 14, curr_counter is 15
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400840280000, curr_pr_arr is 0x400840280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008c72b0e00!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40094e2e1c00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400840280000!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009d5312a00!
Thread ID: 4, savenvm_thread_nd took 1920.945954 ms
Thread ID: 4, set_cpu took 0.046783 ms
Thread ID: 1, savenvm_thread_nd took 1926.769045 ms
Thread ID: 1, set_cpu took 0.091453 ms
Thread ID: 3, savenvm_thread_nd took 1936.681166 ms
Thread ID: 3, set_cpu took 0.053502 ms
Thread ID: 2, savenvm_thread_nd took 1939.728403 ms
Thread ID: 2, set_cpu took 0.068126 ms
Threads took 1939.917549 ms
MSYNC 9060496528 TOOK 312.216194 ms
CAS was successful! new counter is 15, is_distributed is 0
******** checkp_info saved in 0x400840180000, curr_checkpoint is 0x400840180000
0, 15
Parall_iter 1, Write new metadata at address 0x400840200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 7, parall_iter is 1, num_threads is 4, last counter is 15, curr_counter is 16
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a5c350000, curr_pr_arr is 0x400a5c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ae3380e00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a5c350000!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b6a3b1c00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bf13e2a00!
Thread ID: 5, savenvm_thread_nd took 1797.011794 ms
Thread ID: 5, set_cpu took 0.078941 ms
Thread ID: 8, savenvm_thread_nd took 1810.949713 ms
Thread ID: 8, set_cpu took 0.048991 ms
Thread ID: 7, savenvm_thread_nd took 1814.219024 ms
Thread ID: 7, set_cpu took 0.047838 ms
Thread ID: 6, savenvm_thread_nd took 1815.506346 ms
Thread ID: 6, set_cpu took 0.060318 ms
Threads took 1815.661637 ms
MSYNC 9060496528 TOOK 410.896932 ms
CAS was successful! new counter is 16, is_distributed is 0
******** checkp_info saved in 0x400840200000, curr_checkpoint is 0x400840202025-05-23 16:29:07,311 - root - INFO - Step: 340 | Loss: 8.32 | Tokens per second: 8212.72 | Training tokens per second (%): 59.49 | MFU (%): 3.43 | TFLOPs: 33.90
2025-05-23 16:29:07,330 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:29:07,331 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:29:07,991 - root - INFO - Step: 345 | Loss: 8.22 | Tokens per second: 7563.04 | Training tokens per second (%): 63.32 | MFU (%): 3.16 | TFLOPs: 31.22
2025-05-23 16:29:08,671 - root - INFO - Step: 350 | Loss: 8.22 | Tokens per second: 7559.18 | Training tokens per second (%): 62.03 | MFU (%): 3.15 | TFLOPs: 31.20
2025-05-23 16:29:09,338 - root - INFO - Step: 355 | Loss: 8.13 | Tokens per second: 7717.03 | Training tokens per second (%): 36.93 | MFU (%): 3.22 | TFLOPs: 31.85
2025-05-23 16:29:09,965 - root - INFO - Step: 360 | Loss: 7.73 | Tokens per second: 8201.54 | Training tokens per second (%): 72.48 | MFU (%): 3.42 | TFLOPs: 33.85
2025-05-23 16:29:09,984 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:29:09,985 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:29:10,656 - root - INFO - Step: 365 | Loss: 7.91 | Tokens per second: 7444.51 | Training tokens per second (%): 82.03 | MFU (%): 3.11 | TFLOPs: 30.73
2025-05-23 16:29:11,308 - root - INFO - Step: 370 | Loss: 7.58 | Tokens per second: 7893.32 | Training tokens per second (%): 70.29 | MFU (%): 3.29 | TFLOPs: 32.58
2025-05-23 16:29:12,006 - root - INFO - Step: 375 | Loss: 8.37 | Tokens per second: 7360.56 | Training tokens per second (%): 91.58 | MFU (%): 3.07 | TFLOPs: 30.38
2025-05-23 16:29:12,668 - root - INFO - Step: 380 | Loss: 7.41 | Tokens per second: 7774.53 | Training tokens per second (%): 66.46 | MFU (%): 3.24 | TFLOPs: 32.09
2025-05-23 16:29:12,687 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:29:12,688 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:29:13,358 - root - INFO - Step: 385 | Loss: 7.78 | Tokens per second: 7457.82 | Training tokens per second (%): 48.44 | MFU (%): 3.11 | TFLOPs: 30.78
2025-05-23 16:29:14,026 - root - INFO - Step: 390 | Loss: 7.59 | Tokens per second: 7691.59 | Training tokens per second (%): 63.48 | MFU (%): 3.21 | TFLOPs: 31.75
2025-05-23 16:29:14,702 - root - INFO - Step: 395 | Loss: 7.94 | Tokens per second: 7609.64 | Training tokens per second (%): 73.14 | MFU (%): 3.18 | TFLOPs: 31.41
2025-05-23 16:29:15,332 - root - INFO - Step: 400 | Loss: 7.72 | Tokens per second: 8169.96 | Training tokens per second (%): 53.57 | MFU (%): 3.41 | TFLOPs: 33.72
2025-05-23 16:29:15,351 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:29:15,352 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
total_size: 2265124132, bsize: 2265124132, ratio: 2.0
2265124132 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.47566032409668 ms
CPU copy took 2046.940803527832 ms
---------------------- [PERF] Single Checkpoint time is 2.1320853233337402 sec, average is 2.1320807933807373
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.43036079406738 ms
CPU copy took 2039.8201942443848 ms
---------------------- [PERF] Single Checkpoint time is 2.1247916221618652 sec, average is 2.128434896469116
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.41128730773926 ms
CPU copy took 2075.5233764648438 ms
---------------------- [PERF] Single Checkpoint time is 2.150343179702759 sec, average is 2.1320807933807373
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.426307678222656 ms
CPU copy took 2162.144899368286 ms
---------------------- [PERF] Single Checkpoint time is 2.2420339584350586 sec, average is 2.141211152076721
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.41295623779297 ms
CPU copy took 2218.3010578155518 ms
---------------------- [PERF] Single Checkpoint time is 2.2981977462768555 sec, average is 2.150341510772705
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.41128730773926 ms
CPU copy took 2207.2978019714355 ms
---------------------- [PERF] Single Checkpoint time is 2.2872068881988525 sec, average is 2.196187138557434
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.3569278717041 ms
CPU copy took 2110.0974082946777 ms
---------------------- [PERF] Single Checkpoint time is 2.1899070739746094 sec, average is 2.1899054050445557
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.36622619628906 ms
CPU copy took 2126.6651153564453 ms
---------------------- [PERF] Single Checkpoint time is 2.2064876556396484 sec, average is 2.1981958150863647
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.38267707824707 ms
CPU copy took 2124.612331390381 ms
---------------------- [PERF] Single Checkpoint time is 2.2044975757598877 sec, average is 2.2044949531555176
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.36741828918457 ms
CPU copy took 2194.1404342651367 ms
---------------------- [PERF] Single Checkpoint time is 2.279043197631836 sec, average is 2.2054905891418457
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.37981605529785 ms
CPU copy took 2069.849729537964 ms
---------------------- [PERF] Single Checkpoint time is 2.149688959121704 sec, average is 2.2044949531555176
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.409141540527344 ms
CPU copy took 2204.150676727295 ms
---------------------- [PERF] Single Checkpoint time is 2.2840497493743896 sec, average is 2.2054905891418457
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.415578842163086 ms
CPU copy took 2186.6202354431152 ms
---------------------- [PERF] Single Checkpoint time is 2.271599769592285 sec, average is 2.206486225128174
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.43012237548828 ms
CPU copy took 2156.831979751587 ms
---------------------- [PERF] Single Checkpoint time is 2.2367517948150635 sec, average is 2.2216182947158813
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.41152572631836 ms
CPU copy took 2257.648229598999 ms
---------------------- [PERF] Single Checkpoint time is 2.3410212993621826 sec, average is 2.236750364303589
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.372901916503906 ms
CPU copy took 2232.131242752075 ms
---------------------- [PERF] Single Checkpoint time is 2.3120064735412598 sec, average is 2.239391565322876
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.42702293395996 ms
CPU copy took 2355.455160140991 ms
---------------------- [PERF] Single Checkpoint time is 2.440460205078125 sec, average is 2.242032766342163
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.39626693725586 ms
CPU copy took 2366.853952407837 ms
---------------------- [PERF] Single Checkpoint time is 2.441664457321167 sec, average is 2.2568153142929077
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.39745903015137 ms
CPU copy took 2335.1449966430664 ms
---------------------- [PERF] Single Checkpoint time is 2.4150002002716064 sec, average is 2.2715978622436523
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 53.66182327270508 ms
CPU copy took 2206.7580223083496 ms
---------------------- [PERF] Single Checkpoint time is 2.2607996463775635 sec, average is 2.266197443008423
---- exit
0000
1, 16
Parall_iter 0, Write new metadata at address 0x400840180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 13, parall_iter is 0, num_threads is 4, last counter is 16, curr_counter is 17
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400840280000, curr_pr_arr is 0x400840280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008c72b0e00!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40094e2e1c00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400840280000!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009d5312a00!
Thread ID: 4, savenvm_thread_nd took 1973.743965 ms
Thread ID: 4, set_cpu took 0.044703 ms
Thread ID: 1, savenvm_thread_nd took 1979.435571 ms
Thread ID: 1, set_cpu took 0.086109 ms
Thread ID: 2, savenvm_thread_nd took 1992.388434 ms
Thread ID: 2, set_cpu took 0.067166 ms
Thread ID: 3, savenvm_thread_nd took 1993.527664 ms
Thread ID: 3, set_cpu took 0.051422 ms
Threads took 1993.695338 ms
MSYNC 9060496528 TOOK 356.259265 ms
CAS was successful! new counter is 17, is_distributed is 0
******** checkp_info saved in 0x400840180000, curr_checkpoint is 0x400840180000
0, 17
Parall_iter 1, Write new metadata at address 0x400840200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 19, parall_iter is 1, num_threads is 4, last counter is 17, curr_counter is 18
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a5c350000, curr_pr_arr is 0x400a5c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ae3380e00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a5c350000!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b6a3b1c00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bf13e2a00!
Thread ID: 5, savenvm_thread_nd took 1961.773057 ms
Thread ID: 5, set_cpu took 0.092893 ms
Thread ID: 8, savenvm_thread_nd took 1974.301515 ms
Thread ID: 8, set_cpu took 0.044831 ms
Thread ID: 6, savenvm_thread_nd took 1981.219165 ms
Thread ID: 6, set_cpu took 0.068542 ms
Thread ID: 7, savenvm_thread_nd took 1981.897640 ms
Thread ID: 7, set_cpu took 0.054270 ms
Threads took 1982.065571 ms
MSYNC 9060496528 TOOK 379.263604 ms
CAS was successful! new counter is 18, is_distributed is 0
******** checkp_info saved in 0x400840200000, curr_checkpoint is 0x400840200000
1, 18
Parall_iter 0, Write new metadata at address 0x400840180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 45, parall_iter is 0, num_threads is 4, last counter is 18, curr_counter is 19
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400840280000, curr_pr_arr is 0x400840280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40094e2e1c00!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008c72b0e00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009d5312a00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400840280000!
Thread ID: 4, savenvm_thread_nd took 1909.409114 ms
Thread ID: 4, set_cpu took 0.048799 ms
Thread ID: 1, savenvm_thread_nd took 1916.831133 ms
Thread ID: 1, set_cpu took 0.094077 ms
Thread ID: 2, savenvm_thread_nd took 1923.016452 ms
Thread ID: 2, set_cpu took 0.076414 ms
Thread ID: 3, savenvm_thread_nd took 1924.985226 ms
Thread ID: 3, set_cpu took 0.058078 ms
Threads took 1925.152005 ms
MSYNC 9060496528 TOOK 404.481475 ms
CAS was successful! new counter is 19, is_distributed is 0
******** checkp_info saved in 0x400840180000, curr_checkpoint is 0x400840180000
0, 19
Parall_iter 1, Write new metadata at address 0x400840200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 51, parall_iter is 1, num_threads is 4, last counter is 19, curr_counter is 20
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a5c350000, curr_pr_arr is 0x400a5c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ae3380e00!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b6a3b1c00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a5c350000!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bf13e2a00!
Thread ID: 5, savenvm_thread_nd took 1770.087988 ms
Thread ID: 5, set_cpu took 0.093821 ms
Thread ID: 8, savenvm_thread_nd took 1866.240386 ms
Thread ID: 8, set_cpu took 0.047839 ms
Thread ID: 7, savenvm_thread_nd took 1942.866357 ms
Thread ID: 7, set_cpu took 0.057790 ms
Thread ID: 6, savenvm_thread_nd took 1943.671517 ms
Thread ID: 6, set_cpu took 0.073438 ms
Threads took 1943.870647 ms
MSYNC 9060496528 TOOK 262.437519 ms
CAS was successful! new counter is 20, is_distributed is 0
******** checkp_info saved in 0x400840200000, curr_checkpoint is 0x400840200000
1, 20
2025-05-23 16:29:18,733 - root - INFO - Training completed
2025-05-23 16:29:18,733 - root - INFO - Training run end: total time taken 56.41 seconds
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
==== PCCHECK END ====
==== RUNNING BASELINE FOR 2048 WITH fp32 ====
2025-05-23 16:29:23,260 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_2048/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-23 16:29:23,262 - root - INFO - Setting up DataLoaders...
2025-05-23 16:29:24,370 - root - INFO - Setting up Model...
2025-05-23 16:29:36,141 - root - INFO - Starting training!
2025-05-23 16:29:36,736 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 3547.11 | Training tokens per second (%): 38.77 | MFU (%): 4.91 | TFLOPs: 48.56
2025-05-23 16:29:37,770 - root - INFO - Step: 5 | Loss: 11.84 | Tokens per second: 8114.27 | Training tokens per second (%): 22.83 | MFU (%): 11.23 | TFLOPs: 111.09
2025-05-23 16:29:39,168 - root - INFO - Step: 10 | Loss: 11.61 | Tokens per second: 7452.96 | Training tokens per second (%): 51.44 | MFU (%): 10.32 | TFLOPs: 102.04
2025-05-23 16:29:40,469 - root - INFO - Step: 15 | Loss: 10.76 | Tokens per second: 8026.38 | Training tokens per second (%): 48.58 | MFU (%): 11.11 | TFLOPs: 109.89
2025-05-23 16:29:41,773 - root - INFO - Step: 20 | Loss: 10.43 | Tokens per second: 8000.53 | Training tokens per second (%): 49.55 | MFU (%): 11.08 | TFLOPs: 109.54
2025-05-23 16:30:06,996 - root - INFO - Checkpoint saved in 25.2226 seconds
2025-05-23 16:30:06,997 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:30:08,294 - root - INFO - Step: 25 | Loss: 10.21 | Tokens per second: 386.46 | Training tokens per second (%): 36.56 | MFU (%): 0.53 | TFLOPs: 5.29
2025-05-23 16:30:09,610 - root - INFO - Step: 30 | Loss: 9.54 | Tokens per second: 7924.48 | Training tokens per second (%): 50.15 | MFU (%): 10.97 | TFLOPs: 108.49
2025-05-23 16:30:10,907 - root - INFO - Step: 35 | Loss: 9.74 | Tokens per second: 8049.35 | Training tokens per second (%): 27.57 | MFU (%): 11.14 | TFLOPs: 110.20
2025-05-23 16:30:12,206 - root - INFO - Step: 40 | Loss: 9.91 | Tokens per second: 8030.32 | Training tokens per second (%): 19.90 | MFU (%): 11.12 | TFLOPs: 109.94
2025-05-23 16:30:36,865 - root - INFO - Checkpoint saved in 24.6588 seconds
2025-05-23 16:30:36,866 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:30:38,152 - root - INFO - Step: 45 | Loss: 9.43 | Tokens per second: 395.04 | Training tokens per second (%): 31.17 | MFU (%): 0.55 | TFLOPs: 5.41
2025-05-23 16:30:39,434 - root - INFO - Step: 50 | Loss: 9.49 | Tokens per second: 8140.04 | Training tokens per second (%): 21.87 | MFU (%): 11.27 | TFLOPs: 111.45
2025-05-23 16:30:40,749 - root - INFO - Step: 55 | Loss: 9.86 | Tokens per second: 7934.37 | Training tokens per second (%): 54.01 | MFU (%): 10.98 | TFLOPs: 108.63
2025-05-23 16:30:42,053 - root - INFO - Step: 60 | Loss: 9.46 | Tokens per second: 7997.78 | Training tokens per second (%): 49.63 | MFU (%): 11.07 | TFLOPs: 109.50
2025-05-23 16:31:06,835 - root - INFO - Checkpoint saved in 24.7818 seconds
2025-05-23 16:31:06,837 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:31:08,146 - root - INFO - Step: 65 | Loss: 9.69 | Tokens per second: 392.80 | Training tokens per second (%): 48.10 | MFU (%): 0.54 | TFLOPs: 5.38
2025-05-23 16:31:09,449 - root - INFO - Step: 70 | Loss: 9.37 | Tokens per second: 8010.37 | Training tokens per second (%): 32.49 | MFU (%): 11.09 | TFLOPs: 109.67
2025-05-23 16:31:10,766 - root - INFO - Step: 75 | Loss: 9.10 | Tokens per second: 7918.92 | Training tokens per second (%): 33.31 | MFU (%): 10.96 | TFLOPs: 108.42
2025-05-23 16:31:12,067 - root - INFO - Step: 80 | Loss: 9.09 | Tokens per second: 8019.79 | Training tokens per second (%): 34.72 | MFU (%): 11.10 | TFLOPs: 109.80
2025-05-23 16:31:36,630 - root - INFO - Checkpoint saved in 24.5621 seconds
2025-05-23 16:31:36,631 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:31:37,923 - root - INFO - Step: 85 | Loss: 9.16 | Tokens per second: 396.41 | Training tokens per second (%): 32.09 | MFU (%): 0.55 | TFLOPs: 5.43
2025-05-23 16:31:39,262 - root - INFO - Step: 90 | Loss: 8.64 | Tokens per second: 7792.86 | Training tokens per second (%): 76.84 | MFU (%): 10.79 | TFLOPs: 106.69
2025-05-23 16:31:40,594 - root - INFO - Step: 95 | Loss: 8.43 | Tokens per second: 7827.54 | Training tokens per second (%): 76.98 | MFU (%): 10.84 | TFLOPs: 107.17
2025-05-23 16:31:41,937 - root - INFO - Step: 100 | Loss: 8.63 | Tokens per second: 7766.52 | Training tokens per second (%): 100.00 | MFU (%): 10.75 | TFLOPs: 106.33
2025-05-23 16:32:06,601 - root - INFO - Checkpoint saved in 24.6644 seconds
2025-05-23 16:32:06,603 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:32:07,904 - root - INFO - Step: 105 | Loss: 8.70 | Tokens per second: 394.71 | Training tokens per second (%): 33.06 | MFU (%): 0.55 | TFLOPs: 5.40
2025-05-23 16:32:09,210 - root - INFO - Step: 110 | Loss: 8.91 | Tokens per second: 7988.15 | Training tokens per second (%): 31.52 | MFU (%): 11.06 | TFLOPs: 109.37
2025-05-23 16:32:10,502 - root - INFO - Step: 115 | Loss: 8.52 | Tokens per second: 8079.39 | Training tokens per second (%): 19.95 | MFU (%): 11.18 | TFLOPs: 110.62
2025-05-23 16:32:11,814 - root - INFO - Step: 120 | Loss: 8.55 | Tokens per second: 7955.17 | Training tokens per second (%): 47.53 | MFU (%): 11.01 | TFLOPs: 108.91
2025-05-23 16:32:36,419 - root - INFO - Checkpoint saved in 24.6052 seconds
2025-05-23 16:32:36,421 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:32:37,722 - root - INFO - Step: 125 | Loss: 8.77 | Tokens per second: 395.61 | Training tokens per second (%): 39.27 | MFU (%): 0.55 | TFLOPs: 5.42
2025-05-23 16:32:39,020 - root - INFO - Step: 130 | Loss: 9.07 | Tokens per second: 8039.55 | Training tokens per second (%): 31.13 | MFU (%): 11.13 | TFLOPs: 110.07
2025-05-23 16:32:40,321 - root - INFO - Step: 135 | Loss: 8.31 | Tokens per second: 8016.13 | Training tokens per second (%): 43.91 | MFU (%): 11.10 | TFLOPs: 109.75
2025-05-23 16:32:41,622 - root - INFO - Step: 140 | Loss: 8.14 | Tokens per second: 8024.20 | Training tokens per second (%): 23.79 | MFU (%): 11.11 | TFLOPs: 109.86
2025-05-23 16:33:06,285 - root - INFO - Checkpoint saved in 24.6634 seconds
2025-05-23 16:33:06,287 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:33:07,586 - root - INFO - Step: 145 | Loss: 8.13 | Tokens per second: 394.76 | Training tokens per second (%): 40.89 | MFU (%): 0.55 | TFLOPs: 5.40
2025-05-23 16:33:08,875 - root - INFO - Step: 150 | Loss: 8.41 | Tokens per second: 8094.00 | Training tokens per second (%): 39.48 | MFU (%): 11.20 | TFLOPs: 110.81
2025-05-23 16:33:10,194 - root - INFO - Step: 155 | Loss: 8.25 | Tokens per second: 7912.12 | Training tokens per second (%): 59.66 | MFU (%): 10.95 | TFLOPs: 108.32
2025-05-23 16:33:11,487 - root - INFO - Step: 160 | Loss: 7.57 | Tokens per second: 8066.89 | Training tokens per second (%): 42.43 | MFU (%): 11.17 | TFLOPs: 110.44
2025-05-23 16:33:36,152 - root - INFO - Checkpoint saved in 24.6640 seconds
2025-05-23 16:33:36,153 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:33:37,453 - root - INFO - Step: 165 | Loss: 7.89 | Tokens per second: 394.74 | Training tokens per second (%): 32.87 | MFU (%): 0.55 | TFLOPs: 5.40
2025-05-23 16:33:38,768 - root - INFO - Step: 170 | Loss: 8.34 | Tokens per second: 7928.53 | Training tokens per second (%): 58.68 | MFU (%): 10.98 | TFLOPs: 108.55
2025-05-23 16:33:40,065 - root - INFO - Step: 175 | Loss: 8.05 | Tokens per second: 8048.22 | Training tokens per second (%): 39.18 | MFU (%): 11.14 | TFLOPs: 110.19
2025-05-23 16:33:41,354 - root - INFO - Step: 180 | Loss: 7.73 | Tokens per second: 8096.87 | Training tokens per second (%): 29.37 | MFU (%): 11.21 | TFLOPs: 110.85
2025-05-23 16:34:06,030 - root - INFO - Checkpoint saved in 24.6761 seconds
2025-05-23 16:34:06,032 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:34:07,334 - root - INFO - Step: 185 | Loss: 8.21 | Tokens per second: 394.52 | Training tokens per second (%): 27.41 | MFU (%): 0.55 | TFLOPs: 5.40
2025-05-23 16:34:08,635 - root - INFO - Step: 190 | Loss: 7.69 | Tokens per second: 8019.17 | Training tokens per second (%): 41.21 | MFU (%): 11.10 | TFLOPs: 109.79
2025-05-23 16:34:09,936 - root - INFO - Step: 195 | Loss: 7.95 | Tokens per second: 8019.11 | Training tokens per second (%): 45.33 | MFU (%): 11.10 | TFLOPs: 109.79
2025-05-23 16:34:11,228 - root - INFO - Step: 200 | Loss: 8.18 | Tokens per second: 8075.98 | Training tokens per second (%): 33.85 | MFU (%): 11.18 | TFLOPs: 110.57
2025-05-23 16:34:35,887 - root - INFO - Checkpoint saved in 24.6582 seconds
2025-05-23 16:34:35,889 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:34:37,178 - root - INFO - Step: 205 | Loss: 7.23 | Tokens per second: 394.98 | Training tokens per second (%): 19.40 | MFU (%): 0.55 | TFLOPs: 5.41
2025-05-23 16:34:38,478 - root - INFO - Step: 210 | Loss: 7.87 | Tokens per second: 8028.57 | Training tokens per second (%): 38.69 | MFU (%): 11.11 | TFLOPs: 109.92
2025-05-23 16:34:39,779 - root - INFO - Step: 215 | Loss: 7.60 | Tokens per second: 8019.56 | Training tokens per second (%): 24.02 | MFU (%): 11.10 | TFLOPs: 109.80
2025-05-23 16:34:41,070 - root - INFO - Step: 220 | Loss: 7.87 | Tokens per second: 8081.68 | Training tokens per second (%): 24.01 | MFU (%): 11.19 | TFLOPs: 110.65
2025-05-23 16:35:05,631 - root - INFO - Checkpoint saved in 24.5604 seconds
2025-05-23 16:35:05,633 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:35:06,932 - root - INFO - Step: 225 | Loss: 7.53 | Tokens per second: 396.32 | Training tokens per second (%): 40.32 | MFU (%): 0.55 | TFLOPs: 5.43
2025-05-23 16:35:08,218 - root - INFO - Step: 230 | Loss: 7.39 | Tokens per second: 8114.06 | Training tokens per second (%): 12.54 | MFU (%): 11.23 | TFLOPs: 111.09
2025-05-23 16:35:09,521 - root - INFO - Step: 235 | Loss: 7.77 | Tokens per second: 8008.71 | Training tokens per second (%): 27.69 | MFU (%): 11.09 | TFLOPs: 109.65
2025-05-23 16:35:10,820 - root - INFO - Step: 240 | Loss: 7.31 | Tokens per second: 8033.40 | Training tokens per second (%): 45.88 | MFU (%): 11.12 | TFLOPs: 109.99
2025-05-23 16:35:35,416 - root - INFO - Checkpoint saved in 24.5963 seconds
2025-05-23 16:35:35,418 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:35:36,723 - root - INFO - Step: 245 | Loss: 7.56 | Tokens per second: 395.69 | Training tokens per second (%): 43.83 | MFU (%): 0.55 | TFLOPs: 5.42
2025-05-23 16:35:38,038 - root - INFO - Step: 250 | Loss: 7.66 | Tokens per second: 7932.22 | Training tokens per second (%): 46.86 | MFU (%): 10.98 | TFLOPs: 108.60
2025-05-23 16:35:39,333 - root - INFO - Step: 255 | Loss: 8.36 | Tokens per second: 8062.53 | Training tokens per second (%): 22.31 | MFU (%): 11.16 | TFLOPs: 110.38
2025-05-23 16:35:40,637 - root - INFO - Step: 260 | Loss: 8.63 | Tokens per second: 7999.65 | Training tokens per second (%): 40.04 | MFU (%): 11.07 | TFLOPs: 109.52
2025-05-23 16:36:05,394 - root - INFO - Checkpoint saved in 24.7566 seconds
2025-05-23 16:36:05,396 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:36:06,697 - root - INFO - Step: 265 | Loss: 7.60 | Tokens per second: 393.31 | Training tokens per second (%): 25.34 | MFU (%): 0.54 | TFLOPs: 5.38
2025-05-23 16:36:07,991 - root - INFO - Step: 270 | Loss: 7.50 | Tokens per second: 8060.84 | Training tokens per second (%): 34.54 | MFU (%): 11.16 | TFLOPs: 110.36
2025-05-23 16:36:09,292 - root - INFO - Step: 275 | Loss: 7.64 | Tokens per second: 8023.74 | Training tokens per second (%): 26.43 | MFU (%): 11.11 | TFLOPs: 109.85
2025-05-23 16:36:10,604 - root - INFO - Step: 280 | Loss: 7.22 | Tokens per second: 7949.88 | Training tokens per second (%): 45.45 | MFU (%): 11.01 | TFLOPs: 108.84
2025-05-23 16:36:35,302 - root - INFO - Checkpoint saved in 24.6977 seconds
2025-05-23 16:36:35,304 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:36:36,598 - root - INFO - Step: 285 | Loss: 7.86 | Tokens per second: 394.31 | Training tokens per second (%): 43.17 | MFU (%): 0.55 | TFLOPs: 5.40
2025-05-23 16:36:37,898 - root - INFO - Step: 290 | Loss: 7.22 | Tokens per second: 8027.57 | Training tokens per second (%): 27.31 | MFU (%): 11.11 | TFLOPs: 109.91
2025-05-23 16:36:39,183 - root - INFO - Step: 295 | Loss: 7.01 | Tokens per second: 8122.47 | Training tokens per second (%): 22.29 | MFU (%): 11.24 | TFLOPs: 111.20
2025-05-23 16:36:40,505 - root - INFO - Step: 300 | Loss: 7.03 | Tokens per second: 7887.88 | Training tokens per second (%): 81.27 | MFU (%): 10.92 | TFLOPs: 107.99
2025-05-23 16:37:05,168 - root - INFO - Checkpoint saved in 24.6624 seconds
2025-05-23 16:37:05,170 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:37:06,468 - root - INFO - Step: 305 | Loss: 8.35 | Tokens per second: 394.78 | Training tokens per second (%): 42.13 | MFU (%): 0.55 | TFLOPs: 5.40
2025-05-23 16:37:07,771 - root - INFO - Step: 310 | Loss: 7.85 | Tokens per second: 8007.92 | Training tokens per second (%): 31.69 | MFU (%): 11.09 | TFLOPs: 109.64
2025-05-23 16:37:09,077 - root - INFO - Step: 315 | Loss: 7.11 | Tokens per second: 7985.57 | Training tokens per second (%): 42.22 | MFU (%): 11.05 | TFLOPs: 109.33
2025-05-23 16:37:10,382 - root - INFO - Step: 320 | Loss: 7.86 | Tokens per second: 7995.17 | Training tokens per second (%): 49.90 | MFU (%): 11.07 | TFLOPs: 109.46
2025-05-23 16:37:34,875 - root - INFO - Checkpoint saved in 24.4926 seconds
2025-05-23 16:37:34,877 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:37:36,184 - root - INFO - Step: 325 | Loss: 7.39 | Tokens per second: 397.25 | Training tokens per second (%): 34.84 | MFU (%): 0.55 | TFLOPs: 5.44
2025-05-23 16:37:37,475 - root - INFO - Step: 330 | Loss: 6.65 | Tokens per second: 8079.01 | Training tokens per second (%): 45.21 | MFU (%): 11.18 | TFLOPs: 110.61
2025-05-23 16:37:38,770 - root - INFO - Step: 335 | Loss: 7.89 | Tokens per second: 8060.03 | Training tokens per second (%): 12.21 | MFU (%): 11.16 | TFLOPs: 110.35
2025-05-23 16:37:40,078 - root - INFO - Step: 340 | Loss: 7.67 | Tokens per second: 7977.47 | Training tokens per second (%): 33.55 | MFU (%): 11.04 | TFLOPs: 109.22
2025-05-23 16:38:04,860 - root - INFO - Checkpoint saved in 24.7818 seconds
2025-05-23 16:38:04,862 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:38:06,159 - root - INFO - Step: 345 | Loss: 7.65 | Tokens per second: 392.98 | Training tokens per second (%): 38.32 | MFU (%): 0.54 | TFLOPs: 5.38
2025-05-23 16:38:07,456 - root - INFO - Step: 350 | Loss: 7.65 | Tokens per second: 8045.57 | Training tokens per second (%): 38.50 | MFU (%): 11.14 | TFLOPs: 110.15
2025-05-23 16:38:08,752 - root - INFO - Step: 355 | Loss: 7.52 | Tokens per second: 8051.49 | Training tokens per second (%): 18.47 | MFU (%): 11.15 | TFLOPs: 110.23
2025-05-23 16:38:10,065 - root - INFO - Step: 360 | Loss: 7.19 | Tokens per second: 7947.17 | Training tokens per second (%): 50.04 | MFU (%): 11.00 | TFLOPs: 108.80
2025-05-23 16:38:34,616 - root - INFO - Checkpoint saved in 24.5511 seconds
2025-05-23 16:38:34,618 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:38:35,910 - root - INFO - Step: 365 | Loss: 7.22 | Tokens per second: 396.58 | Training tokens per second (%): 41.02 | MFU (%): 0.55 | TFLOPs: 5.43
2025-05-23 16:38:37,214 - root - INFO - Step: 370 | Loss: 6.79 | Tokens per second: 8006.20 | Training tokens per second (%): 35.15 | MFU (%): 11.08 | TFLOPs: 109.61
2025-05-23 16:38:38,546 - root - INFO - Step: 375 | Loss: 7.76 | Tokens per second: 7829.71 | Training tokens per second (%): 78.84 | MFU (%): 10.84 | TFLOPs: 107.20
2025-05-23 16:38:39,877 - root - INFO - Step: 380 | Loss: 6.59 | Tokens per second: 7836.97 | Training tokens per second (%): 49.27 | MFU (%): 10.85 | TFLOPs: 107.30
2025-05-23 16:39:04,459 - root - INFO - Checkpoint saved in 24.5822 seconds
2025-05-23 16:39:04,461 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:39:05,753 - root - INFO - Step: 385 | Loss: 7.13 | Tokens per second: 396.10 | Training tokens per second (%): 34.22 | MFU (%): 0.55 | TFLOPs: 5.42
2025-05-23 16:39:07,059 - root - INFO - Step: 390 | Loss: 7.00 | Tokens per second: 7987.76 | Training tokens per second (%): 41.74 | MFU (%): 11.06 | TFLOPs: 109.36
2025-05-23 16:39:08,366 - root - INFO - Step: 395 | Loss: 7.46 | Tokens per second: 7983.34 | Training tokens per second (%): 45.66 | MFU (%): 11.05 | TFLOPs: 109.30
2025-05-23 16:39:09,664 - root - INFO - Step: 400 | Loss: 7.03 | Tokens per second: 8039.48 | Training tokens per second (%): 36.79 | MFU (%): 11.13 | TFLOPs: 110.07
2025-05-23 16:39:34,217 - root - INFO - Checkpoint saved in 24.5530 seconds
2025-05-23 16:39:34,219 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:39:34,219 - root - INFO - Training completed
2025-05-23 16:39:34,219 - root - INFO - Training run end: total time taken 598.08 seconds
==== BASELINE END ====
==== RUNNING PCCHECK FOR 2048 WITH fp32 ====
2025-05-23 16:39:38,645 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_2048/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-23 16:39:38,648 - root - INFO - Setting up DataLoaders...
2025-05-23 16:39:39,550 - root - INFO - Setting up Model...
Model size: 2281834496, Optimizer size: 4563669284, Total size: 6845503780
BSIZE IS 6845503780
At checkpoint, bsize is 6845503780
2025-05-23 16:40:26,815 - root - INFO - Checkpointing warmup done
2025-05-23 16:40:26,819 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 16:40:27,313 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 4303.14 | Training tokens per second (%): 38.77 | MFU (%): 5.96 | TFLOPs: 58.91
2025-05-23 16:40:28,351 - root - INFO - Step: 5 | Loss: 11.85 | Tokens per second: 8082.24 | Training tokens per second (%): 22.83 | MFU (%): 11.19 | TFLOPs: 110.65
2025-05-23 16:40:29,669 - root - INFO - Step: 10 | Loss: 11.62 | Tokens per second: 7916.98 | Training tokens per second (%): 51.44 | MFU (%): 10.96 | TFLOPs: 108.39
2025-05-23 16:40:30,983 - root - INFO - Step: 15 | Loss: 10.78 | Tokens per second: 7941.40 | Training tokens per second (%): 48.58 | MFU (%): 10.99 | TFLOPs: 108.73
2025-05-23 16:40:32,293 - root - INFO - Step: 20 | Loss: 10.44 | Tokens per second: 7963.75 | Training tokens per second (%): 49.55 | MFU (%): 11.02 | TFLOPs: 109.03
2025-05-23 16:40:32,317 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:40:32,319 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:40:33,685 - root - INFO - Step: 25 | Loss: 10.21 | Tokens per second: 7477.05 | Training tokens per second (%): 36.56 | MFU (%): 10.35 | TFLOPs: 102.37
2025-05-23 16:40:35,044 - root - INFO - Step: 30 | Loss: 9.54 | Tokens per second: 7670.22 | Training tokens per second (%): 50.15 | MFU (%): 10.62 | TFLOPs: 105.01
2025-05-23 16:40:36,384 - root - INFO - Step: 35 | Loss: 9.74 | Tokens per second: 7785.43 | Training tokens per second (%): 27.57 | MFU (%): 10.78 | TFLOPs: 106.59
2025-05-23 16:40:37,720 - root - INFO - Step: 40 | Loss: 9.91 | Tokens per second: 7809.32 | Training tokens per second (%): 19.90 | MFU (%): 10.81 | TFLOPs: 106.92
2025-05-23 16:40:37,745 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:40:37,747 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:40:40,101 - root - INFO - Step: 45 | Loss: 9.42 | Tokens per second: 4346.23 | Training tokens per second (%): 31.17 | MFU (%): 6.02 | TFLOPs: 59.50
2025-05-23 16:40:41,439 - root - INFO - Step: 50 | Loss: 9.49 | Tokens per second: 7794.03 | Training tokens per second (%): 21.87 | MFU (%): 10.79 | TFLOPs: 106.71
2025-05-23 16:40:42,803 - root - INFO - Step: 55 | Loss: 9.86 | Tokens per second: 7647.98 | Training tokens per second (%): 54.01 | MFU (%): 10.59 | TFLOPs: 104.71
2025-05-23 16:40:44,159 - root - INFO - Step: 60 | Loss: 9.46 | Tokens per second: 7688.83 | Training tokens per second (%): 49.63 | MFU (%): 10.64 | TFLOPs: 105.27
2025-05-23 16:40:44,184 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:40:44,186 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:40:46,500 - root - INFO - Step: 65 | Loss: 9.69 | Tokens per second: 4421.93 | Training tokens per second (%): 48.10 | MFU (%): 6.12 | TFLOPs: 60.54
2025-05-23 16:40:47,850 - root - INFO - Step: 70 | Loss: 9.37 | Tokens per second: 7723.07 | Training tokens per second (%): 32.49 | MFU (%): 10.69 | TFLOPs: 105.74
2025-05-23 16:40:49,206 - root - INFO - Step: 75 | Loss: 9.10 | Tokens per second: 7695.52 | Training tokens per second (%): 33.31 | MFU (%): 10.65 | TFLOPs: 105.36
2025-05-23 16:40:50,551 - root - INFO - Step: 80 | Loss: 9.09 | Tokens per second: 7751.73 | Training tokens per second (%): 34.72 | MFU (%): 10.73 | TFLOPs: 106.13
2025-05-23 16:40:50,577 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:40:50,579 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:40:52,959 - root - INFO - Step: 85 | Loss: 9.15 | Tokens per second: 4296.82 | Training tokens per second (%): 32.09 | MFU (%): 5.95 | TFLOPs: 58.83
2025-05-23 16:40:54,349 - root - INFO - Step: 90 | Loss: 8.64 | Tokens per second: 7500.58 | Training tokens per second (%): 76.84 | MFU (%): 10.38 | TFLOPs: 102.69
2025-05-23 16:40:55,730 - root - INFO - Step: 95 | Loss: 8.43 | Tokens per second: 7550.99 | Training tokens per second (%): 76.98 | MFU (%): 10.45 | TFLOPs: 103.38
2025-05-23 16:40:57,131 - root - INFO - Step: 100 | Loss: 8.62 | Tokens per second: 7439.08 | Training tokens per second (%): 100.00 | MFU (%): 10.30 | TFLOPs: 101.85
2025-05-23 16:40:57,157 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:40:57,159 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:40:59,353 - root - INFO - Step: 105 | Loss: 8.70 | Tokens per second: 4658.88 | Training tokens per second (%): 33.06 | MFU (%): 6.45 | TFLOPs: 63.78
2025-05-23 16:41:00,699 - root - INFO - Step: 110 | Loss: 8.91 | Tokens per second: 7750.60 | Training tokens per second (%): 31.52 | MFU (%): 10.73 | TFLOPs: 106.11
2025-05-23 16:41:02,034 - root - INFO - Step: 115 | Loss: 8.52 | Tokens per second: 7819.75 | Training tokens per second (%): 19.95 | MFU (%): 10.83 | TFLOPs: 107.06
2025-05-23 16:41:03,402 - root - INFO - Step: 120 | Loss: 8.55 | Tokens per second: 7621.15 | Training tokens per second (%): 47.53 | MFU (%): 10.55 | TFLOPs: 104.34
2025-05-23 16:41:03,427 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:41:03,429 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x400f80280000, PR_ADDR is 0x400f80000000, PEER_CHECK_ADDR is 0x400f80080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 6845503780
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400f80180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 123, parall_iter is 0, num_threads is 4, last counter is 0, curr_counter is 1
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f80280000, curr_pr_arr is 0x400f80280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
CPU: 1, CPU USE: 11
size_for_thread_i is 1711375780
CPU: 2, CPU USE: 12
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400f80280000!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x4011182e1a00!
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4014483a4e00!
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x4012b0343400!
Thread ID: 1, savenvm_thread_nd took 5534.057150 ms
Thread ID: 1, set_cpu took 0.084286 ms
Thread ID: 2, savenvm_thread_nd took 5557.407937 ms
Thread ID: 2, set_cpu took 0.053343 ms
Thread ID: 3, savenvm_thread_nd took 5882.653794 ms
Thread ID: 3, set_cpu took 0.056447 ms
Thread ID: 4, savenvm_thread_nd took 5923.857671 ms
Thread ID: 4, set_cpu took 0.031744 ms
Threads took 5924.123999 ms
MSYNC 27382015120 TOOK 244.171121 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400f80180000, curr_checkpoint is 0x400f80180000
0, 1
Parall_iter 1, Write new metadata at address 0x400f80200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 1, parall_iter is 1, num_threads is 4, last counter is 1, curr_counter is 2
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4015e0410000, curr_pr_arr is 0x4015e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4015e0410000!
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401778471a00!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4019104d3400!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401aa8534e00!
Thread ID: 5, savenvm_thread_nd took 5456.943391 ms
Thread ID: 5, set_cpu took 0.087933 ms
Thread ID: 6, savenvm_thread_nd took 5495.774566 ms
Thread ID: 6, set_cpu took 0.056766 ms
Thread ID: 7, savenvm_thread_nd took 5814.171148 ms
Thread ID: 7, set_cpu took 0.054654 ms
Thread ID: 8, savenvm_thread_nd took 5873.149170 ms
Thread ID: 8, set_cpu took 0.060127 ms
Threads took 5873.386636 ms
MSYNC 27382015120 TOOK 265.694442 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400f80200000, curr_checkpoint is 0x400f80200000
1, 2
Parall_iter 0, Write new metadata at address 0x400f80180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 29, parall_iter is 0, num_threads is 4, last counter is 2, curr_counter is 3
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f80280000, curr_pr_arr is 0x400f80280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x4011182e1a00!
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400f80280000!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x4012b0343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4014483a4e00!
Thread ID: 1, savenvm_thread_nd took 5508.297344 ms
Thread ID: 1, set_cpu took 0.091902 ms
Thread ID: 2, savenvm_thread_nd took 5528.564699 ms
Thread ID: 2, set_cpu took 0.062718 ms
Thread ID: 3, savenvm_thread_nd took 5866.725546 ms
Thread ID: 3, set_cpu took 0.059390 ms
Thread ID: 4, savenvm_thread_nd took 5901.662242 ms
Thread ID: 4, set_cpu took 0.054399 ms
Threads took 5901.889980 ms
MSYNC 27382015120 TOOK 294.463602 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400f80180000, curr_checkpoint is 0x400f80180000
0, 3
Parall_iter 1, Write new metadata at address 0x400f80200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 53, parall_iter is 1, num_threads is 4, last counter is 3, curr_counter is 4
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4015e0410000, curr_pr_arr is 0x4015e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401778471a00!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4015e0410000!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4019104d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401aa8534e00!
Thread ID: 5, savenvm_thread_nd took 5375.614135 ms
Thread ID: 5, set_cpu took 0.092285 ms
Thread ID: 6, savenvm_thread_nd took 5571.029020 ms
Thread ID: 6, set_cpu took 0.070750 ms
Thread ID: 7, savenvm_thread_nd took 5873.836768 ms
Thread ID: 7, set_cpu took 0.053598 ms
Thread ID: 8, savenvm_thread_nd took 5940.907264 ms
Thread ID: 8, set_cpu took 0.050654 ms
Threads took 5941.132985 ms
MSYNC 27382015120 TOOK 214.892696 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400f80200000, curr_checkpoint is 0x400f80200000
1, 4
Parall_iter 0, Write new metadata at address 0x400f80180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 82, parall_iter is 0, num_threads is 4, last counter is 4, curr_counter is 5
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f80280000, curr_pr_arr is 0x400f80280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400f80280000!
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x4012b0343400!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4014483a4e00!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x4011182e1a00!
Thread ID: 1, savenvm_thread_nd took 5477.731338 ms
Thread ID: 1, set_cpu took 0.091646 ms
Thread ID: 2, savenvm_thread_nd took 5562.221304 ms
Thread ID: 2, set_cpu took 4.567421 ms
Thread ID: 3, savenvm_thread_nd took 5826.044567 ms
Thread ID: 3, set_cpu took 0.052510 ms
Thread ID: 4, savenvm_thread_nd took 5873.912989 ms
Thread ID: 4, set_cpu took 0.052606 ms
Threads took 5874.168309 ms
MSYNC 27382015120 TOOK 305.497367 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400f80180000, curr_checkpoint is 0x400f80180000
0, 5
Parall_iter 1, Write new metadata at address 0x400f80200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 88, parall_iter is 1, num_threads is 4, last counter is 5, curr_counter is 6
Writing offset is 39792, parall_iter_off2025-05-23 16:41:05,797 - root - INFO - Step: 125 | Loss: 8.76 | Tokens per second: 4318.98 | Training tokens per second (%): 39.27 | MFU (%): 5.98 | TFLOPs: 59.13
2025-05-23 16:41:07,152 - root - INFO - Step: 130 | Loss: 9.07 | Tokens per second: 7700.28 | Training tokens per second (%): 31.13 | MFU (%): 10.66 | TFLOPs: 105.42
2025-05-23 16:41:08,505 - root - INFO - Step: 135 | Loss: 8.31 | Tokens per second: 7704.36 | Training tokens per second (%): 43.91 | MFU (%): 10.67 | TFLOPs: 105.48
2025-05-23 16:41:09,849 - root - INFO - Step: 140 | Loss: 8.13 | Tokens per second: 7764.58 | Training tokens per second (%): 23.79 | MFU (%): 10.75 | TFLOPs: 106.30
2025-05-23 16:41:09,875 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:41:09,877 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:41:12,207 - root - INFO - Step: 145 | Loss: 8.13 | Tokens per second: 4388.93 | Training tokens per second (%): 40.89 | MFU (%): 6.08 | TFLOPs: 60.09
2025-05-23 16:41:13,545 - root - INFO - Step: 150 | Loss: 8.40 | Tokens per second: 7796.17 | Training tokens per second (%): 39.48 | MFU (%): 10.79 | TFLOPs: 106.74
2025-05-23 16:41:14,908 - root - INFO - Step: 155 | Loss: 8.24 | Tokens per second: 7615.14 | Training tokens per second (%): 59.66 | MFU (%): 10.54 | TFLOPs: 104.26
2025-05-23 16:41:16,258 - root - INFO - Step: 160 | Loss: 7.57 | Tokens per second: 7725.30 | Training tokens per second (%): 42.43 | MFU (%): 10.69 | TFLOPs: 105.77
2025-05-23 16:41:16,282 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:41:16,284 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:41:18,601 - root - INFO - Step: 165 | Loss: 7.88 | Tokens per second: 4416.81 | Training tokens per second (%): 32.87 | MFU (%): 6.11 | TFLOPs: 60.47
2025-05-23 16:41:19,970 - root - INFO - Step: 170 | Loss: 8.33 | Tokens per second: 7601.64 | Training tokens per second (%): 58.68 | MFU (%): 10.52 | TFLOPs: 104.07
2025-05-23 16:41:21,322 - root - INFO - Step: 175 | Loss: 8.04 | Tokens per second: 7713.83 | Training tokens per second (%): 39.18 | MFU (%): 10.68 | TFLOPs: 105.61
2025-05-23 16:41:22,670 - root - INFO - Step: 180 | Loss: 7.72 | Tokens per second: 7738.58 | Training tokens per second (%): 29.38 | MFU (%): 10.71 | TFLOPs: 105.95
2025-05-23 16:41:22,722 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:41:22,724 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:41:25,047 - root - INFO - Step: 185 | Loss: 8.20 | Tokens per second: 4353.70 | Training tokens per second (%): 27.41 | MFU (%): 6.03 | TFLOPs: 59.61
2025-05-23 16:41:26,395 - root - INFO - Step: 190 | Loss: 7.69 | Tokens per second: 7735.21 | Training tokens per second (%): 41.21 | MFU (%): 10.71 | TFLOPs: 105.90
2025-05-23 16:41:27,752 - root - INFO - Step: 195 | Loss: 7.94 | Tokens per second: 7682.93 | Training tokens per second (%): 45.33 | MFU (%): 10.64 | TFLOPs: 105.19
2025-05-23 16:41:29,096 - root - INFO - Step: 200 | Loss: 8.18 | Tokens per second: 7764.18 | Training tokens per second (%): 33.85 | MFU (%): 10.75 | TFLOPs: 106.30
2025-05-23 16:41:29,121 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:41:29,122 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:41:31,533 - root - INFO - Step: 205 | Loss: 7.22 | Tokens per second: 4243.13 | Training tokens per second (%): 19.40 | MFU (%): 5.87 | TFLOPs: 58.09
2025-05-23 16:41:32,885 - root - INFO - Step: 210 | Loss: 7.87 | Tokens per second: 7714.11 | Training tokens per second (%): 38.69 | MFU (%): 10.68 | TFLOPs: 105.61
2025-05-23 16:41:34,230 - root - INFO - Step: 215 | Loss: 7.60 | Tokens per second: 7755.53 | Training tokens per second (%): 24.02 | MFU (%): 10.74 | TFLOPs: 106.18
2025-05-23 16:41:35,575 - root - INFO - Step: 220 | Loss: 7.87 | Tokens per second: 7755.25 | Training tokens per second (%): 24.01 | MFU (%): 10.74 | TFLOPs: 106.18
2025-05-23 16:41:35,601 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:41:35,602 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
set is 6845513728
start_pr_arr is 0x4015e0410000, curr_pr_arr is 0x4015e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4015e0410000!
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401778471a00!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4019104d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401aa8534e00!
Thread ID: 5, savenvm_thread_nd took 5476.356402 ms
Thread ID: 5, set_cpu took 0.085822 ms
Thread ID: 6, savenvm_thread_nd took 5517.081092 ms
Thread ID: 6, set_cpu took 0.056415 ms
Thread ID: 7, savenvm_thread_nd took 5867.784684 ms
Thread ID: 7, set_cpu took 0.053247 ms
Thread ID: 8, savenvm_thread_nd took 5932.412241 ms
Thread ID: 8, set_cpu took 0.049215 ms
Threads took 5932.639883 ms
MSYNC 27382015120 TOOK 229.352314 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400f80200000, curr_checkpoint is 0x400f80200000
1, 6
Parall_iter 0, Write new metadata at address 0x400f80180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 115, parall_iter is 0, num_threads is 4, last counter is 6, curr_counter is 7
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f80280000, curr_pr_arr is 0x400f80280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400f80280000!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x4011182e1a00!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x4012b0343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4014483a4e00!
Thread ID: 1, savenvm_thread_nd took 5537.184005 ms
Thread ID: 1, set_cpu took 0.089949 ms
Thread ID: 2, savenvm_thread_nd took 5567.453346 ms
Thread ID: 2, set_cpu took 0.063038 ms
Thread ID: 3, savenvm_thread_nd took 5838.671565 ms
Thread ID: 3, set_cpu took 0.051423 ms
Thread ID: 4, savenvm_thread_nd took 5875.394898 ms
Thread ID: 4, set_cpu took 0.048223 ms
Threads took 5875.627404 ms
MSYNC 27382015120 TOOK 256.676300 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x400f80180000, curr_checkpoint is 0x400f80180000
0, 7
Parall_iter 1, Write new metadata at address 0x400f80200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 121, parall_iter is 1, num_threads is 4, last counter is 7, curr_counter is 8
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4015e0410000, curr_pr_arr is 0x4015e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401778471a00!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4015e0410000!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4019104d3400!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401aa8534e00!
Thread ID: 5, savenvm_thread_nd took 5531.414679 ms
Thread ID: 5, set_cpu took 0.089949 ms
Thread ID: 6, savenvm_thread_nd took 5567.927869 ms
Thread ID: 6, set_cpu took 0.065534 ms
Thread ID: 7, savenvm_thread_nd took 5869.601296 ms
Thread ID: 7, set_cpu took 0.048222 ms
Thread ID: 8, savenvm_thread_nd took 5928.512766 ms
Thread ID: 8, set_cpu took 0.049342 ms
Threads took 5928.738008 ms
MSYNC 27382015120 TOOK 270.213016 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x400f80200000, curr_checkpoint is 0x400f80200000
1, 8
Parall_iter 0, Write new metadata at address 0x400f80180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 38, parall_iter is 0, num_threads is 4, last counter is 8, curr_counter is 9
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f80280000, curr_pr_arr is 0x400f80280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x4011182e1a00!
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400f80280000!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x4012b0343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4014483a4e00!
Thread ID: 1, savenvm_thread_nd took 5564.383056 ms
Thread ID: 1, set_cpu took 0.093949 ms
Thread ID: 2, savenvm_thread_nd took 5600.887319 ms
Thread ID: 2, set_cpu took 0.066078 ms
Thread ID: 3, savenvm_thread_nd took 5910.122122 ms
Thread ID: 3, set_cpu took 0.056606 ms
Thread ID: 4, savenvm_thread_nd took 5954.016532 ms
Thread ID: 4, set_cpu took 0.049119 ms
Threads took 5954.234350 ms
MSYNC 27382015120 TOOK 273.614323 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x400f80180000, curr_checkpoint is 0x400f80180000
0, 9
Parall_iter 1, Write new metadata at address 0x400f80200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 44, parall_iter is 1, num_threads is 4, last counter is 9, curr_counter is 10
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4015e0410000, curr_pr_arr is 0x4015e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4015e0410000!
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401778471a00!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4019104d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401aa8534e00!
Thread ID: 5, savenvm_thread_nd took 5515.622070 ms
Thread ID: 5, set_cpu took 0.088413 ms
Thread ID: 6, savenvm_thread_nd took 5561.427144 ms
Thread ID: 6, set_cpu took 0.055550 ms
Thread ID: 7, savenvm_thread_nd took 5871.602400 ms
Thread ID: 7, set_cpu took 0.048095 ms
Thread ID: 8, savenvm_thread_nd took 5947.315612 ms
Thread ID: 8, set_cpu took 0.049918 ms
Threads took 5947.565813 ms
MSYNC 27382015120 TOOK 268.210706 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x400f80200000, curr_checkpoint is 0x400f80200000
1, 10
Parall_iter 0, Write new metadata at address 0x400f80180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 73, parall_iter is 0, num_threads is 4, last counter is 10, curr_counter is 11
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f80280000, curr_pr_arr is 0x400f80280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x4011182e1a00!
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x4012b0343400!
At savenvm_thread_nd id is 1, sz is 12025-05-23 16:41:38,002 - root - INFO - Step: 225 | Loss: 7.53 | Tokens per second: 4263.37 | Training tokens per second (%): 40.32 | MFU (%): 5.90 | TFLOPs: 58.37
2025-05-23 16:41:39,333 - root - INFO - Step: 230 | Loss: 7.39 | Tokens per second: 7837.85 | Training tokens per second (%): 12.54 | MFU (%): 10.85 | TFLOPs: 107.31
2025-05-23 16:41:40,677 - root - INFO - Step: 235 | Loss: 7.77 | Tokens per second: 7759.21 | Training tokens per second (%): 27.69 | MFU (%): 10.74 | TFLOPs: 106.23
2025-05-23 16:41:42,033 - root - INFO - Step: 240 | Loss: 7.31 | Tokens per second: 7691.08 | Training tokens per second (%): 45.88 | MFU (%): 10.65 | TFLOPs: 105.30
2025-05-23 16:41:42,058 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:41:42,060 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:41:44,484 - root - INFO - Step: 245 | Loss: 7.55 | Tokens per second: 4219.17 | Training tokens per second (%): 43.83 | MFU (%): 5.84 | TFLOPs: 57.76
2025-05-23 16:41:45,848 - root - INFO - Step: 250 | Loss: 7.66 | Tokens per second: 7645.75 | Training tokens per second (%): 46.86 | MFU (%): 10.58 | TFLOPs: 104.68
2025-05-23 16:41:47,179 - root - INFO - Step: 255 | Loss: 8.36 | Tokens per second: 7836.64 | Training tokens per second (%): 22.31 | MFU (%): 10.85 | TFLOPs: 107.29
2025-05-23 16:41:48,523 - root - INFO - Step: 260 | Loss: 8.62 | Tokens per second: 7763.61 | Training tokens per second (%): 40.04 | MFU (%): 10.75 | TFLOPs: 106.29
2025-05-23 16:41:48,548 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:41:48,550 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:41:50,938 - root - INFO - Step: 265 | Loss: 7.59 | Tokens per second: 4283.75 | Training tokens per second (%): 25.34 | MFU (%): 5.93 | TFLOPs: 58.65
2025-05-23 16:41:52,271 - root - INFO - Step: 270 | Loss: 7.50 | Tokens per second: 7830.53 | Training tokens per second (%): 34.54 | MFU (%): 10.84 | TFLOPs: 107.21
2025-05-23 16:41:53,618 - root - INFO - Step: 275 | Loss: 7.63 | Tokens per second: 7741.07 | Training tokens per second (%): 26.43 | MFU (%): 10.72 | TFLOPs: 105.98
2025-05-23 16:41:54,974 - root - INFO - Step: 280 | Loss: 7.22 | Tokens per second: 7694.12 | Training tokens per second (%): 45.45 | MFU (%): 10.65 | TFLOPs: 105.34
2025-05-23 16:41:54,999 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:41:55,001 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:41:57,385 - root - INFO - Step: 285 | Loss: 7.86 | Tokens per second: 4289.86 | Training tokens per second (%): 43.17 | MFU (%): 5.94 | TFLOPs: 58.73
2025-05-23 16:41:58,728 - root - INFO - Step: 290 | Loss: 7.22 | Tokens per second: 7769.02 | Training tokens per second (%): 27.31 | MFU (%): 10.75 | TFLOPs: 106.37
2025-05-23 16:42:00,072 - root - INFO - Step: 295 | Loss: 7.01 | Tokens per second: 7762.10 | Training tokens per second (%): 22.29 | MFU (%): 10.75 | TFLOPs: 106.27
2025-05-23 16:42:01,448 - root - INFO - Step: 300 | Loss: 7.03 | Tokens per second: 7579.51 | Training tokens per second (%): 81.27 | MFU (%): 10.49 | TFLOPs: 103.77
2025-05-23 16:42:01,473 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:42:01,475 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:42:03,832 - root - INFO - Step: 305 | Loss: 8.35 | Tokens per second: 4339.29 | Training tokens per second (%): 42.13 | MFU (%): 6.01 | TFLOPs: 59.41
2025-05-23 16:42:05,179 - root - INFO - Step: 310 | Loss: 7.85 | Tokens per second: 7745.25 | Training tokens per second (%): 31.69 | MFU (%): 10.72 | TFLOPs: 106.04
2025-05-23 16:42:06,533 - root - INFO - Step: 315 | Loss: 7.11 | Tokens per second: 7704.10 | Training tokens per second (%): 42.22 | MFU (%): 10.67 | TFLOPs: 105.48
2025-05-23 16:42:07,892 - root - INFO - Step: 320 | Loss: 7.86 | Tokens per second: 7672.84 | Training tokens per second (%): 49.90 | MFU (%): 10.62 | TFLOPs: 105.05
2025-05-23 16:42:07,916 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:42:07,918 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:42:10,192 - root - INFO - Step: 325 | Loss: 7.39 | Tokens per second: 4500.88 | Training tokens per second (%): 34.84 | MFU (%): 6.23 | TFLOPs: 61.62
2025-05-23 16:42:11,546 - root - INFO - Step: 330 | Loss: 6.65 | Tokens per second: 7698.05 | Training tokens per second (%): 45.21 | MFU (%): 10.66 | TFLOPs: 105.39
2025-05-23 16:42:12,882 - root - INFO - Step: 335 | Loss: 7.89 | Tokens per second: 7809.00 | Training tokens per second (%): 12.21 | MFU (%): 10.81 | TFLOPs: 106.91
2025-05-23 16:42:14,222 - root - INFO - Step: 340 | Loss: 7.67 | Tokens per second: 7770.44 | Training tokens per second (%): 33.55 | MFU (%): 10.76 | TFLOPs: 106.39
2025-05-23 16:42:14,247 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:42:14,249 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
711376000, start addr is 0x400f80280000!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4014483a4e00!
Thread ID: 1, savenvm_thread_nd took 5558.781398 ms
Thread ID: 1, set_cpu took 0.096702 ms
Thread ID: 2, savenvm_thread_nd took 5588.314859 ms
Thread ID: 2, set_cpu took 0.070590 ms
Thread ID: 3, savenvm_thread_nd took 5875.547019 ms
Thread ID: 3, set_cpu took 0.052286 ms
Thread ID: 4, savenvm_thread_nd took 5913.201359 ms
Thread ID: 4, set_cpu took 0.049919 ms
Threads took 5913.425640 ms
MSYNC 27382015120 TOOK 303.000139 ms
CAS was successful! new counter is 11, is_distributed is 0
******** checkp_info saved in 0x400f80180000, curr_checkpoint is 0x400f80180000
0, 11
Parall_iter 1, Write new metadata at address 0x400f80200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 96, parall_iter is 1, num_threads is 4, last counter is 11, curr_counter is 12
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4015e0410000, curr_pr_arr is 0x4015e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4015e0410000!
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401778471a00!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4019104d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401aa8534e00!
Thread ID: 5, savenvm_thread_nd took 5440.184818 ms
Thread ID: 5, set_cpu took 0.084477 ms
Thread ID: 6, savenvm_thread_nd took 5477.239559 ms
Thread ID: 6, set_cpu took 0.064638 ms
Thread ID: 7, savenvm_thread_nd took 5931.361844 ms
Thread ID: 7, set_cpu took 0.051679 ms
Thread ID: 8, savenvm_thread_nd took 5988.762127 ms
Thread ID: 8, set_cpu took 0.050462 ms
Threads took 5988.978089 ms
MSYNC 27382015120 TOOK 221.400031 ms
CAS was successful! new counter is 12, is_distributed is 0
******** checkp_info saved in 0x400f80200000, curr_checkpoint is 0x400f80200000
1, 12
Parall_iter 0, Write new metadata at address 0x400f80180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 102, parall_iter is 0, num_threads is 4, last counter is 12, curr_counter is 13
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f80280000, curr_pr_arr is 0x400f80280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x4011182e1a00!
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400f80280000!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x4012b0343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4014483a4e00!
Thread ID: 1, savenvm_thread_nd took 5463.579132 ms
Thread ID: 1, set_cpu took 0.097085 ms
Thread ID: 2, savenvm_thread_nd took 5499.985285 ms
Thread ID: 2, set_cpu took 0.067422 ms
Thread ID: 3, savenvm_thread_nd took 5812.089251 ms
Thread ID: 3, set_cpu took 0.057694 ms
Thread ID: 4, savenvm_thread_nd took 5862.462701 ms
Thread ID: 4, set_cpu took 0.051071 ms
Threads took 5862.698599 ms
MSYNC 27382015120 TOOK 311.026686 ms
CAS was successful! new counter is 13, is_distributed is 0
******** checkp_info saved in 0x400f80180000, curr_checkpoint is 0x400f80180000
0, 13
Parall_iter 1, Write new metadata at address 0x400f80200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 26, parall_iter is 1, num_threads is 4, last counter is 13, curr_counter is 14
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4015e0410000, curr_pr_arr is 0x4015e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401778471a00!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4015e0410000!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4019104d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401aa8534e00!
Thread ID: 5, savenvm_thread_nd took 5501.140355 ms
Thread ID: 5, set_cpu took 0.090749 ms
Thread ID: 6, savenvm_thread_nd took 5536.533705 ms
Thread ID: 6, set_cpu took 0.065214 ms
Thread ID: 7, savenvm_thread_nd took 5925.869271 ms
Thread ID: 7, set_cpu took 0.050943 ms
Thread ID: 8, savenvm_thread_nd took 5984.714759 ms
Thread ID: 8, set_cpu took 0.051358 ms
Threads took 5984.938273 ms
MSYNC 27382015120 TOOK 207.979499 ms
CAS was successful! new counter is 14, is_distributed is 0
******** checkp_info saved in 0x400f80200000, curr_checkpoint is 0x400f80200000
1, 14
Parall_iter 0, Write new metadata at address 0x400f80180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 38, parall_iter is 0, num_threads is 4, last counter is 14, curr_counter is 15
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f80280000, curr_pr_arr is 0x400f80280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400f80280000!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x4011182e1a00!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x4012b0343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4014483a4e00!
Thread ID: 1, savenvm_thread_nd took 5526.437525 ms
Thread ID: 1, set_cpu took 0.089149 ms
Thread ID: 2, savenvm_thread_nd took 5566.112093 ms
Thread ID: 2, set_cpu took 0.060766 ms
Thread ID: 3, savenvm_thread_nd took 5821.152374 ms
Thread ID: 3, set_cpu took 0.052703 ms
Thread ID: 4, savenvm_thread_nd took 5865.800715 ms
Thread ID: 4, set_cpu took 0.051326 ms
Threads took 5866.022213 ms
MSYNC 27382015120 TOOK 253.015734 ms
CAS was successful! new counter is 15, is_distributed is 0
******** checkp_info saved in 0x400f80180000, curr_checkpoint is 0x400f80180000
0, 15
Parall_iter 1, Write new metadata at address 0x400f80200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 67, parall_iter is 1, num_threads is 4, last counter is 15, curr_counter is 16
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4015e0410000, curr_pr_arr is 0x4015e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401778471a00!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4015e0410000!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4019104d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401aa8534e00!
Thread ID: 5, savenvm_thread_nd took 5537.557355 ms
Thread ID: 5, set_cpu took 0.095325 ms
Thread ID: 6, savenvm_thread_nd took 5582.142498 ms
Thread ID: 6, set_cpu took 0.069278 ms
Thread ID: 7, savenvm_thread_nd took 5853.859534 ms
Thread ID: 7, set_cpu took 0.051198 ms
Thread ID: 8, savenvm_thread_nd took 5914.339308 ms
Thread ID: 8, set_cpu took 0.049567 ms
Threads took 5914.563526 ms
MSYNC 27382015120 TOOK 2025-05-23 16:42:16,613 - root - INFO - Step: 345 | Loss: 7.65 | Tokens per second: 4324.74 | Training tokens per second (%): 38.32 | MFU (%): 5.99 | TFLOPs: 59.21
2025-05-23 16:42:17,964 - root - INFO - Step: 350 | Loss: 7.65 | Tokens per second: 7719.92 | Training tokens per second (%): 38.50 | MFU (%): 10.69 | TFLOPs: 105.69
2025-05-23 16:42:19,307 - root - INFO - Step: 355 | Loss: 7.52 | Tokens per second: 7767.10 | Training tokens per second (%): 18.47 | MFU (%): 10.75 | TFLOPs: 106.34
2025-05-23 16:42:20,669 - root - INFO - Step: 360 | Loss: 7.18 | Tokens per second: 7658.31 | Training tokens per second (%): 50.04 | MFU (%): 10.60 | TFLOPs: 104.85
2025-05-23 16:42:20,710 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:42:20,711 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:42:22,991 - root - INFO - Step: 365 | Loss: 7.22 | Tokens per second: 4457.86 | Training tokens per second (%): 41.02 | MFU (%): 6.17 | TFLOPs: 61.03
2025-05-23 16:42:24,335 - root - INFO - Step: 370 | Loss: 6.79 | Tokens per second: 7761.42 | Training tokens per second (%): 35.15 | MFU (%): 10.74 | TFLOPs: 106.26
2025-05-23 16:42:25,712 - root - INFO - Step: 375 | Loss: 7.76 | Tokens per second: 7571.68 | Training tokens per second (%): 78.84 | MFU (%): 10.48 | TFLOPs: 103.66
2025-05-23 16:42:27,091 - root - INFO - Step: 380 | Loss: 6.59 | Tokens per second: 7557.41 | Training tokens per second (%): 49.27 | MFU (%): 10.46 | TFLOPs: 103.47
2025-05-23 16:42:27,117 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:42:27,119 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:42:29,368 - root - INFO - Step: 385 | Loss: 7.13 | Tokens per second: 4547.27 | Training tokens per second (%): 34.22 | MFU (%): 6.29 | TFLOPs: 62.26
2025-05-23 16:42:30,724 - root - INFO - Step: 390 | Loss: 7.00 | Tokens per second: 7691.54 | Training tokens per second (%): 41.74 | MFU (%): 10.65 | TFLOPs: 105.30
2025-05-23 16:42:32,077 - root - INFO - Step: 395 | Loss: 7.46 | Tokens per second: 7705.36 | Training tokens per second (%): 45.66 | MFU (%): 10.67 | TFLOPs: 105.49
2025-05-23 16:42:33,426 - root - INFO - Step: 400 | Loss: 7.03 | Tokens per second: 7732.98 | Training tokens per second (%): 36.79 | MFU (%): 10.70 | TFLOPs: 105.87
2025-05-23 16:42:33,451 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:42:33,452 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
total_size: 6845503780, bsize: 6845503780, ratio: 2.0
6845503780 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 229.06160354614258 ms
CPU copy took 6173.918724060059 ms
---------------------- [PERF] Single Checkpoint time is 6.4236650466918945 sec, average is 6.423661470413208
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 227.7522087097168 ms
CPU copy took 6144.615173339844 ms
---------------------- [PERF] Single Checkpoint time is 6.3878514766693115 sec, average is 6.4057546854019165
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 227.5381088256836 ms
CPU copy took 6201.9617557525635 ms
---------------------- [PERF] Single Checkpoint time is 6.450010061264038 sec, average is 6.423661470413208
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 227.46038436889648 ms
CPU copy took 6161.519765853882 ms
---------------------- [PERF] Single Checkpoint time is 6.404435634613037 sec, average is 6.414047479629517
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 227.45752334594727 ms
CPU copy took 6185.184955596924 ms
---------------------- [PERF] Single Checkpoint time is 6.428148984909058 sec, average is 6.423661470413208
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 227.73361206054688 ms
CPU copy took 6167.5567626953125 ms
---------------------- [PERF] Single Checkpoint time is 6.410761594772339 sec, average is 6.417210936546326
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 227.51855850219727 ms
CPU copy took 6137.86768913269 ms
---------------------- [PERF] Single Checkpoint time is 6.38083028793335 sec, average is 6.410760402679443
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 227.48184204101562 ms
CPU copy took 6204.502105712891 ms
---------------------- [PERF] Single Checkpoint time is 6.4475085735321045 sec, average is 6.417210936546326
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 227.45728492736816 ms
CPU copy took 6233.389616012573 ms
---------------------- [PERF] Single Checkpoint time is 6.476307153701782 sec, average is 6.423661470413208
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 227.79297828674316 ms
CPU copy took 6221.314907073975 ms
---------------------- [PERF] Single Checkpoint time is 6.464594602584839 sec, average is 6.425903916358948
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 227.52022743225098 ms
CPU copy took 6221.968173980713 ms
---------------------- [PERF] Single Checkpoint time is 6.464972496032715 sec, average is 6.4281463623046875
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 227.54454612731934 ms
CPU copy took 6215.9247398376465 ms
---------------------- [PERF] Single Checkpoint time is 6.464008331298828 sec, average is 6.437826633453369
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 227.4174690246582 ms
CPU copy took 6179.242849349976 ms
---------------------- [PERF] Single Checkpoint time is 6.427206754684448 sec, average is 6.4281463623046875
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 227.6761531829834 ms
CPU copy took 6198.422908782959 ms
---------------------- [PERF] Single Checkpoint time is 6.441595792770386 sec, average is 6.43487024307251
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 227.53572463989258 ms
CPU copy took 6124.578237533569 ms
---------------------- [PERF] Single Checkpoint time is 6.367584705352783 sec, average is 6.4281463623046875
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 227.5397777557373 ms
CPU copy took 6167.375326156616 ms
---------------------- [PERF] Single Checkpoint time is 6.410397529602051 sec, average is 6.427675843238831
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 227.5552749633789 ms
CPU copy took 6131.100177764893 ms
---------------------- [PERF] Single Checkpoint time is 6.374143123626709 sec, average is 6.427205324172974
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 227.75006294250488 ms
CPU copy took 6122.414588928223 ms
---------------------- [PERF] Single Checkpoint time is 6.3656182289123535 sec, average is 6.425433397293091
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 227.54764556884766 ms
CPU copy took 6160.568714141846 ms
---------------------- [PERF] Single Checkpoint time is 6.403630018234253 sec, average is 6.423661470413208
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 227.2646427154541 ms
CPU copy took 6144.2906856536865 ms
---------------------- [PERF] Single Checkpoint time is 6.37196683883667 sec, average is 6.417210936546326
---- exit
247.134883 ms
CAS was successful! new counter is 16, is_distributed is 0
******** checkp_info saved in 0x400f80200000, curr_checkpoint is 0x400f80200000
1, 16
Parall_iter 0, Write new metadata at address 0x400f80180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 73, parall_iter is 0, num_threads is 4, last counter is 16, curr_counter is 17
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f80280000, curr_pr_arr is 0x400f80280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x4011182e1a00!
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400f80280000!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x4012b0343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4014483a4e00!
Thread ID: 1, savenvm_thread_nd took 5433.792238 ms
Thread ID: 1, set_cpu took 0.088510 ms
Thread ID: 2, savenvm_thread_nd took 5465.980436 ms
Thread ID: 2, set_cpu took 0.065854 ms
Thread ID: 3, savenvm_thread_nd took 5852.069186 ms
Thread ID: 3, set_cpu took 0.050846 ms
Thread ID: 4, savenvm_thread_nd took 5891.084765 ms
Thread ID: 4, set_cpu took 0.050879 ms
Threads took 5891.334518 ms
MSYNC 27382015120 TOOK 234.231650 ms
CAS was successful! new counter is 17, is_distributed is 0
******** checkp_info saved in 0x400f80180000, curr_checkpoint is 0x400f80180000
0, 17
Parall_iter 1, Write new metadata at address 0x400f80200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 122, parall_iter is 1, num_threads is 4, last counter is 17, curr_counter is 18
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4015e0410000, curr_pr_arr is 0x4015e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4015e0410000!
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401778471a00!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4019104d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401aa8534e00!
Thread ID: 5, savenvm_thread_nd took 5471.551898 ms
Thread ID: 5, set_cpu took 0.083518 ms
Thread ID: 6, savenvm_thread_nd took 5518.569537 ms
Thread ID: 6, set_cpu took 0.058079 ms
Thread ID: 7, savenvm_thread_nd took 5795.437321 ms
Thread ID: 7, set_cpu took 0.050590 ms
Thread ID: 8, savenvm_thread_nd took 5851.238326 ms
Thread ID: 8, set_cpu took 0.049823 ms
Threads took 5851.451535 ms
MSYNC 27382015120 TOOK 265.427572 ms
CAS was successful! new counter is 18, is_distributed is 0
******** checkp_info saved in 0x400f80200000, curr_checkpoint is 0x400f80200000
1, 18
Parall_iter 0, Write new metadata at address 0x400f80180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 0, parall_iter is 0, num_threads is 4, last counter is 18, curr_counter is 19
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f80280000, curr_pr_arr is 0x400f80280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400f80280000!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x4011182e1a00!
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x4012b0343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4014483a4e00!
Thread ID: 1, savenvm_thread_nd took 5486.346388 ms
Thread ID: 1, set_cpu took 0.094845 ms
Thread ID: 2, savenvm_thread_nd took 5528.015428 ms
Thread ID: 2, set_cpu took 0.072350 ms
Thread ID: 4, savenvm_thread_nd took 5854.743958 ms
Thread ID: 4, set_cpu took 0.051327 ms
Thread ID: 3, savenvm_thread_nd took 6050.282527 ms
Thread ID: 3, set_cpu took 0.056670 ms
Threads took 6050.506007 ms
MSYNC 27382015120 TOOK 104.504990 ms
CAS was successful! new counter is 19, is_distributed is 0
******** checkp_info saved in 0x400f80180000, curr_checkpoint is 0x400f80180000
0, 19
Parall_iter 1, Write new metadata at address 0x400f80200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 31, parall_iter is 1, num_threads is 4, last counter is 19, curr_counter is 20
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4015e0410000, curr_pr_arr is 0x4015e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401778471a00!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4015e0410000!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4019104d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401aa8534e00!
Thread ID: 5, savenvm_thread_nd took 5495.986977 ms
Thread ID: 5, set_cpu took 0.099613 ms
Thread ID: 6, savenvm_thread_nd took 5548.942281 ms
Thread ID: 6, set_cpu took 0.069118 ms
Thread ID: 7, savenvm_thread_nd took 5838.449855 ms
Thread ID: 7, set_cpu took 0.053310 ms
Thread ID: 8, savenvm_thread_nd took 5900.346953 ms
Thread ID: 8, set_cpu took 0.049887 ms
Threads took 5900.593698 ms
MSYNC 27382015120 TOOK 243.189401 ms
CAS was successful! new counter is 20, is_distributed is 0
******** checkp_info saved in 0x400f80200000, curr_checkpoint is 0x400f80200000
1, 20
2025-05-23 16:42:42,540 - root - INFO - Training completed
2025-05-23 16:42:42,540 - root - INFO - Training run end: total time taken 135.72 seconds
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
==== PCCHECK END ====
==== RUNNING BASELINE FOR 1024 WITH bf16 ====
2025-05-23 16:42:46,874 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_1024/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-23 16:42:46,876 - root - INFO - Setting up DataLoaders...
2025-05-23 16:42:47,983 - root - INFO - Setting up Model...
2025-05-23 16:42:56,410 - root - INFO - Starting training!
2025-05-23 16:42:56,973 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 1812.46 | Training tokens per second (%): 77.54 | MFU (%): 0.76 | TFLOPs: 7.48
2025-05-23 16:42:57,462 - root - INFO - Step: 5 | Loss: 11.92 | Tokens per second: 8404.76 | Training tokens per second (%): 40.14 | MFU (%): 3.51 | TFLOPs: 34.69
2025-05-23 16:42:58,049 - root - INFO - Step: 10 | Loss: 11.93 | Tokens per second: 8745.84 | Training tokens per second (%): 83.77 | MFU (%): 3.65 | TFLOPs: 36.10
2025-05-23 16:42:58,618 - root - INFO - Step: 15 | Loss: 11.86 | Tokens per second: 9034.13 | Training tokens per second (%): 57.17 | MFU (%): 3.77 | TFLOPs: 37.29
2025-05-23 16:42:59,204 - root - INFO - Step: 20 | Loss: 11.87 | Tokens per second: 8750.70 | Training tokens per second (%): 75.68 | MFU (%): 3.65 | TFLOPs: 36.12
2025-05-23 16:43:02,260 - root - INFO - Checkpoint saved in 3.0560 seconds
2025-05-23 16:43:02,262 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:02,844 - root - INFO - Step: 25 | Loss: 11.79 | Tokens per second: 1407.37 | Training tokens per second (%): 70.53 | MFU (%): 0.59 | TFLOPs: 5.81
2025-05-23 16:43:03,424 - root - INFO - Step: 30 | Loss: 11.72 | Tokens per second: 8847.44 | Training tokens per second (%): 68.73 | MFU (%): 3.69 | TFLOPs: 36.52
2025-05-23 16:43:03,995 - root - INFO - Step: 35 | Loss: 11.66 | Tokens per second: 8983.79 | Training tokens per second (%): 49.82 | MFU (%): 3.75 | TFLOPs: 37.08
2025-05-23 16:43:04,571 - root - INFO - Step: 40 | Loss: 11.75 | Tokens per second: 8911.73 | Training tokens per second (%): 39.80 | MFU (%): 3.72 | TFLOPs: 36.78
2025-05-23 16:43:06,978 - root - INFO - Checkpoint saved in 2.4062 seconds
2025-05-23 16:43:06,978 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:07,564 - root - INFO - Step: 45 | Loss: 11.52 | Tokens per second: 1711.81 | Training tokens per second (%): 62.34 | MFU (%): 0.71 | TFLOPs: 7.07
2025-05-23 16:43:08,139 - root - INFO - Step: 50 | Loss: 11.55 | Tokens per second: 8929.20 | Training tokens per second (%): 40.70 | MFU (%): 3.73 | TFLOPs: 36.86
2025-05-23 16:43:08,723 - root - INFO - Step: 55 | Loss: 11.64 | Tokens per second: 8780.41 | Training tokens per second (%): 71.37 | MFU (%): 3.66 | TFLOPs: 36.24
2025-05-23 16:43:09,305 - root - INFO - Step: 60 | Loss: 11.52 | Tokens per second: 8823.31 | Training tokens per second (%): 79.02 | MFU (%): 3.68 | TFLOPs: 36.42
2025-05-23 16:43:11,714 - root - INFO - Checkpoint saved in 2.4094 seconds
2025-05-23 16:43:11,715 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:12,312 - root - INFO - Step: 65 | Loss: 11.62 | Tokens per second: 1703.60 | Training tokens per second (%): 73.18 | MFU (%): 0.71 | TFLOPs: 7.03
2025-05-23 16:43:12,895 - root - INFO - Step: 70 | Loss: 11.47 | Tokens per second: 8795.58 | Training tokens per second (%): 44.98 | MFU (%): 3.67 | TFLOPs: 36.30
2025-05-23 16:43:13,470 - root - INFO - Step: 75 | Loss: 11.36 | Tokens per second: 8934.58 | Training tokens per second (%): 46.62 | MFU (%): 3.73 | TFLOPs: 36.88
2025-05-23 16:43:14,049 - root - INFO - Step: 80 | Loss: 11.40 | Tokens per second: 8868.02 | Training tokens per second (%): 57.97 | MFU (%): 3.70 | TFLOPs: 36.60
2025-05-23 16:43:16,443 - root - INFO - Checkpoint saved in 2.3940 seconds
2025-05-23 16:43:16,445 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:17,023 - root - INFO - Step: 85 | Loss: 11.35 | Tokens per second: 1722.37 | Training tokens per second (%): 64.18 | MFU (%): 0.72 | TFLOPs: 7.11
2025-05-23 16:43:17,624 - root - INFO - Step: 90 | Loss: 11.27 | Tokens per second: 8542.34 | Training tokens per second (%): 93.67 | MFU (%): 3.57 | TFLOPs: 35.26
2025-05-23 16:43:18,225 - root - INFO - Step: 95 | Loss: 11.20 | Tokens per second: 8534.59 | Training tokens per second (%): 88.40 | MFU (%): 3.56 | TFLOPs: 35.23
2025-05-23 16:43:18,832 - root - INFO - Step: 100 | Loss: 11.20 | Tokens per second: 8463.62 | Training tokens per second (%): 100.00 | MFU (%): 3.53 | TFLOPs: 34.93
2025-05-23 16:43:21,228 - root - INFO - Checkpoint saved in 2.3963 seconds
2025-05-23 16:43:21,230 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:21,824 - root - INFO - Step: 105 | Loss: 11.25 | Tokens per second: 1712.05 | Training tokens per second (%): 46.11 | MFU (%): 0.71 | TFLOPs: 7.07
2025-05-23 16:43:22,417 - root - INFO - Step: 110 | Loss: 11.20 | Tokens per second: 8647.25 | Training tokens per second (%): 43.05 | MFU (%): 3.61 | TFLOPs: 35.69
2025-05-23 16:43:22,995 - root - INFO - Step: 115 | Loss: 11.05 | Tokens per second: 8883.05 | Training tokens per second (%): 39.90 | MFU (%): 3.71 | TFLOPs: 36.67
2025-05-23 16:43:23,579 - root - INFO - Step: 120 | Loss: 10.97 | Tokens per second: 8788.13 | Training tokens per second (%): 66.80 | MFU (%): 3.67 | TFLOPs: 36.27
2025-05-23 16:43:25,975 - root - INFO - Checkpoint saved in 2.3961 seconds
2025-05-23 16:43:25,977 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:26,577 - root - INFO - Step: 125 | Loss: 11.26 | Tokens per second: 1708.85 | Training tokens per second (%): 58.54 | MFU (%): 0.71 | TFLOPs: 7.05
2025-05-23 16:43:27,158 - root - INFO - Step: 130 | Loss: 11.24 | Tokens per second: 8827.54 | Training tokens per second (%): 42.27 | MFU (%): 3.68 | TFLOPs: 36.44
2025-05-23 16:43:27,742 - root - INFO - Step: 135 | Loss: 10.84 | Tokens per second: 8786.81 | Training tokens per second (%): 63.54 | MFU (%): 3.67 | TFLOPs: 36.27
2025-05-23 16:43:28,317 - root - INFO - Step: 140 | Loss: 11.03 | Tokens per second: 8929.13 | Training tokens per second (%): 45.02 | MFU (%): 3.73 | TFLOPs: 36.86
2025-05-23 16:43:30,713 - root - INFO - Checkpoint saved in 2.3955 seconds
2025-05-23 16:43:30,714 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:31,317 - root - INFO - Step: 145 | Loss: 10.80 | Tokens per second: 1707.59 | Training tokens per second (%): 59.90 | MFU (%): 0.71 | TFLOPs: 7.05
2025-05-23 16:43:31,894 - root - INFO - Step: 150 | Loss: 10.98 | Tokens per second: 8891.49 | Training tokens per second (%): 67.87 | MFU (%): 3.71 | TFLOPs: 36.70
2025-05-23 16:43:32,485 - root - INFO - Step: 155 | Loss: 10.93 | Tokens per second: 8690.10 | Training tokens per second (%): 87.15 | MFU (%): 3.63 | TFLOPs: 35.87
2025-05-23 16:43:33,067 - root - INFO - Step: 160 | Loss: 10.52 | Tokens per second: 8828.02 | Training tokens per second (%): 64.86 | MFU (%): 3.68 | TFLOPs: 36.44
2025-05-23 16:43:35,458 - root - INFO - Checkpoint saved in 2.3917 seconds
2025-05-23 16:43:35,460 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:36,071 - root - INFO - Step: 165 | Loss: 10.69 | Tokens per second: 1704.92 | Training tokens per second (%): 45.74 | MFU (%): 0.71 | TFLOPs: 7.04
2025-05-23 16:43:36,658 - root - INFO - Step: 170 | Loss: 10.88 | Tokens per second: 8741.05 | Training tokens per second (%): 78.38 | MFU (%): 3.65 | TFLOPs: 36.08
2025-05-23 16:43:37,237 - root - INFO - Step: 175 | Loss: 11.02 | Tokens per second: 8864.65 | Training tokens per second (%): 57.73 | MFU (%): 3.70 | TFLOPs: 36.59
2025-05-23 16:43:37,814 - root - INFO - Step: 180 | Loss: 10.84 | Tokens per second: 8901.39 | Training tokens per second (%): 58.32 | MFU (%): 3.71 | TFLOPs: 36.74
2025-05-23 16:43:40,209 - root - INFO - Checkpoint saved in 2.3947 seconds
2025-05-23 16:43:40,210 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:40,811 - root - INFO - Step: 185 | Loss: 11.03 | Tokens per second: 1709.50 | Training tokens per second (%): 50.92 | MFU (%): 0.71 | TFLOPs: 7.06
2025-05-23 16:43:41,397 - root - INFO - Step: 190 | Loss: 10.81 | Tokens per second: 8749.07 | Training tokens per second (%): 62.42 | MFU (%): 3.65 | TFLOPs: 36.11
2025-05-23 16:43:42,006 - root - INFO - Step: 195 | Loss: 10.58 | Tokens per second: 8426.61 | Training tokens per second (%): 50.66 | MFU (%): 3.52 | TFLOPs: 34.78
2025-05-23 16:43:42,584 - root - INFO - Step: 200 | Loss: 10.93 | Tokens per second: 8889.14 | Training tokens per second (%): 52.85 | MFU (%): 3.71 | TFLOPs: 36.69
2025-05-23 16:43:44,978 - root - INFO - Checkpoint saved in 2.3936 seconds
2025-05-23 16:43:44,979 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:45,552 - root - INFO - Step: 205 | Loss: 10.52 | Tokens per second: 1725.60 | Training tokens per second (%): 38.81 | MFU (%): 0.72 | TFLOPs: 7.12
2025-05-23 16:43:46,127 - root - INFO - Step: 210 | Loss: 10.55 | Tokens per second: 8933.09 | Training tokens per second (%): 67.71 | MFU (%): 3.73 | TFLOPs: 36.87
2025-05-23 16:43:46,700 - root - INFO - Step: 215 | Loss: 10.46 | Tokens per second: 8958.11 | Training tokens per second (%): 48.05 | MFU (%): 3.74 | TFLOPs: 36.98
2025-05-23 16:43:47,280 - root - INFO - Step: 220 | Loss: 10.67 | Tokens per second: 8848.83 | Training tokens per second (%): 47.36 | MFU (%): 3.69 | TFLOPs: 36.52
2025-05-23 16:43:49,677 - root - INFO - Checkpoint saved in 2.3964 seconds
2025-05-23 16:43:49,678 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:50,271 - root - INFO - Step: 225 | Loss: 10.53 | Tokens per second: 1712.77 | Training tokens per second (%): 59.55 | MFU (%): 0.71 | TFLOPs: 7.07
2025-05-23 16:43:50,846 - root - INFO - Step: 230 | Loss: 10.31 | Tokens per second: 8924.84 | Training tokens per second (%): 25.08 | MFU (%): 3.72 | TFLOPs: 36.84
2025-05-23 16:43:51,422 - root - INFO - Step: 235 | Loss: 10.49 | Tokens per second: 8907.59 | Training tokens per second (%): 43.71 | MFU (%): 3.72 | TFLOPs: 36.77
2025-05-23 16:43:52,008 - root - INFO - Step: 240 | Loss: 10.49 | Tokens per second: 8766.75 | Training tokens per second (%): 71.23 | MFU (%): 3.66 | TFLOPs: 36.19
2025-05-23 16:43:54,401 - root - INFO - Checkpoint saved in 2.3935 seconds
2025-05-23 16:43:54,403 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:55,007 - root - INFO - Step: 245 | Loss: 10.55 | Tokens per second: 1707.94 | Training tokens per second (%): 58.46 | MFU (%): 0.71 | TFLOPs: 7.05
2025-05-23 16:43:55,599 - root - INFO - Step: 250 | Loss: 10.66 | Tokens per second: 8670.20 | Training tokens per second (%): 53.71 | MFU (%): 3.62 | TFLOPs: 35.79
2025-05-23 16:43:56,174 - root - INFO - Step: 255 | Loss: 10.72 | Tokens per second: 8927.28 | Training tokens per second (%): 42.27 | MFU (%): 3.73 | TFLOPs: 36.85
2025-05-23 16:43:56,761 - root - INFO - Step: 260 | Loss: 10.91 | Tokens per second: 8746.70 | Training tokens per second (%): 60.08 | MFU (%): 3.65 | TFLOPs: 36.10
2025-05-23 16:43:59,154 - root - INFO - Checkpoint saved in 2.3930 seconds
2025-05-23 16:43:59,156 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:43:59,746 - root - INFO - Step: 265 | Loss: 10.68 | Tokens per second: 1715.90 | Training tokens per second (%): 50.68 | MFU (%): 0.72 | TFLOPs: 7.08
2025-05-23 16:44:00,322 - root - INFO - Step: 270 | Loss: 10.48 | Tokens per second: 8919.79 | Training tokens per second (%): 68.73 | MFU (%): 3.72 | TFLOPs: 36.82
2025-05-23 16:44:00,901 - root - INFO - Step: 275 | Loss: 10.51 | Tokens per second: 8858.66 | Training tokens per second (%): 47.05 | MFU (%): 3.70 | TFLOPs: 36.56
2025-05-23 16:44:01,482 - root - INFO - Step: 280 | Loss: 10.49 | Tokens per second: 8830.55 | Training tokens per second (%): 65.78 | MFU (%): 3.69 | TFLOPs: 36.45
2025-05-23 16:44:03,861 - root - INFO - Checkpoint saved in 2.3788 seconds
2025-05-23 16:44:03,863 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:44:04,455 - root - INFO - Step: 285 | Loss: 10.55 | Tokens per second: 1723.49 | Training tokens per second (%): 73.09 | MFU (%): 0.72 | TFLOPs: 7.11
2025-05-23 16:44:05,032 - root - INFO - Step: 290 | Loss: 10.68 | Tokens per second: 8885.01 | Training tokens per second (%): 54.63 | MFU (%): 3.71 | TFLOPs: 36.67
2025-05-23 16:44:05,607 - root - INFO - Step: 295 | Loss: 10.49 | Tokens per second: 8938.68 | Training tokens per second (%): 44.59 | MFU (%): 3.73 | TFLOPs: 36.90
2025-05-23 16:44:06,204 - root - INFO - Step: 300 | Loss: 10.42 | Tokens per second: 8588.85 | Training tokens per second (%): 83.14 | MFU (%): 3.58 | TFLOPs: 35.45
2025-05-23 16:44:08,604 - root - INFO - Checkpoint saved in 2.3996 seconds
2025-05-23 16:44:08,606 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:44:09,201 - root - INFO - Step: 305 | Loss: 10.63 | Tokens per second: 1709.59 | Training tokens per second (%): 64.26 | MFU (%): 0.71 | TFLOPs: 7.06
2025-05-23 16:44:09,775 - root - INFO - Step: 310 | Loss: 10.49 | Tokens per second: 8935.16 | Training tokens per second (%): 58.93 | MFU (%): 3.73 | TFLOPs: 36.88
2025-05-23 16:44:10,355 - root - INFO - Step: 315 | Loss: 10.12 | Tokens per second: 8853.80 | Training tokens per second (%): 64.43 | MFU (%): 3.70 | TFLOPs: 36.54
2025-05-23 16:44:10,938 - root - INFO - Step: 320 | Loss: 10.40 | Tokens per second: 8799.50 | Training tokens per second (%): 73.79 | MFU (%): 3.67 | TFLOPs: 36.32
2025-05-23 16:44:13,333 - root - INFO - Checkpoint saved in 2.3948 seconds
2025-05-23 16:44:13,335 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:44:13,918 - root - INFO - Step: 325 | Loss: 10.47 | Tokens per second: 1719.26 | Training tokens per second (%): 49.69 | MFU (%): 0.72 | TFLOPs: 7.10
2025-05-23 16:44:14,508 - root - INFO - Step: 330 | Loss: 9.94 | Tokens per second: 8696.54 | Training tokens per second (%): 60.96 | MFU (%): 3.63 | TFLOPs: 35.90
2025-05-23 16:44:15,085 - root - INFO - Step: 335 | Loss: 10.51 | Tokens per second: 8888.17 | Training tokens per second (%): 24.41 | MFU (%): 3.71 | TFLOPs: 36.69
2025-05-23 16:44:15,661 - root - INFO - Step: 340 | Loss: 10.52 | Tokens per second: 8919.73 | Training tokens per second (%): 59.49 | MFU (%): 3.72 | TFLOPs: 36.82
2025-05-23 16:44:18,057 - root - INFO - Checkpoint saved in 2.3957 seconds
2025-05-23 16:44:18,058 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:44:18,642 - root - INFO - Step: 345 | Loss: 10.39 | Tokens per second: 1718.19 | Training tokens per second (%): 63.32 | MFU (%): 0.72 | TFLOPs: 7.09
2025-05-23 16:44:19,220 - root - INFO - Step: 350 | Loss: 10.69 | Tokens per second: 8883.36 | Training tokens per second (%): 62.03 | MFU (%): 3.71 | TFLOPs: 36.67
2025-05-23 16:44:19,796 - root - INFO - Step: 355 | Loss: 10.30 | Tokens per second: 8906.18 | Training tokens per second (%): 36.93 | MFU (%): 3.72 | TFLOPs: 36.76
2025-05-23 16:44:20,377 - root - INFO - Step: 360 | Loss: 10.00 | Tokens per second: 8839.44 | Training tokens per second (%): 72.48 | MFU (%): 3.69 | TFLOPs: 36.49
2025-05-23 16:44:22,771 - root - INFO - Checkpoint saved in 2.3939 seconds
2025-05-23 16:44:22,773 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:44:23,376 - root - INFO - Step: 365 | Loss: 10.48 | Tokens per second: 1707.97 | Training tokens per second (%): 82.03 | MFU (%): 0.71 | TFLOPs: 7.05
2025-05-23 16:44:23,955 - root - INFO - Step: 370 | Loss: 10.33 | Tokens per second: 8869.94 | Training tokens per second (%): 70.29 | MFU (%): 3.70 | TFLOPs: 36.61
2025-05-23 16:44:24,549 - root - INFO - Step: 375 | Loss: 10.55 | Tokens per second: 8637.02 | Training tokens per second (%): 91.58 | MFU (%): 3.60 | TFLOPs: 35.65
2025-05-23 16:44:25,149 - root - INFO - Step: 380 | Loss: 10.14 | Tokens per second: 8560.32 | Training tokens per second (%): 66.46 | MFU (%): 3.57 | TFLOPs: 35.33
2025-05-23 16:44:27,535 - root - INFO - Checkpoint saved in 2.3858 seconds
2025-05-23 16:44:27,536 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:44:28,133 - root - INFO - Step: 385 | Loss: 10.39 | Tokens per second: 1716.85 | Training tokens per second (%): 48.44 | MFU (%): 0.72 | TFLOPs: 7.09
2025-05-23 16:44:28,716 - root - INFO - Step: 390 | Loss: 10.21 | Tokens per second: 8804.99 | Training tokens per second (%): 63.48 | MFU (%): 3.67 | TFLOPs: 36.34
2025-05-23 16:44:29,297 - root - INFO - Step: 395 | Loss: 10.31 | Tokens per second: 8824.53 | Training tokens per second (%): 73.14 | MFU (%): 3.68 | TFLOPs: 36.42
2025-05-23 16:44:29,884 - root - INFO - Step: 400 | Loss: 10.18 | Tokens per second: 8742.35 | Training tokens per second (%): 53.57 | MFU (%): 3.65 | TFLOPs: 36.08
2025-05-23 16:44:32,279 - root - INFO - Checkpoint saved in 2.3941 seconds
2025-05-23 16:44:32,280 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:44:32,280 - root - INFO - Training completed
2025-05-23 16:44:32,280 - root - INFO - Training run end: total time taken 95.87 seconds
==== BASELINE END ====
==== RUNNING PCCHECK FOR 1024 WITH bf16 ====
2025-05-23 16:44:36,669 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_1024/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-23 16:44:36,673 - root - INFO - Setting up DataLoaders...
2025-05-23 16:44:37,844 - root - INFO - Setting up Model...
Model size: 755041280, Optimizer size: 1510082852, Total size: 2265124132
BSIZE IS 2265124132
At checkpoint, bsize is 2265124132
2025-05-23 16:45:18,538 - root - INFO - Checkpointing warmup done
2025-05-23 16:45:18,539 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 16:45:18,819 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 3686.19 | Training tokens per second (%): 77.54 | MFU (%): 1.54 | TFLOPs: 15.22
2025-05-23 16:45:19,245 - root - INFO - Step: 5 | Loss: 11.92 | Tokens per second: 9655.25 | Training tokens per second (%): 40.14 | MFU (%): 4.03 | TFLOPs: 39.85
2025-05-23 16:45:19,771 - root - INFO - Step: 10 | Loss: 11.93 | Tokens per second: 9746.39 | Training tokens per second (%): 83.77 | MFU (%): 4.07 | TFLOPs: 40.23
2025-05-23 16:45:20,313 - root - INFO - Step: 15 | Loss: 11.86 | Tokens per second: 9483.52 | Training tokens per second (%): 57.17 | MFU (%): 3.96 | TFLOPs: 39.14
2025-05-23 16:45:20,871 - root - INFO - Step: 20 | Loss: 11.87 | Tokens per second: 9197.23 | Training tokens per second (%): 75.68 | MFU (%): 3.84 | TFLOPs: 37.96
2025-05-23 16:45:20,909 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:20,910 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:21,499 - root - INFO - Step: 25 | Loss: 11.79 | Tokens per second: 8163.43 | Training tokens per second (%): 70.53 | MFU (%): 3.41 | TFLOPs: 33.70
2025-05-23 16:45:22,111 - root - INFO - Step: 30 | Loss: 11.72 | Tokens per second: 8390.70 | Training tokens per second (%): 68.73 | MFU (%): 3.50 | TFLOPs: 34.63
2025-05-23 16:45:22,707 - root - INFO - Step: 35 | Loss: 11.65 | Tokens per second: 8619.48 | Training tokens per second (%): 49.82 | MFU (%): 3.60 | TFLOPs: 35.58
2025-05-23 16:45:23,240 - root - INFO - Step: 40 | Loss: 11.75 | Tokens per second: 9629.79 | Training tokens per second (%): 39.80 | MFU (%): 4.02 | TFLOPs: 39.75
2025-05-23 16:45:23,284 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:23,285 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:23,871 - root - INFO - Step: 45 | Loss: 11.51 | Tokens per second: 8134.06 | Training tokens per second (%): 62.34 | MFU (%): 3.39 | TFLOPs: 33.57
2025-05-23 16:45:24,458 - root - INFO - Step: 50 | Loss: 11.54 | Tokens per second: 8744.01 | Training tokens per second (%): 40.70 | MFU (%): 3.65 | TFLOPs: 36.09
2025-05-23 16:45:25,036 - root - INFO - Step: 55 | Loss: 11.63 | Tokens per second: 8894.51 | Training tokens per second (%): 71.37 | MFU (%): 3.71 | TFLOPs: 36.71
2025-05-23 16:45:25,580 - root - INFO - Step: 60 | Loss: 11.52 | Tokens per second: 9430.22 | Training tokens per second (%): 79.02 | MFU (%): 3.94 | TFLOPs: 38.92
2025-05-23 16:45:25,623 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:25,624 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:26,206 - root - INFO - Step: 65 | Loss: 11.62 | Tokens per second: 8200.26 | Training tokens per second (%): 73.18 | MFU (%): 3.42 | TFLOPs: 33.85
2025-05-23 16:45:26,803 - root - INFO - Step: 70 | Loss: 11.46 | Tokens per second: 8593.53 | Training tokens per second (%): 44.98 | MFU (%): 3.59 | TFLOPs: 35.47
2025-05-23 16:45:27,392 - root - INFO - Step: 75 | Loss: 11.35 | Tokens per second: 8720.50 | Training tokens per second (%): 46.62 | MFU (%): 3.64 | TFLOPs: 35.99
2025-05-23 16:45:27,928 - root - INFO - Step: 80 | Loss: 11.40 | Tokens per second: 9589.20 | Training tokens per second (%): 57.97 | MFU (%): 4.00 | TFLOPs: 39.58
2025-05-23 16:45:27,970 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:27,972 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:28,551 - root - INFO - Step: 85 | Loss: 11.35 | Tokens per second: 8233.45 | Training tokens per second (%): 64.18 | MFU (%): 3.44 | TFLOPs: 33.98
2025-05-23 16:45:29,174 - root - INFO - Step: 90 | Loss: 11.26 | Tokens per second: 8239.27 | Training tokens per second (%): 93.67 | MFU (%): 3.44 | TFLOPs: 34.01
2025-05-23 16:45:29,776 - root - INFO - Step: 95 | Loss: 11.19 | Tokens per second: 8534.86 | Training tokens per second (%): 88.40 | MFU (%): 3.56 | TFLOPs: 35.23
2025-05-23 16:45:30,336 - root - INFO - Step: 100 | Loss: 11.19 | Tokens per second: 9173.11 | Training tokens per second (%): 100.00 | MFU (%): 3.83 | TFLOPs: 37.86
2025-05-23 16:45:30,379 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:30,380 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:30,959 - root - INFO - Step: 105 | Loss: 11.24 | Tokens per second: 8238.68 | Training tokens per second (%): 46.11 | MFU (%): 3.44 | TFLOPs: 34.01
2025-05-23 16:45:31,553 - root - INFO - Step: 110 | Loss: 11.19 | Tokens per second: 8636.08 | Training tokens per second (%): 43.05 | MFU (%): 3.60 | TFLOPs: 35.65
2025-05-23 16:45:32,138 - root - INFO - Step: 115 | Loss: 11.04 | Tokens per second: 8784.17 | Training tokens per second (%): 39.90 | MFU (%): 3.67 | TFLOPs: 36.26
2025-05-23 16:45:32,673 - root - INFO - Step: 120 | Loss: 10.96 | Tokens per second: 9592.60 | Training tokens per second (%): 66.80 | MFU (%): 4.00 | TFLOPs: 39.59
2025-05-23 16:45:32,718 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:32,719 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x400820280000, PR_ADDR is 0x400820000000, PEER_CHECK_ADDR is 0x400820080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 2265124132
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400820180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 106, parall_iter is 0, num_threads is 4, last counter is 0, curr_counter is 1
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400820280000, curr_pr_arr is 0x400820280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400820280000!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008a72b0e00!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009b5312a00!
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40092e2e1c00!
Thread ID: 4, savenvm_thread_nd took 1721.601311 ms
Thread ID: 4, set_cpu took 0.051294 ms
Thread ID: 1, savenvm_thread_nd took 1740.713262 ms
Thread ID: 1, set_cpu took 0.088189 ms
Thread ID: 2, savenvm_thread_nd took 1819.948784 ms
Thread ID: 2, set_cpu took 0.057886 ms
Thread ID: 3, savenvm_thread_nd took 1820.222024 ms
Thread ID: 3, set_cpu took 0.110076 ms
Threads took 1820.507710 ms
MSYNC 9060496528 TOOK 323.636465 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400820180000, curr_checkpoint is 0x400820180000
0, 1
Parall_iter 1, Write new metadata at address 0x400820200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 4, parall_iter is 1, num_threads is 4, last counter is 1, curr_counter is 2
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b4a3b1c00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a3c350000!
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ac3380e00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bd13e2a00!
Thread ID: 8, savenvm_thread_nd took 1817.343494 ms
Thread ID: 8, set_cpu took 0.051774 ms
Thread ID: 6, savenvm_thread_nd took 1827.066633 ms
Thread ID: 6, set_cpu took 0.069373 ms
Thread ID: 7, savenvm_thread_nd took 1829.283361 ms
Thread ID: 7, set_cpu took 0.056478 ms
Thread ID: 5, savenvm_thread_nd took 1834.624946 ms
Thread ID: 5, set_cpu took 0.096572 ms
Threads took 1834.812076 ms
MSYNC 9060496528 TOOK 328.217690 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400820200000, curr_checkpoint is 0x400820200000
1, 2
Parall_iter 0, Write new metadata at address 0x400820180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 10, parall_iter is 0, num_threads is 4, last counter is 2, curr_counter is 3
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400820280000, curr_pr_arr is 0x400820280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008a72b0e00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400820280000!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40092e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009b5312a00!
Thread ID: 4, savenvm_thread_nd took 1661.309554 ms
Thread ID: 4, set_cpu took 0.047966 ms
Thread ID: 1, savenvm_thread_nd took 1667.262287 ms
Thread ID: 1, set_cpu took 0.083261 ms
Thread ID: 2, savenvm_thread_nd took 1676.064399 ms
Thread ID: 2, set_cpu took 0.066942 ms
Thread ID: 3, savenvm_thread_nd took 1676.821910 ms
Thread ID: 3, set_cpu took 0.052351 ms
Threads took 1676.984433 ms
MSYNC 9060496528 TOOK 443.028883 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400820180000, curr_checkpoint is 0x400820180000
0, 3
Parall_iter 1, Write new metadata at address 0x400820200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 16, parall_iter is 1, num_threads is 4, last counter is 3, curr_counter is 4
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a3c350000!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b4a3b1c00!
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ac3380e00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bd13e2a00!
Thread ID: 5, savenvm_thread_nd took 1694.109570 ms
Thread ID: 5, set_cpu took 0.093181 ms
Thread ID: 8, savenvm_thread_nd took 1698.910052 ms
Thread ID: 8, set_cpu took 0.047967 ms
Thread ID: 6, savenvm_thread_nd took 1708.760643 ms
Thread ID: 6, set_cpu took 0.062398 ms
Thread ID: 7, savenvm_thread_nd took 1710.247603 ms
Thread ID: 7, set_cpu took 0.049246 ms
Threads took 1710.413100 ms
MSYNC 9060496528 TOOK 377.094142 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400820200000, curr_checkpoint is 0x400820200000
1, 4
Parall_iter 0, Write new metadata at address 0x400820180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 22, parall_iter is 0, num_threads is 4, last counter is 4, curr_counter is 5
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400820280000, curr_pr_arr is 0x400820280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008a72b0e00!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40092e2e1c00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400820280000!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009b5312a00!
Thread ID: 4, savenvm_thread_nd took 1694.730445 ms
Thread ID: 4, set_cpu took 0.044607 ms
Thread ID: 1, savenvm_thread_nd took 1701.626028 ms
Thread ID: 1, set_cpu took 0.087645 ms
Thread ID: 3, savenvm_thread_nd took 1713.640836 ms
Thread ID: 3, set_cpu took 0.049054 ms
Thread ID: 2, savenvm_thread_nd took 1715.975927 ms
Thread ID: 2, set_cpu took 0.062526 ms
Threads took 1716.188753 ms
MSYNC 9060496528 TOOK 330.464562 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400820180000, curr_checkpoint is 0x400820180000
0, 5
Parall_iter 1, Write new metadata at address 0x400820200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 28, parall_iter is 1, num_threads is 4, last counter is 5, curr_counter is 6
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a3c3502025-05-23 16:45:33,310 - root - INFO - Step: 125 | Loss: 11.25 | Tokens per second: 8052.25 | Training tokens per second (%): 58.54 | MFU (%): 3.36 | TFLOPs: 33.24
2025-05-23 16:45:33,905 - root - INFO - Step: 130 | Loss: 11.23 | Tokens per second: 8635.26 | Training tokens per second (%): 42.27 | MFU (%): 3.60 | TFLOPs: 35.64
2025-05-23 16:45:34,504 - root - INFO - Step: 135 | Loss: 10.83 | Tokens per second: 8567.62 | Training tokens per second (%): 63.54 | MFU (%): 3.58 | TFLOPs: 35.36
2025-05-23 16:45:35,041 - root - INFO - Step: 140 | Loss: 11.02 | Tokens per second: 9561.51 | Training tokens per second (%): 45.02 | MFU (%): 3.99 | TFLOPs: 39.47
2025-05-23 16:45:35,084 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:35,085 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:35,660 - root - INFO - Step: 145 | Loss: 10.79 | Tokens per second: 8287.28 | Training tokens per second (%): 59.90 | MFU (%): 3.46 | TFLOPs: 34.21
2025-05-23 16:45:36,241 - root - INFO - Step: 150 | Loss: 10.97 | Tokens per second: 8841.73 | Training tokens per second (%): 67.87 | MFU (%): 3.69 | TFLOPs: 36.50
2025-05-23 16:45:36,825 - root - INFO - Step: 155 | Loss: 10.93 | Tokens per second: 8792.65 | Training tokens per second (%): 87.15 | MFU (%): 3.67 | TFLOPs: 36.29
2025-05-23 16:45:37,354 - root - INFO - Step: 160 | Loss: 10.51 | Tokens per second: 9714.98 | Training tokens per second (%): 64.86 | MFU (%): 4.05 | TFLOPs: 40.10
2025-05-23 16:45:37,397 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:37,398 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:37,983 - root - INFO - Step: 165 | Loss: 10.69 | Tokens per second: 8151.26 | Training tokens per second (%): 45.74 | MFU (%): 3.40 | TFLOPs: 33.65
2025-05-23 16:45:38,573 - root - INFO - Step: 170 | Loss: 10.88 | Tokens per second: 8702.34 | Training tokens per second (%): 78.38 | MFU (%): 3.63 | TFLOPs: 35.92
2025-05-23 16:45:39,160 - root - INFO - Step: 175 | Loss: 11.01 | Tokens per second: 8757.07 | Training tokens per second (%): 57.73 | MFU (%): 3.65 | TFLOPs: 36.15
2025-05-23 16:45:39,701 - root - INFO - Step: 180 | Loss: 10.84 | Tokens per second: 9486.34 | Training tokens per second (%): 58.32 | MFU (%): 3.96 | TFLOPs: 39.16
2025-05-23 16:45:39,744 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:39,745 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:40,314 - root - INFO - Step: 185 | Loss: 11.02 | Tokens per second: 8376.10 | Training tokens per second (%): 50.92 | MFU (%): 3.50 | TFLOPs: 34.57
2025-05-23 16:45:40,891 - root - INFO - Step: 190 | Loss: 10.80 | Tokens per second: 8888.64 | Training tokens per second (%): 62.42 | MFU (%): 3.71 | TFLOPs: 36.69
2025-05-23 16:45:41,496 - root - INFO - Step: 195 | Loss: 10.57 | Tokens per second: 8493.01 | Training tokens per second (%): 50.66 | MFU (%): 3.54 | TFLOPs: 35.06
2025-05-23 16:45:42,031 - root - INFO - Step: 200 | Loss: 10.93 | Tokens per second: 9592.06 | Training tokens per second (%): 52.85 | MFU (%): 4.00 | TFLOPs: 39.59
2025-05-23 16:45:42,073 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:42,074 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:42,643 - root - INFO - Step: 205 | Loss: 10.51 | Tokens per second: 8393.23 | Training tokens per second (%): 38.81 | MFU (%): 3.50 | TFLOPs: 34.64
2025-05-23 16:45:43,216 - root - INFO - Step: 210 | Loss: 10.54 | Tokens per second: 8961.11 | Training tokens per second (%): 67.71 | MFU (%): 3.74 | TFLOPs: 36.99
2025-05-23 16:45:43,785 - root - INFO - Step: 215 | Loss: 10.46 | Tokens per second: 9021.00 | Training tokens per second (%): 48.05 | MFU (%): 3.76 | TFLOPs: 37.24
2025-05-23 16:45:44,315 - root - INFO - Step: 220 | Loss: 10.67 | Tokens per second: 9688.28 | Training tokens per second (%): 47.36 | MFU (%): 4.04 | TFLOPs: 39.99
2025-05-23 16:45:44,357 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:44,358 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
CPU: 6, CPU USE: 16
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bd13e2a00!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b4a3b1c00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a3c350000!
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ac3380e00!
Thread ID: 5, savenvm_thread_nd took 1674.331560 ms
Thread ID: 5, set_cpu took 0.091677 ms
Thread ID: 8, savenvm_thread_nd took 1688.765233 ms
Thread ID: 8, set_cpu took 0.045694 ms
Thread ID: 6, savenvm_thread_nd took 1694.357242 ms
Thread ID: 6, set_cpu took 0.079805 ms
Thread ID: 7, savenvm_thread_nd took 1696.601360 ms
Thread ID: 7, set_cpu took 0.058014 ms
Threads took 1696.766954 ms
MSYNC 9060496528 TOOK 396.962517 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400820200000, curr_checkpoint is 0x400820200000
1, 6
Parall_iter 0, Write new metadata at address 0x400820180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 53, parall_iter is 0, num_threads is 4, last counter is 6, curr_counter is 7
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400820280000, curr_pr_arr is 0x400820280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008a72b0e00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400820280000!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40092e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009b5312a00!
Thread ID: 4, savenvm_thread_nd took 1684.969846 ms
Thread ID: 4, set_cpu took 0.050559 ms
Thread ID: 1, savenvm_thread_nd took 1688.432332 ms
Thread ID: 1, set_cpu took 0.092157 ms
Thread ID: 3, savenvm_thread_nd took 1697.192704 ms
Thread ID: 3, set_cpu took 0.060414 ms
Thread ID: 2, savenvm_thread_nd took 1699.214722 ms
Thread ID: 2, set_cpu took 0.069406 ms
Threads took 1699.375645 ms
MSYNC 9060496528 TOOK 385.228836 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x400820180000, curr_checkpoint is 0x400820180000
0, 7
Parall_iter 1, Write new metadata at address 0x400820200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 59, parall_iter is 1, num_threads is 4, last counter is 7, curr_counter is 8
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a3c350000!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ac3380e00!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b4a3b1c00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bd13e2a00!
Thread ID: 5, savenvm_thread_nd took 1774.328351 ms
Thread ID: 5, set_cpu took 0.080189 ms
Thread ID: 8, savenvm_thread_nd took 1780.339111 ms
Thread ID: 8, set_cpu took 0.047902 ms
Thread ID: 6, savenvm_thread_nd took 1789.835779 ms
Thread ID: 6, set_cpu took 0.051550 ms
Thread ID: 7, savenvm_thread_nd took 1793.744203 ms
Thread ID: 7, set_cpu took 0.050911 ms
Threads took 1793.978628 ms
MSYNC 9060496528 TOOK 291.855377 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x400820200000, curr_checkpoint is 0x400820200000
1, 8
Parall_iter 0, Write new metadata at address 0x400820180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 65, parall_iter is 0, num_threads is 4, last counter is 8, curr_counter is 9
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400820280000, curr_pr_arr is 0x400820280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40092e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009b5312a00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400820280000!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008a72b0e00!
Thread ID: 4, savenvm_thread_nd took 1650.246488 ms
Thread ID: 4, set_cpu took 0.049407 ms
Thread ID: 1, savenvm_thread_nd took 1659.077033 ms
Thread ID: 1, set_cpu took 0.092157 ms
Thread ID: 3, savenvm_thread_nd took 1678.510550 ms
Thread ID: 3, set_cpu took 0.060894 ms
Thread ID: 2, savenvm_thread_nd took 1684.241286 ms
Thread ID: 2, set_cpu took 0.071742 ms
Threads took 1684.427488 ms
MSYNC 9060496528 TOOK 385.087080 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x400820180000, curr_checkpoint is 0x400820180000
0, 9
Parall_iter 1, Write new metadata at address 0x400820200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 72, parall_iter is 1, num_threads is 4, last counter is 9, curr_counter is 10
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 5, CPU USE: 15
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bd13e2a00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a3c350000!
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ac3380e00!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b4a3b1c00!
Thread ID: 5, savenvm_thread_nd took 1683.553692 ms
Thread ID: 5, set_cpu took 0.091294 ms
Thread ID: 8, savenvm_thread_nd took 1696.221176 ms
Thread ID: 8, set_cpu took 0.048223 ms
Thread ID: 6, savenvm_thread_nd took 1704.794193 ms
Thread ID: 6, set_cpu took 0.079134 ms
Thread ID: 7, savenvm_thread_nd took 1705.964302 ms
Thread ID: 7, set_cpu took 0.058911 ms
Threads took 1706.134024 ms
MSYNC 9060496528 TOOK 369.729278 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x400820200000, curr_checkpoint is 0x400820200000
1, 10
Parall_iter 0, Write new metadata at address 0x400820180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 78, parall_iter is 0, num_threads is 4, last counter is 10, curr_counter is 11
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400820280000, curr_pr_arr is 0x400820280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40092e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009b5312a00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400820280000!
At savenvm_thread_nd id is 2, sz is 566281088, start addr 2025-05-23 16:45:44,935 - root - INFO - Step: 225 | Loss: 10.52 | Tokens per second: 8279.93 | Training tokens per second (%): 59.55 | MFU (%): 3.46 | TFLOPs: 34.18
2025-05-23 16:45:45,512 - root - INFO - Step: 230 | Loss: 10.30 | Tokens per second: 8897.44 | Training tokens per second (%): 25.08 | MFU (%): 3.71 | TFLOPs: 36.73
2025-05-23 16:45:46,086 - root - INFO - Step: 235 | Loss: 10.49 | Tokens per second: 8941.33 | Training tokens per second (%): 43.71 | MFU (%): 3.73 | TFLOPs: 36.91
2025-05-23 16:45:46,620 - root - INFO - Step: 240 | Loss: 10.48 | Tokens per second: 9619.34 | Training tokens per second (%): 71.23 | MFU (%): 4.01 | TFLOPs: 39.70
2025-05-23 16:45:46,662 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:46,663 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:47,247 - root - INFO - Step: 245 | Loss: 10.54 | Tokens per second: 8190.77 | Training tokens per second (%): 58.46 | MFU (%): 3.42 | TFLOPs: 33.81
2025-05-23 16:45:47,833 - root - INFO - Step: 250 | Loss: 10.65 | Tokens per second: 8746.17 | Training tokens per second (%): 53.71 | MFU (%): 3.65 | TFLOPs: 36.10
2025-05-23 16:45:48,409 - root - INFO - Step: 255 | Loss: 10.71 | Tokens per second: 8916.32 | Training tokens per second (%): 42.27 | MFU (%): 3.72 | TFLOPs: 36.80
2025-05-23 16:45:48,947 - root - INFO - Step: 260 | Loss: 10.90 | Tokens per second: 9556.30 | Training tokens per second (%): 60.08 | MFU (%): 3.99 | TFLOPs: 39.44
2025-05-23 16:45:48,989 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:48,990 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:49,565 - root - INFO - Step: 265 | Loss: 10.67 | Tokens per second: 8304.65 | Training tokens per second (%): 50.68 | MFU (%): 3.47 | TFLOPs: 34.28
2025-05-23 16:45:50,144 - root - INFO - Step: 270 | Loss: 10.47 | Tokens per second: 8858.64 | Training tokens per second (%): 68.73 | MFU (%): 3.70 | TFLOPs: 36.56
2025-05-23 16:45:50,718 - root - INFO - Step: 275 | Loss: 10.50 | Tokens per second: 8944.06 | Training tokens per second (%): 47.05 | MFU (%): 3.73 | TFLOPs: 36.92
2025-05-23 16:45:51,254 - root - INFO - Step: 280 | Loss: 10.48 | Tokens per second: 9584.27 | Training tokens per second (%): 65.78 | MFU (%): 4.00 | TFLOPs: 39.56
2025-05-23 16:45:51,299 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:51,300 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:51,873 - root - INFO - Step: 285 | Loss: 10.54 | Tokens per second: 8302.39 | Training tokens per second (%): 73.09 | MFU (%): 3.47 | TFLOPs: 34.27
2025-05-23 16:45:52,452 - root - INFO - Step: 290 | Loss: 10.68 | Tokens per second: 8857.01 | Training tokens per second (%): 54.63 | MFU (%): 3.70 | TFLOPs: 36.56
2025-05-23 16:45:53,020 - root - INFO - Step: 295 | Loss: 10.49 | Tokens per second: 9044.76 | Training tokens per second (%): 44.59 | MFU (%): 3.77 | TFLOPs: 37.33
2025-05-23 16:45:53,576 - root - INFO - Step: 300 | Loss: 10.42 | Tokens per second: 9237.45 | Training tokens per second (%): 83.14 | MFU (%): 3.86 | TFLOPs: 38.13
2025-05-23 16:45:53,618 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:53,619 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:54,191 - root - INFO - Step: 305 | Loss: 10.63 | Tokens per second: 8346.26 | Training tokens per second (%): 64.26 | MFU (%): 3.48 | TFLOPs: 34.45
2025-05-23 16:45:54,766 - root - INFO - Step: 310 | Loss: 10.49 | Tokens per second: 8921.53 | Training tokens per second (%): 58.93 | MFU (%): 3.72 | TFLOPs: 36.82
2025-05-23 16:45:55,347 - root - INFO - Step: 315 | Loss: 10.12 | Tokens per second: 8846.07 | Training tokens per second (%): 64.43 | MFU (%): 3.69 | TFLOPs: 36.51
2025-05-23 16:45:55,892 - root - INFO - Step: 320 | Loss: 10.39 | Tokens per second: 9427.05 | Training tokens per second (%): 73.79 | MFU (%): 3.93 | TFLOPs: 38.91
2025-05-23 16:45:55,935 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:55,936 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:56,511 - root - INFO - Step: 325 | Loss: 10.46 | Tokens per second: 8287.98 | Training tokens per second (%): 49.69 | MFU (%): 3.46 | TFLOPs: 34.21
2025-05-23 16:45:57,094 - root - INFO - Step: 330 | Loss: 9.93 | Tokens per second: 8803.29 | Training tokens per second (%): 60.96 | MFU (%): 3.67 | TFLOPs: 36.34
2025-05-23 16:45:57,662 - root - INFO - Step: 335 | Loss: 10.50 | Tokens per second: 9041.67 | Training tokens per second (%): 24.41 | MFU (%): 3.77 | TFLOPs: 37.32
is 0x4008a72b0e00!
Thread ID: 4, savenvm_thread_nd took 1700.685456 ms
Thread ID: 4, set_cpu took 0.047550 ms
Thread ID: 1, savenvm_thread_nd took 1703.147429 ms
Thread ID: 1, set_cpu took 0.090109 ms
Thread ID: 2, savenvm_thread_nd took 1712.214127 ms
Thread ID: 2, set_cpu took 0.067326 ms
Thread ID: 3, savenvm_thread_nd took 1712.760030 ms
Thread ID: 3, set_cpu took 0.055230 ms
Threads took 1712.972759 ms
MSYNC 9060496528 TOOK 345.100112 ms
CAS was successful! new counter is 11, is_distributed is 0
******** checkp_info saved in 0x400820180000, curr_checkpoint is 0x400820180000
0, 11
Parall_iter 1, Write new metadata at address 0x400820200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 102, parall_iter is 1, num_threads is 4, last counter is 11, curr_counter is 12
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
CPU: 6, CPU USE: 16
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ac3380e00!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b4a3b1c00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a3c350000!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bd13e2a00!
Thread ID: 5, savenvm_thread_nd took 1645.144533 ms
Thread ID: 5, set_cpu took 0.097885 ms
Thread ID: 8, savenvm_thread_nd took 1652.728557 ms
Thread ID: 8, set_cpu took 0.049663 ms
Thread ID: 7, savenvm_thread_nd took 1660.083884 ms
Thread ID: 7, set_cpu took 0.061086 ms
Thread ID: 6, savenvm_thread_nd took 1661.093293 ms
Thread ID: 6, set_cpu took 0.071774 ms
Threads took 1661.290311 ms
MSYNC 9060496528 TOOK 375.597130 ms
CAS was successful! new counter is 12, is_distributed is 0
******** checkp_info saved in 0x400820200000, curr_checkpoint is 0x400820200000
1, 12
Parall_iter 0, Write new metadata at address 0x400820180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 108, parall_iter is 0, num_threads is 4, last counter is 12, curr_counter is 13
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400820280000, curr_pr_arr is 0x400820280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008a72b0e00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400820280000!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40092e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009b5312a00!
Thread ID: 4, savenvm_thread_nd took 1692.973948 ms
Thread ID: 4, set_cpu took 0.047006 ms
Thread ID: 1, savenvm_thread_nd took 1697.374453 ms
Thread ID: 1, set_cpu took 0.077470 ms
Thread ID: 3, savenvm_thread_nd took 1707.374146 ms
Thread ID: 3, set_cpu took 0.053214 ms
Thread ID: 2, savenvm_thread_nd took 1710.051215 ms
Thread ID: 2, set_cpu took 0.063358 ms
Threads took 1710.229866 ms
MSYNC 9060496528 TOOK 365.440931 ms
CAS was successful! new counter is 13, is_distributed is 0
******** checkp_info saved in 0x400820180000, curr_checkpoint is 0x400820180000
0, 13
Parall_iter 1, Write new metadata at address 0x400820200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 114, parall_iter is 1, num_threads is 4, last counter is 13, curr_counter is 14
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
CPU: 6, CPU USE: 16
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b4a3b1c00!
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ac3380e00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a3c350000!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bd13e2a00!
Thread ID: 5, savenvm_thread_nd took 1720.191480 ms
Thread ID: 5, set_cpu took 0.091678 ms
Thread ID: 8, savenvm_thread_nd took 1725.713168 ms
Thread ID: 8, set_cpu took 0.044574 ms
Thread ID: 6, savenvm_thread_nd took 1733.348037 ms
Thread ID: 6, set_cpu took 0.071966 ms
Thread ID: 7, savenvm_thread_nd took 1737.939769 ms
Thread ID: 7, set_cpu took 0.055903 ms
Threads took 1738.116404 ms
MSYNC 9060496528 TOOK 331.191356 ms
CAS was successful! new counter is 14, is_distributed is 0
******** checkp_info saved in 0x400820200000, curr_checkpoint is 0x400820200000
1, 14
Parall_iter 0, Write new metadata at address 0x400820180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 11, parall_iter is 0, num_threads is 4, last counter is 14, curr_counter is 15
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400820280000, curr_pr_arr is 0x400820280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400820280000!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40092e2e1c00!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008a72b0e00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009b5312a00!
Thread ID: 4, savenvm_thread_nd took 1714.597188 ms
Thread ID: 4, set_cpu took 0.048095 ms
Thread ID: 1, savenvm_thread_nd took 1724.675887 ms
Thread ID: 1, set_cpu took 0.091037 ms
Thread ID: 2, savenvm_thread_nd took 1732.929778 ms
Thread ID: 2, set_cpu took 0.077886 ms
Thread ID: 3, savenvm_thread_nd took 1734.394342 ms
Thread ID: 3, set_cpu took 0.058110 ms
Threads took 1734.572577 ms
MSYNC 9060496528 TOOK 370.914683 ms
CAS was successful! new counter is 15, is_distributed is 0
******** checkp_info saved in 0x400820180000, curr_checkpoint is 0x400820180000
0, 15
Parall_iter 1, Write new metadata at address 0x400820200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 17, parall_iter is 1, num_threads is 4, last counter is 15, curr_counter is 16
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a3c350000!
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ac3380e00!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bd13e2a00!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b4a3b1c00!
Thread ID: 5, savenvm_thread_nd took 1723.241596 ms
Thread ID: 5, set_cpu took 0.084445 ms
Thread ID: 8, savenvm_thread_nd took 1732.741496 ms
Thread ID: 8, set_cpu took 0.041855 ms
Thread ID: 6, savenvm_thread_nd took 1736.412584 ms
Thread ID: 6, set_cpu took 0.060446 ms
Thread ID: 7, savenvm_thread_nd took 1737.853372 ms
Thread ID: 7, set_cpu took 0.054814 ms
Threads took 1738.024279 ms
MSYNC 9060496528 TOOK 314.561465 ms
CAS was successful! new counter is 16, is_distributed is 0
******** checkp_info saved in 0x400820200000, curr_checkpoint is 0x40082025-05-23 16:45:58,197 - root - INFO - Step: 340 | Loss: 10.52 | Tokens per second: 9597.76 | Training tokens per second (%): 59.49 | MFU (%): 4.01 | TFLOPs: 39.62
2025-05-23 16:45:58,239 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:45:58,240 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:45:58,806 - root - INFO - Step: 345 | Loss: 10.39 | Tokens per second: 8439.66 | Training tokens per second (%): 63.32 | MFU (%): 3.52 | TFLOPs: 34.84
2025-05-23 16:45:59,374 - root - INFO - Step: 350 | Loss: 10.69 | Tokens per second: 9026.23 | Training tokens per second (%): 62.03 | MFU (%): 3.77 | TFLOPs: 37.26
2025-05-23 16:45:59,945 - root - INFO - Step: 355 | Loss: 10.30 | Tokens per second: 8996.35 | Training tokens per second (%): 36.93 | MFU (%): 3.75 | TFLOPs: 37.13
2025-05-23 16:46:00,481 - root - INFO - Step: 360 | Loss: 10.00 | Tokens per second: 9588.48 | Training tokens per second (%): 72.48 | MFU (%): 4.00 | TFLOPs: 39.58
2025-05-23 16:46:00,522 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:46:00,523 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:46:01,091 - root - INFO - Step: 365 | Loss: 10.48 | Tokens per second: 8418.71 | Training tokens per second (%): 82.03 | MFU (%): 3.51 | TFLOPs: 34.75
2025-05-23 16:46:01,664 - root - INFO - Step: 370 | Loss: 10.32 | Tokens per second: 8954.17 | Training tokens per second (%): 70.29 | MFU (%): 3.74 | TFLOPs: 36.96
2025-05-23 16:46:02,260 - root - INFO - Step: 375 | Loss: 10.55 | Tokens per second: 8615.29 | Training tokens per second (%): 91.58 | MFU (%): 3.60 | TFLOPs: 35.56
2025-05-23 16:46:02,815 - root - INFO - Step: 380 | Loss: 10.14 | Tokens per second: 9250.94 | Training tokens per second (%): 66.46 | MFU (%): 3.86 | TFLOPs: 38.18
2025-05-23 16:46:02,857 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:46:02,858 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:46:03,428 - root - INFO - Step: 385 | Loss: 10.39 | Tokens per second: 8378.22 | Training tokens per second (%): 48.44 | MFU (%): 3.50 | TFLOPs: 34.58
2025-05-23 16:46:04,012 - root - INFO - Step: 390 | Loss: 10.21 | Tokens per second: 8779.93 | Training tokens per second (%): 63.48 | MFU (%): 3.66 | TFLOPs: 36.24
2025-05-23 16:46:04,592 - root - INFO - Step: 395 | Loss: 10.31 | Tokens per second: 8853.69 | Training tokens per second (%): 73.14 | MFU (%): 3.70 | TFLOPs: 36.54
2025-05-23 16:46:05,121 - root - INFO - Step: 400 | Loss: 10.18 | Tokens per second: 9715.82 | Training tokens per second (%): 53.57 | MFU (%): 4.05 | TFLOPs: 40.10
2025-05-23 16:46:05,164 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:46:05,165 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
total_size: 2265124132, bsize: 2265124132, ratio: 2.0
2265124132 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.311866760253906 ms
CPU copy took 2149.775743484497 ms
---------------------- [PERF] Single Checkpoint time is 2.229689121246338 sec, average is 2.229684591293335
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.28611755371094 ms
CPU copy took 2168.5352325439453 ms
---------------------- [PERF] Single Checkpoint time is 2.2482924461364746 sec, average is 2.2389872074127197
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.27109718322754 ms
CPU copy took 2125.507116317749 ms
---------------------- [PERF] Single Checkpoint time is 2.200214147567749 sec, average is 2.229684591293335
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.27896499633789 ms
CPU copy took 2093.034267425537 ms
---------------------- [PERF] Single Checkpoint time is 2.172787666320801 sec, average is 2.2149486541748047
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.2801570892334 ms
CPU copy took 2052.1798133850098 ms
---------------------- [PERF] Single Checkpoint time is 2.131934642791748 sec, average is 2.2002127170562744
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.262752532958984 ms
CPU copy took 2099.2531776428223 ms
---------------------- [PERF] Single Checkpoint time is 2.1789894104003906 sec, average is 2.1896004676818848
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.273481369018555 ms
CPU copy took 2090.3220176696777 ms
---------------------- [PERF] Single Checkpoint time is 2.1700692176818848 sec, average is 2.178988218307495
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.2653751373291 ms
CPU copy took 2091.3350582122803 ms
---------------------- [PERF] Single Checkpoint time is 2.17106556892395 sec, average is 2.1758872270584106
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.279680252075195 ms
CPU copy took 2075.0131607055664 ms
---------------------- [PERF] Single Checkpoint time is 2.1547634601593018 sec, average is 2.172786235809326
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.31591987609863 ms
CPU copy took 2081.4032554626465 ms
---------------------- [PERF] Single Checkpoint time is 2.1561295986175537 sec, average is 2.1719250679016113
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.304237365722656 ms
CPU copy took 2063.593626022339 ms
---------------------- [PERF] Single Checkpoint time is 2.1399219036102295 sec, average is 2.1710638999938965
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.26156044006348 ms
CPU copy took 2042.402982711792 ms
---------------------- [PERF] Single Checkpoint time is 2.117079257965088 sec, average is 2.1705657243728638
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.29875373840332 ms
CPU copy took 2081.21657371521 ms
---------------------- [PERF] Single Checkpoint time is 2.1610095500946045 sec, average is 2.170067548751831
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.2806339263916 ms
CPU copy took 2074.8376846313477 ms
---------------------- [PERF] Single Checkpoint time is 2.153310775756836 sec, average is 2.1655380725860596
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.29279327392578 ms
CPU copy took 2111.0053062438965 ms
---------------------- [PERF] Single Checkpoint time is 2.1907906532287598 sec, average is 2.170067548751831
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.235334396362305 ms
CPU copy took 2058.162212371826 ms
---------------------- [PERF] Single Checkpoint time is 2.136873245239258 sec, average is 2.1655380725860596
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.27443504333496 ms
CPU copy took 2144.5515155792236 ms
---------------------- [PERF] Single Checkpoint time is 2.221754550933838 sec, average is 2.170067548751831
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.293508529663086 ms
CPU copy took 2123.420238494873 ms
---------------------- [PERF] Single Checkpoint time is 2.203195571899414 sec, average is 2.1705657243728638
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.28182601928711 ms
CPU copy took 2086.076498031616 ms
---------------------- [PERF] Single Checkpoint time is 2.16582989692688 sec, average is 2.170067548751831
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 53.6041259765625 ms
CPU copy took 2084.205150604248 ms
---------------------- [PERF] Single Checkpoint time is 2.1381072998046875 sec, average is 2.1679478883743286
---- exit
20200000
1, 16
Parall_iter 0, Write new metadata at address 0x400820180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 40, parall_iter is 0, num_threads is 4, last counter is 16, curr_counter is 17
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400820280000, curr_pr_arr is 0x400820280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400820280000!
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40092e2e1c00!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009b5312a00!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008a72b0e00!
Thread ID: 4, savenvm_thread_nd took 1774.958507 ms
Thread ID: 4, set_cpu took 0.049918 ms
Thread ID: 1, savenvm_thread_nd took 1777.929711 ms
Thread ID: 1, set_cpu took 0.090270 ms
Thread ID: 2, savenvm_thread_nd took 1788.352272 ms
Thread ID: 2, set_cpu took 0.067518 ms
Thread ID: 3, savenvm_thread_nd took 1789.482958 ms
Thread ID: 3, set_cpu took 0.054206 ms
Threads took 1789.670952 ms
MSYNC 9060496528 TOOK 349.345167 ms
CAS was successful! new counter is 17, is_distributed is 0
******** checkp_info saved in 0x400820180000, curr_checkpoint is 0x400820180000
0, 17
Parall_iter 1, Write new metadata at address 0x400820200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 48, parall_iter is 1, num_threads is 4, last counter is 17, curr_counter is 18
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ac3380e00!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b4a3b1c00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a3c350000!
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bd13e2a00!
Thread ID: 5, savenvm_thread_nd took 1693.853888 ms
Thread ID: 5, set_cpu took 0.086205 ms
Thread ID: 8, savenvm_thread_nd took 1701.447735 ms
Thread ID: 8, set_cpu took 0.045503 ms
Thread ID: 7, savenvm_thread_nd took 1709.965202 ms
Thread ID: 7, set_cpu took 0.050366 ms
Thread ID: 6, savenvm_thread_nd took 1711.998996 ms
Thread ID: 6, set_cpu took 0.062942 ms
Threads took 1712.167727 ms
MSYNC 9060496528 TOOK 405.754830 ms
CAS was successful! new counter is 18, is_distributed is 0
******** checkp_info saved in 0x400820200000, curr_checkpoint is 0x400820200000
1, 18
Parall_iter 0, Write new metadata at address 0x400820180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 54, parall_iter is 0, num_threads is 4, last counter is 18, curr_counter is 19
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400820280000, curr_pr_arr is 0x400820280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 2, CPU USE: 12
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 566281088, start addr is 0x40092e2e1c00!
At savenvm_thread_nd id is 2, sz is 566281088, start addr is 0x4008a72b0e00!
At savenvm_thread_nd id is 1, sz is 566281088, start addr is 0x400820280000!
At savenvm_thread_nd id is 4, sz is 566280868, start addr is 0x4009b5312a00!
Thread ID: 4, savenvm_thread_nd took 1675.712620 ms
Thread ID: 4, set_cpu took 0.052734 ms
Thread ID: 1, savenvm_thread_nd took 1682.552570 ms
Thread ID: 1, set_cpu took 0.093341 ms
Thread ID: 3, savenvm_thread_nd took 1689.019892 ms
Thread ID: 3, set_cpu took 0.056574 ms
Thread ID: 2, savenvm_thread_nd took 1690.471559 ms
Thread ID: 2, set_cpu took 0.072702 ms
Threads took 1690.655042 ms
MSYNC 9060496528 TOOK 389.891572 ms
CAS was successful! new counter is 19, is_distributed is 0
******** checkp_info saved in 0x400820180000, curr_checkpoint is 0x400820180000
0, 19
Parall_iter 1, Write new metadata at address 0x400820200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 60, parall_iter is 1, num_threads is 4, last counter is 19, curr_counter is 20
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566281088
size_for_thread_i is 566280868
CPU: 6, CPU USE: 16
CPU: 8, CPU USE: 18
CPU: 7, CPU USE: 17
CPU: 5, CPU USE: 15
At savenvm_thread_nd id is 8, sz is 566280868, start addr is 0x400bd13e2a00!
At savenvm_thread_nd id is 6, sz is 566281088, start addr is 0x400ac3380e00!
At savenvm_thread_nd id is 7, sz is 566281088, start addr is 0x400b4a3b1c00!
At savenvm_thread_nd id is 5, sz is 566281088, start addr is 0x400a3c350000!
Thread ID: 5, savenvm_thread_nd took 1638.148139 ms
Thread ID: 5, set_cpu took 0.104252 ms
Thread ID: 8, savenvm_thread_nd took 1659.664183 ms
Thread ID: 8, set_cpu took 0.046303 ms
Thread ID: 7, savenvm_thread_nd took 1671.796132 ms
Thread ID: 7, set_cpu took 0.063902 ms
Thread ID: 6, savenvm_thread_nd took 1672.557484 ms
Thread ID: 6, set_cpu took 0.078814 ms
Threads took 1672.732647 ms
MSYNC 9060496528 TOOK 411.067724 ms
CAS was successful! new counter is 20, is_distributed is 0
******** checkp_info saved in 0x400820200000, curr_checkpoint is 0x400820200000
1, 20
2025-05-23 16:46:08,465 - root - INFO - Training completed
2025-05-23 16:46:08,465 - root - INFO - Training run end: total time taken 49.93 seconds
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
==== PCCHECK END ====
==== RUNNING BASELINE FOR 2048 WITH bf16 ====
2025-05-23 16:46:12,925 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_2048/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-23 16:46:12,928 - root - INFO - Setting up DataLoaders...
2025-05-23 16:46:19,078 - root - INFO - Setting up Model...
2025-05-23 16:46:34,473 - root - INFO - Starting training!
2025-05-23 16:46:34,931 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 4467.00 | Training tokens per second (%): 38.77 | MFU (%): 6.18 | TFLOPs: 61.16
2025-05-23 16:46:35,466 - root - INFO - Step: 5 | Loss: 11.91 | Tokens per second: 15397.54 | Training tokens per second (%): 22.83 | MFU (%): 21.32 | TFLOPs: 210.81
2025-05-23 16:46:36,107 - root - INFO - Step: 10 | Loss: 11.87 | Tokens per second: 16071.10 | Training tokens per second (%): 51.44 | MFU (%): 22.25 | TFLOPs: 220.03
2025-05-23 16:46:36,754 - root - INFO - Step: 15 | Loss: 11.76 | Tokens per second: 15884.29 | Training tokens per second (%): 48.58 | MFU (%): 21.99 | TFLOPs: 217.47
2025-05-23 16:46:37,405 - root - INFO - Step: 20 | Loss: 11.66 | Tokens per second: 15811.23 | Training tokens per second (%): 49.55 | MFU (%): 21.89 | TFLOPs: 216.47
2025-05-23 16:46:45,180 - root - INFO - Checkpoint saved in 7.7753 seconds
2025-05-23 16:46:45,182 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:46:45,831 - root - INFO - Step: 25 | Loss: 11.50 | Tokens per second: 1215.75 | Training tokens per second (%): 36.56 | MFU (%): 1.68 | TFLOPs: 16.64
2025-05-23 16:46:46,473 - root - INFO - Step: 30 | Loss: 11.16 | Tokens per second: 16011.55 | Training tokens per second (%): 50.15 | MFU (%): 22.17 | TFLOPs: 219.21
2025-05-23 16:46:47,106 - root - INFO - Step: 35 | Loss: 11.14 | Tokens per second: 16266.18 | Training tokens per second (%): 27.57 | MFU (%): 22.52 | TFLOPs: 222.70
2025-05-23 16:46:47,736 - root - INFO - Step: 40 | Loss: 11.26 | Tokens per second: 16326.86 | Training tokens per second (%): 19.90 | MFU (%): 22.60 | TFLOPs: 223.53
2025-05-23 16:46:55,285 - root - INFO - Checkpoint saved in 7.5490 seconds
2025-05-23 16:46:55,286 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:46:55,935 - root - INFO - Step: 45 | Loss: 10.67 | Tokens per second: 1249.36 | Training tokens per second (%): 31.17 | MFU (%): 1.73 | TFLOPs: 17.11
2025-05-23 16:46:56,570 - root - INFO - Step: 50 | Loss: 10.78 | Tokens per second: 16207.04 | Training tokens per second (%): 21.87 | MFU (%): 22.44 | TFLOPs: 221.89
2025-05-23 16:46:57,215 - root - INFO - Step: 55 | Loss: 11.02 | Tokens per second: 15930.11 | Training tokens per second (%): 54.01 | MFU (%): 22.05 | TFLOPs: 218.10
2025-05-23 16:46:57,855 - root - INFO - Step: 60 | Loss: 10.69 | Tokens per second: 16082.20 | Training tokens per second (%): 49.63 | MFU (%): 22.26 | TFLOPs: 220.18
2025-05-23 16:47:05,400 - root - INFO - Checkpoint saved in 7.5451 seconds
2025-05-23 16:47:05,401 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:47:06,058 - root - INFO - Step: 65 | Loss: 10.81 | Tokens per second: 1248.72 | Training tokens per second (%): 48.10 | MFU (%): 1.73 | TFLOPs: 17.10
2025-05-23 16:47:06,706 - root - INFO - Step: 70 | Loss: 10.65 | Tokens per second: 15879.98 | Training tokens per second (%): 32.49 | MFU (%): 21.98 | TFLOPs: 217.41
2025-05-23 16:47:07,349 - root - INFO - Step: 75 | Loss: 10.27 | Tokens per second: 15998.89 | Training tokens per second (%): 33.31 | MFU (%): 22.15 | TFLOPs: 219.04
2025-05-23 16:47:07,989 - root - INFO - Step: 80 | Loss: 10.31 | Tokens per second: 16083.90 | Training tokens per second (%): 34.72 | MFU (%): 22.27 | TFLOPs: 220.20
2025-05-23 16:47:15,546 - root - INFO - Checkpoint saved in 7.5568 seconds
2025-05-23 16:47:15,547 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:47:16,208 - root - INFO - Step: 85 | Loss: 10.49 | Tokens per second: 1246.28 | Training tokens per second (%): 32.09 | MFU (%): 1.73 | TFLOPs: 17.06
2025-05-23 16:47:16,875 - root - INFO - Step: 90 | Loss: 10.11 | Tokens per second: 15417.54 | Training tokens per second (%): 76.84 | MFU (%): 21.34 | TFLOPs: 211.08
2025-05-23 16:47:17,550 - root - INFO - Step: 95 | Loss: 10.08 | Tokens per second: 15241.10 | Training tokens per second (%): 76.98 | MFU (%): 21.10 | TFLOPs: 208.67
2025-05-23 16:47:18,243 - root - INFO - Step: 100 | Loss: 10.11 | Tokens per second: 14836.42 | Training tokens per second (%): 100.00 | MFU (%): 20.54 | TFLOPs: 203.13
2025-05-23 16:47:25,738 - root - INFO - Checkpoint saved in 7.4948 seconds
2025-05-23 16:47:25,740 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:47:26,408 - root - INFO - Step: 105 | Loss: 10.19 | Tokens per second: 1254.59 | Training tokens per second (%): 33.06 | MFU (%): 1.74 | TFLOPs: 17.18
2025-05-23 16:47:27,060 - root - INFO - Step: 110 | Loss: 10.33 | Tokens per second: 15774.38 | Training tokens per second (%): 31.52 | MFU (%): 21.84 | TFLOPs: 215.97
2025-05-23 16:47:27,708 - root - INFO - Step: 115 | Loss: 10.13 | Tokens per second: 15867.14 | Training tokens per second (%): 19.95 | MFU (%): 21.97 | TFLOPs: 217.24
2025-05-23 16:47:28,359 - root - INFO - Step: 120 | Loss: 9.95 | Tokens per second: 15820.65 | Training tokens per second (%): 47.53 | MFU (%): 21.90 | TFLOPs: 216.60
2025-05-23 16:47:35,866 - root - INFO - Checkpoint saved in 7.5074 seconds
2025-05-23 16:47:35,868 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:47:36,532 - root - INFO - Step: 125 | Loss: 10.41 | Tokens per second: 1253.24 | Training tokens per second (%): 39.27 | MFU (%): 1.73 | TFLOPs: 17.16
2025-05-23 16:47:37,186 - root - INFO - Step: 130 | Loss: 10.35 | Tokens per second: 15737.28 | Training tokens per second (%): 31.13 | MFU (%): 21.79 | TFLOPs: 215.46
2025-05-23 16:47:37,839 - root - INFO - Step: 135 | Loss: 9.74 | Tokens per second: 15761.04 | Training tokens per second (%): 43.91 | MFU (%): 21.82 | TFLOPs: 215.78
2025-05-23 16:47:38,481 - root - INFO - Step: 140 | Loss: 10.01 | Tokens per second: 16007.24 | Training tokens per second (%): 23.79 | MFU (%): 22.16 | TFLOPs: 219.16
2025-05-23 16:47:45,988 - root - INFO - Checkpoint saved in 7.5062 seconds
2025-05-23 16:47:45,990 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:47:46,657 - root - INFO - Step: 145 | Loss: 9.70 | Tokens per second: 1252.93 | Training tokens per second (%): 40.89 | MFU (%): 1.73 | TFLOPs: 17.15
2025-05-23 16:47:47,302 - root - INFO - Step: 150 | Loss: 10.06 | Tokens per second: 15949.64 | Training tokens per second (%): 39.48 | MFU (%): 22.08 | TFLOPs: 218.37
2025-05-23 16:47:47,961 - root - INFO - Step: 155 | Loss: 10.01 | Tokens per second: 15612.97 | Training tokens per second (%): 59.66 | MFU (%): 21.61 | TFLOPs: 213.76
2025-05-23 16:47:48,613 - root - INFO - Step: 160 | Loss: 9.44 | Tokens per second: 15766.98 | Training tokens per second (%): 42.43 | MFU (%): 21.83 | TFLOPs: 215.87
2025-05-23 16:47:56,129 - root - INFO - Checkpoint saved in 7.5156 seconds
2025-05-23 16:47:56,131 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:47:56,806 - root - INFO - Step: 165 | Loss: 9.67 | Tokens per second: 1250.26 | Training tokens per second (%): 32.87 | MFU (%): 1.73 | TFLOPs: 17.12
2025-05-23 16:47:57,467 - root - INFO - Step: 170 | Loss: 10.05 | Tokens per second: 15568.71 | Training tokens per second (%): 58.68 | MFU (%): 21.55 | TFLOPs: 213.15
2025-05-23 16:47:58,118 - root - INFO - Step: 175 | Loss: 10.07 | Tokens per second: 15801.96 | Training tokens per second (%): 39.18 | MFU (%): 21.88 | TFLOPs: 216.34
2025-05-23 16:47:58,769 - root - INFO - Step: 180 | Loss: 9.73 | Tokens per second: 15806.78 | Training tokens per second (%): 29.37 | MFU (%): 21.88 | TFLOPs: 216.41
2025-05-23 16:48:06,275 - root - INFO - Checkpoint saved in 7.5056 seconds
2025-05-23 16:48:06,276 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:48:06,934 - root - INFO - Step: 185 | Loss: 10.12 | Tokens per second: 1254.55 | Training tokens per second (%): 27.41 | MFU (%): 1.74 | TFLOPs: 17.18
2025-05-23 16:48:07,588 - root - INFO - Step: 190 | Loss: 9.74 | Tokens per second: 15719.21 | Training tokens per second (%): 41.21 | MFU (%): 21.76 | TFLOPs: 215.21
2025-05-23 16:48:08,266 - root - INFO - Step: 195 | Loss: 9.37 | Tokens per second: 15187.29 | Training tokens per second (%): 45.33 | MFU (%): 21.02 | TFLOPs: 207.93
2025-05-23 16:48:08,919 - root - INFO - Step: 200 | Loss: 10.00 | Tokens per second: 15748.23 | Training tokens per second (%): 33.85 | MFU (%): 21.80 | TFLOPs: 215.61
2025-05-23 16:48:16,458 - root - INFO - Checkpoint saved in 7.5395 seconds
2025-05-23 16:48:16,460 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:48:17,118 - root - INFO - Step: 205 | Loss: 9.28 | Tokens per second: 1249.29 | Training tokens per second (%): 19.40 | MFU (%): 1.73 | TFLOPs: 17.10
2025-05-23 16:48:17,774 - root - INFO - Step: 210 | Loss: 9.65 | Tokens per second: 15681.56 | Training tokens per second (%): 38.69 | MFU (%): 21.71 | TFLOPs: 214.70
2025-05-23 16:48:18,423 - root - INFO - Step: 215 | Loss: 9.42 | Tokens per second: 15851.33 | Training tokens per second (%): 24.02 | MFU (%): 21.94 | TFLOPs: 217.02
2025-05-23 16:48:19,067 - root - INFO - Step: 220 | Loss: 9.78 | Tokens per second: 15971.73 | Training tokens per second (%): 24.01 | MFU (%): 22.11 | TFLOPs: 218.67
2025-05-23 16:48:26,575 - root - INFO - Checkpoint saved in 7.5079 seconds
2025-05-23 16:48:26,577 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:48:27,247 - root - INFO - Step: 225 | Loss: 9.41 | Tokens per second: 1252.27 | Training tokens per second (%): 40.32 | MFU (%): 1.73 | TFLOPs: 17.14
2025-05-23 16:48:27,896 - root - INFO - Step: 230 | Loss: 9.29 | Tokens per second: 15848.53 | Training tokens per second (%): 12.54 | MFU (%): 21.94 | TFLOPs: 216.98
2025-05-23 16:48:28,545 - root - INFO - Step: 235 | Loss: 9.50 | Tokens per second: 15866.47 | Training tokens per second (%): 27.69 | MFU (%): 21.96 | TFLOPs: 217.23
2025-05-23 16:48:29,198 - root - INFO - Step: 240 | Loss: 9.50 | Tokens per second: 15756.71 | Training tokens per second (%): 45.88 | MFU (%): 21.81 | TFLOPs: 215.73
2025-05-23 16:48:36,709 - root - INFO - Checkpoint saved in 7.5115 seconds
2025-05-23 16:48:36,711 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:48:37,388 - root - INFO - Step: 245 | Loss: 9.45 | Tokens per second: 1250.76 | Training tokens per second (%): 43.83 | MFU (%): 1.73 | TFLOPs: 17.12
2025-05-23 16:48:38,057 - root - INFO - Step: 250 | Loss: 9.72 | Tokens per second: 15359.14 | Training tokens per second (%): 46.86 | MFU (%): 21.26 | TFLOPs: 210.28
2025-05-23 16:48:38,701 - root - INFO - Step: 255 | Loss: 9.97 | Tokens per second: 15983.69 | Training tokens per second (%): 22.31 | MFU (%): 22.13 | TFLOPs: 218.83
2025-05-23 16:48:39,357 - root - INFO - Step: 260 | Loss: 10.18 | Tokens per second: 15667.28 | Training tokens per second (%): 40.04 | MFU (%): 21.69 | TFLOPs: 214.50
2025-05-23 16:48:46,874 - root - INFO - Checkpoint saved in 7.5161 seconds
2025-05-23 16:48:46,875 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:48:47,534 - root - INFO - Step: 265 | Loss: 9.69 | Tokens per second: 1252.77 | Training tokens per second (%): 25.34 | MFU (%): 1.73 | TFLOPs: 17.15
2025-05-23 16:48:48,189 - root - INFO - Step: 270 | Loss: 9.46 | Tokens per second: 15705.83 | Training tokens per second (%): 34.54 | MFU (%): 21.74 | TFLOPs: 215.03
2025-05-23 16:48:48,840 - root - INFO - Step: 275 | Loss: 9.52 | Tokens per second: 15805.64 | Training tokens per second (%): 26.43 | MFU (%): 21.88 | TFLOPs: 216.40
2025-05-23 16:48:49,494 - root - INFO - Step: 280 | Loss: 9.50 | Tokens per second: 15716.89 | Training tokens per second (%): 45.45 | MFU (%): 21.76 | TFLOPs: 215.18
2025-05-23 16:48:57,001 - root - INFO - Checkpoint saved in 7.5062 seconds
2025-05-23 16:48:57,003 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:48:57,668 - root - INFO - Step: 285 | Loss: 9.68 | Tokens per second: 1253.32 | Training tokens per second (%): 43.17 | MFU (%): 1.73 | TFLOPs: 17.16
2025-05-23 16:48:58,318 - root - INFO - Step: 290 | Loss: 9.49 | Tokens per second: 15811.46 | Training tokens per second (%): 27.31 | MFU (%): 21.89 | TFLOPs: 216.47
2025-05-23 16:48:58,959 - root - INFO - Step: 295 | Loss: 9.45 | Tokens per second: 16045.30 | Training tokens per second (%): 22.29 | MFU (%): 22.21 | TFLOPs: 219.68
2025-05-23 16:48:59,634 - root - INFO - Step: 300 | Loss: 9.29 | Tokens per second: 15240.24 | Training tokens per second (%): 81.27 | MFU (%): 21.10 | TFLOPs: 208.65
2025-05-23 16:49:07,135 - root - INFO - Checkpoint saved in 7.5010 seconds
2025-05-23 16:49:07,137 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:49:07,804 - root - INFO - Step: 305 | Loss: 9.80 | Tokens per second: 1253.77 | Training tokens per second (%): 42.13 | MFU (%): 1.74 | TFLOPs: 17.17
2025-05-23 16:49:08,454 - root - INFO - Step: 310 | Loss: 9.59 | Tokens per second: 15842.84 | Training tokens per second (%): 31.69 | MFU (%): 21.93 | TFLOPs: 216.90
2025-05-23 16:49:09,111 - root - INFO - Step: 315 | Loss: 9.03 | Tokens per second: 15640.50 | Training tokens per second (%): 42.22 | MFU (%): 21.65 | TFLOPs: 214.13
2025-05-23 16:49:09,764 - root - INFO - Step: 320 | Loss: 9.44 | Tokens per second: 15768.03 | Training tokens per second (%): 49.90 | MFU (%): 21.83 | TFLOPs: 215.88
2025-05-23 16:49:17,281 - root - INFO - Checkpoint saved in 7.5175 seconds
2025-05-23 16:49:17,283 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:49:17,954 - root - INFO - Step: 325 | Loss: 9.45 | Tokens per second: 1250.76 | Training tokens per second (%): 34.84 | MFU (%): 1.73 | TFLOPs: 17.12
2025-05-23 16:49:18,613 - root - INFO - Step: 330 | Loss: 8.75 | Tokens per second: 15607.59 | Training tokens per second (%): 45.21 | MFU (%): 21.61 | TFLOPs: 213.68
2025-05-23 16:49:19,257 - root - INFO - Step: 335 | Loss: 9.48 | Tokens per second: 15965.85 | Training tokens per second (%): 12.21 | MFU (%): 22.10 | TFLOPs: 218.59
2025-05-23 16:49:19,904 - root - INFO - Step: 340 | Loss: 9.63 | Tokens per second: 15908.31 | Training tokens per second (%): 33.55 | MFU (%): 22.02 | TFLOPs: 217.80
2025-05-23 16:49:27,402 - root - INFO - Checkpoint saved in 7.4985 seconds
2025-05-23 16:49:27,404 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:49:28,063 - root - INFO - Step: 345 | Loss: 9.40 | Tokens per second: 1255.46 | Training tokens per second (%): 38.32 | MFU (%): 1.74 | TFLOPs: 17.19
2025-05-23 16:49:28,713 - root - INFO - Step: 350 | Loss: 9.62 | Tokens per second: 15815.34 | Training tokens per second (%): 38.50 | MFU (%): 21.89 | TFLOPs: 216.53
2025-05-23 16:49:29,363 - root - INFO - Step: 355 | Loss: 9.30 | Tokens per second: 15826.41 | Training tokens per second (%): 18.47 | MFU (%): 21.91 | TFLOPs: 216.68
2025-05-23 16:49:30,013 - root - INFO - Step: 360 | Loss: 8.92 | Tokens per second: 15821.33 | Training tokens per second (%): 50.04 | MFU (%): 21.90 | TFLOPs: 216.61
2025-05-23 16:49:37,518 - root - INFO - Checkpoint saved in 7.5048 seconds
2025-05-23 16:49:37,520 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:49:38,186 - root - INFO - Step: 365 | Loss: 9.39 | Tokens per second: 1253.38 | Training tokens per second (%): 41.02 | MFU (%): 1.74 | TFLOPs: 17.16
2025-05-23 16:49:38,836 - root - INFO - Step: 370 | Loss: 9.04 | Tokens per second: 15825.14 | Training tokens per second (%): 35.15 | MFU (%): 21.91 | TFLOPs: 216.66
2025-05-23 16:49:39,504 - root - INFO - Step: 375 | Loss: 9.43 | Tokens per second: 15408.30 | Training tokens per second (%): 78.84 | MFU (%): 21.33 | TFLOPs: 210.96
2025-05-23 16:49:40,175 - root - INFO - Step: 380 | Loss: 8.94 | Tokens per second: 15323.67 | Training tokens per second (%): 49.27 | MFU (%): 21.21 | TFLOPs: 209.80
2025-05-23 16:49:47,677 - root - INFO - Checkpoint saved in 7.5020 seconds
2025-05-23 16:49:47,679 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:49:48,338 - root - INFO - Step: 385 | Loss: 9.24 | Tokens per second: 1254.89 | Training tokens per second (%): 34.22 | MFU (%): 1.74 | TFLOPs: 17.18
2025-05-23 16:49:48,987 - root - INFO - Step: 390 | Loss: 9.04 | Tokens per second: 15841.96 | Training tokens per second (%): 41.74 | MFU (%): 21.93 | TFLOPs: 216.89
2025-05-23 16:49:49,638 - root - INFO - Step: 395 | Loss: 9.33 | Tokens per second: 15808.25 | Training tokens per second (%): 45.66 | MFU (%): 21.88 | TFLOPs: 216.43
2025-05-23 16:49:50,288 - root - INFO - Step: 400 | Loss: 8.91 | Tokens per second: 15822.24 | Training tokens per second (%): 36.79 | MFU (%): 21.90 | TFLOPs: 216.62
2025-05-23 16:49:57,789 - root - INFO - Checkpoint saved in 7.5004 seconds
2025-05-23 16:49:57,790 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:49:57,790 - root - INFO - Training completed
2025-05-23 16:49:57,790 - root - INFO - Training run end: total time taken 203.32 seconds
==== BASELINE END ====
==== RUNNING PCCHECK FOR 2048 WITH bf16 ====
2025-05-23 16:50:02,096 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_2048/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-23 16:50:02,100 - root - INFO - Setting up DataLoaders...
2025-05-23 16:50:03,040 - root - INFO - Setting up Model...
Model size: 2281834496, Optimizer size: 4563669284, Total size: 6845503780
BSIZE IS 6845503780
At checkpoint, bsize is 6845503780
2025-05-23 16:50:53,701 - root - INFO - Checkpointing warmup done
2025-05-23 16:50:53,704 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 16:50:54,060 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 5786.19 | Training tokens per second (%): 38.77 | MFU (%): 8.01 | TFLOPs: 79.22
2025-05-23 16:50:54,560 - root - INFO - Step: 5 | Loss: 11.91 | Tokens per second: 16510.43 | Training tokens per second (%): 22.83 | MFU (%): 22.86 | TFLOPs: 226.04
2025-05-23 16:50:55,181 - root - INFO - Step: 10 | Loss: 11.87 | Tokens per second: 16571.30 | Training tokens per second (%): 51.44 | MFU (%): 22.94 | TFLOPs: 226.88
2025-05-23 16:50:55,807 - root - INFO - Step: 15 | Loss: 11.77 | Tokens per second: 16420.61 | Training tokens per second (%): 48.58 | MFU (%): 22.73 | TFLOPs: 224.81
2025-05-23 16:50:56,436 - root - INFO - Step: 20 | Loss: 11.66 | Tokens per second: 16354.71 | Training tokens per second (%): 49.55 | MFU (%): 22.64 | TFLOPs: 223.91
2025-05-23 16:50:56,492 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:50:56,493 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:50:57,288 - root - INFO - Step: 25 | Loss: 11.50 | Tokens per second: 12062.40 | Training tokens per second (%): 36.56 | MFU (%): 16.70 | TFLOPs: 165.15
2025-05-23 16:50:57,955 - root - INFO - Step: 30 | Loss: 11.15 | Tokens per second: 15408.76 | Training tokens per second (%): 50.15 | MFU (%): 21.33 | TFLOPs: 210.96
2025-05-23 16:50:58,734 - root - INFO - Step: 35 | Loss: 11.13 | Tokens per second: 13201.68 | Training tokens per second (%): 27.57 | MFU (%): 18.28 | TFLOPs: 180.74
2025-05-23 16:50:59,390 - root - INFO - Step: 40 | Loss: 11.25 | Tokens per second: 15674.81 | Training tokens per second (%): 19.90 | MFU (%): 21.70 | TFLOPs: 214.60
2025-05-23 16:50:59,456 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:50:59,457 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:51:03,902 - root - INFO - Step: 45 | Loss: 10.66 | Tokens per second: 2271.11 | Training tokens per second (%): 31.17 | MFU (%): 3.14 | TFLOPs: 31.09
2025-05-23 16:51:04,546 - root - INFO - Step: 50 | Loss: 10.77 | Tokens per second: 15974.55 | Training tokens per second (%): 21.87 | MFU (%): 22.11 | TFLOPs: 218.71
2025-05-23 16:51:05,212 - root - INFO - Step: 55 | Loss: 11.01 | Tokens per second: 15444.50 | Training tokens per second (%): 54.01 | MFU (%): 21.38 | TFLOPs: 211.45
2025-05-23 16:51:05,893 - root - INFO - Step: 60 | Loss: 10.68 | Tokens per second: 15102.62 | Training tokens per second (%): 49.63 | MFU (%): 20.91 | TFLOPs: 206.77
2025-05-23 16:51:05,958 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:51:05,959 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:51:10,474 - root - INFO - Step: 65 | Loss: 10.80 | Tokens per second: 2236.75 | Training tokens per second (%): 48.10 | MFU (%): 3.10 | TFLOPs: 30.62
2025-05-23 16:51:11,130 - root - INFO - Step: 70 | Loss: 10.64 | Tokens per second: 15697.15 | Training tokens per second (%): 32.49 | MFU (%): 21.73 | TFLOPs: 214.91
2025-05-23 16:51:11,776 - root - INFO - Step: 75 | Loss: 10.26 | Tokens per second: 15932.18 | Training tokens per second (%): 33.31 | MFU (%): 22.06 | TFLOPs: 218.13
2025-05-23 16:51:12,428 - root - INFO - Step: 80 | Loss: 10.30 | Tokens per second: 15756.77 | Training tokens per second (%): 34.72 | MFU (%): 21.81 | TFLOPs: 215.73
2025-05-23 16:51:12,492 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:51:12,494 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:51:17,059 - root - INFO - Step: 85 | Loss: 10.48 | Tokens per second: 2212.90 | Training tokens per second (%): 32.09 | MFU (%): 3.06 | TFLOPs: 30.30
2025-05-23 16:51:17,743 - root - INFO - Step: 90 | Loss: 10.10 | Tokens per second: 15032.69 | Training tokens per second (%): 76.84 | MFU (%): 20.81 | TFLOPs: 205.81
2025-05-23 16:51:18,444 - root - INFO - Step: 95 | Loss: 10.07 | Tokens per second: 14682.46 | Training tokens per second (%): 76.98 | MFU (%): 20.33 | TFLOPs: 201.02
2025-05-23 16:51:19,168 - root - INFO - Step: 100 | Loss: 10.10 | Tokens per second: 14200.96 | Training tokens per second (%): 100.00 | MFU (%): 19.66 | TFLOPs: 194.43
2025-05-23 16:51:19,235 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:51:19,236 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:51:23,505 - root - INFO - Step: 105 | Loss: 10.18 | Tokens per second: 2362.73 | Training tokens per second (%): 33.06 | MFU (%): 3.27 | TFLOPs: 32.35
2025-05-23 16:51:24,178 - root - INFO - Step: 110 | Loss: 10.33 | Tokens per second: 15275.77 | Training tokens per second (%): 31.52 | MFU (%): 21.15 | TFLOPs: 209.14
2025-05-23 16:51:24,834 - root - INFO - Step: 115 | Loss: 10.12 | Tokens per second: 15683.08 | Training tokens per second (%): 19.95 | MFU (%): 21.71 | TFLOPs: 214.72
2025-05-23 16:51:25,497 - root - INFO - Step: 120 | Loss: 9.94 | Tokens per second: 15518.76 | Training tokens per second (%): 47.53 | MFU (%): 21.48 | TFLOPs: 212.47
2025-05-23 16:51:25,564 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:51:25,566 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x400e40280000, PR_ADDR is 0x400e40000000, PEER_CHECK_ADDR is 0x400e40080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 6845503780
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400e40180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 97, parall_iter is 0, num_threads is 4, last counter is 0, curr_counter is 1
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e40280000, curr_pr_arr is 0x400e40280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400e40280000!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x400fd82e1a00!
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x401170343400!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4013083a4e00!
Thread ID: 1, savenvm_thread_nd took 5610.719346 ms
Thread ID: 1, set_cpu took 0.104956 ms
Thread ID: 2, savenvm_thread_nd took 5653.997496 ms
Thread ID: 2, set_cpu took 0.063518 ms
Thread ID: 3, savenvm_thread_nd took 6018.100576 ms
Thread ID: 3, set_cpu took 0.057822 ms
Thread ID: 4, savenvm_thread_nd took 6094.549879 ms
Thread ID: 4, set_cpu took 0.057598 ms
Threads took 6094.863502 ms
MSYNC 27382015120 TOOK 259.806788 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400e40180000, curr_checkpoint is 0x400e40180000
0, 1
Parall_iter 1, Write new metadata at address 0x400e40200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 122, parall_iter is 1, num_threads is 4, last counter is 1, curr_counter is 2
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4014a0410000, curr_pr_arr is 0x4014a0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401638471a00!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4014a0410000!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4017d04d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401968534e00!
Thread ID: 5, savenvm_thread_nd took 5740.195793 ms
Thread ID: 5, set_cpu took 0.089310 ms
Thread ID: 6, savenvm_thread_nd took 5782.638608 ms
Thread ID: 6, set_cpu took 0.057567 ms
Thread ID: 7, savenvm_thread_nd took 6013.047638 ms
Thread ID: 7, set_cpu took 0.050142 ms
Thread ID: 8, savenvm_thread_nd took 6105.488310 ms
Thread ID: 8, set_cpu took 0.053695 ms
Threads took 6105.714223 ms
MSYNC 27382015120 TOOK 239.401149 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400e40200000, curr_checkpoint is 0x400e40200000
1, 2
Parall_iter 0, Write new metadata at address 0x400e40180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 1, parall_iter is 0, num_threads is 4, last counter is 2, curr_counter is 3
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e40280000, curr_pr_arr is 0x400e40280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x400fd82e1a00!
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400e40280000!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x401170343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4013083a4e00!
Thread ID: 1, savenvm_thread_nd took 5591.078260 ms
Thread ID: 1, set_cpu took 0.090909 ms
Thread ID: 2, savenvm_thread_nd took 5616.308270 ms
Thread ID: 2, set_cpu took 0.059614 ms
Thread ID: 3, savenvm_thread_nd took 6013.476681 ms
Thread ID: 3, set_cpu took 0.061823 ms
Thread ID: 4, savenvm_thread_nd took 6086.987894 ms
Thread ID: 4, set_cpu took 0.053054 ms
Threads took 6087.203696 ms
MSYNC 27382015120 TOOK 216.611323 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400e40180000, curr_checkpoint is 0x400e40180000
0, 3
Parall_iter 1, Write new metadata at address 0x400e40200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 26, parall_iter is 1, num_threads is 4, last counter is 3, curr_counter is 4
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4014a0410000, curr_pr_arr is 0x4014a0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401638471a00!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4014a0410000!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4017d04d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401968534e00!
Thread ID: 5, savenvm_thread_nd took 5459.089760 ms
Thread ID: 5, set_cpu took 0.088125 ms
Thread ID: 6, savenvm_thread_nd took 5512.129607 ms
Thread ID: 6, set_cpu took 0.071070 ms
Thread ID: 7, savenvm_thread_nd took 5859.495292 ms
Thread ID: 7, set_cpu took 0.056766 ms
Thread ID: 8, savenvm_thread_nd took 5956.036675 ms
Thread ID: 8, set_cpu took 0.051903 ms
Threads took 5956.250141 ms
MSYNC 27382015120 TOOK 234.888609 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400e40200000, curr_checkpoint is 0x400e40200000
1, 4
Parall_iter 0, Write new metadata at address 0x400e40180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 51, parall_iter is 0, num_threads is 4, last counter is 4, curr_counter is 5
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e40280000, curr_pr_arr is 0x400e40280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400e40280000!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x400fd82e1a00!
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x401170343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4013083a4e00!
Thread ID: 1, savenvm_thread_nd took 5590.826876 ms
Thread ID: 1, set_cpu took 0.088029 ms
Thread ID: 2, savenvm_thread_nd took 5616.940220 ms
Thread ID: 2, set_cpu took 0.065982 ms
Thread ID: 3, savenvm_thread_nd took 5925.189359 ms
Thread ID: 3, set_cpu took 0.056126 ms
Thread ID: 4, savenvm_thread_nd took 5992.884359 ms
Thread ID: 4, set_cpu took 0.049407 ms
Threads took 5993.092385 ms
MSYNC 27382015120 TOOK 254.828567 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400e40180000, curr_checkpoint is 0x400e40180000
0, 5
Parall_iter 1, Write new metadata at address 0x400e40200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 79, parall_iter is 1, num_threads is 4, last counter is 5, curr_counter is 6
Writing offset is 39792, parall_iter_off2025-05-23 16:51:30,014 - root - INFO - Step: 125 | Loss: 10.40 | Tokens per second: 2268.68 | Training tokens per second (%): 39.27 | MFU (%): 3.14 | TFLOPs: 31.06
2025-05-23 16:51:30,677 - root - INFO - Step: 130 | Loss: 10.34 | Tokens per second: 15509.31 | Training tokens per second (%): 31.13 | MFU (%): 21.47 | TFLOPs: 212.34
2025-05-23 16:51:31,332 - root - INFO - Step: 135 | Loss: 9.73 | Tokens per second: 15700.64 | Training tokens per second (%): 43.91 | MFU (%): 21.73 | TFLOPs: 214.96
2025-05-23 16:51:31,977 - root - INFO - Step: 140 | Loss: 10.00 | Tokens per second: 15943.33 | Training tokens per second (%): 23.79 | MFU (%): 22.07 | TFLOPs: 218.28
2025-05-23 16:51:32,042 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:51:32,044 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:51:36,514 - root - INFO - Step: 145 | Loss: 9.69 | Tokens per second: 2258.60 | Training tokens per second (%): 40.89 | MFU (%): 3.13 | TFLOPs: 30.92
2025-05-23 16:51:37,162 - root - INFO - Step: 150 | Loss: 10.05 | Tokens per second: 15894.43 | Training tokens per second (%): 39.48 | MFU (%): 22.00 | TFLOPs: 217.61
2025-05-23 16:51:37,817 - root - INFO - Step: 155 | Loss: 10.01 | Tokens per second: 15697.23 | Training tokens per second (%): 59.66 | MFU (%): 21.73 | TFLOPs: 214.91
2025-05-23 16:51:38,477 - root - INFO - Step: 160 | Loss: 9.43 | Tokens per second: 15575.70 | Training tokens per second (%): 42.43 | MFU (%): 21.56 | TFLOPs: 213.25
2025-05-23 16:51:38,558 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:51:38,560 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:51:43,081 - root - INFO - Step: 165 | Loss: 9.66 | Tokens per second: 2225.61 | Training tokens per second (%): 32.87 | MFU (%): 3.08 | TFLOPs: 30.47
2025-05-23 16:51:43,744 - root - INFO - Step: 170 | Loss: 10.04 | Tokens per second: 15525.71 | Training tokens per second (%): 58.68 | MFU (%): 21.49 | TFLOPs: 212.56
2025-05-23 16:51:44,410 - root - INFO - Step: 175 | Loss: 10.07 | Tokens per second: 15442.10 | Training tokens per second (%): 39.18 | MFU (%): 21.38 | TFLOPs: 211.42
2025-05-23 16:51:45,060 - root - INFO - Step: 180 | Loss: 9.73 | Tokens per second: 15839.15 | Training tokens per second (%): 29.37 | MFU (%): 21.93 | TFLOPs: 216.85
2025-05-23 16:51:45,124 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:51:45,126 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:51:49,577 - root - INFO - Step: 185 | Loss: 10.11 | Tokens per second: 2268.17 | Training tokens per second (%): 27.41 | MFU (%): 3.14 | TFLOPs: 31.05
2025-05-23 16:51:50,229 - root - INFO - Step: 190 | Loss: 9.73 | Tokens per second: 15795.06 | Training tokens per second (%): 41.21 | MFU (%): 21.87 | TFLOPs: 216.25
2025-05-23 16:51:50,912 - root - INFO - Step: 195 | Loss: 9.36 | Tokens per second: 15055.75 | Training tokens per second (%): 45.33 | MFU (%): 20.84 | TFLOPs: 206.13
2025-05-23 16:51:51,570 - root - INFO - Step: 200 | Loss: 9.99 | Tokens per second: 15621.38 | Training tokens per second (%): 33.85 | MFU (%): 21.63 | TFLOPs: 213.87
2025-05-23 16:51:51,634 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:51:51,636 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:51:56,200 - root - INFO - Step: 205 | Loss: 9.28 | Tokens per second: 2213.27 | Training tokens per second (%): 19.40 | MFU (%): 3.06 | TFLOPs: 30.30
2025-05-23 16:51:56,868 - root - INFO - Step: 210 | Loss: 9.64 | Tokens per second: 15400.19 | Training tokens per second (%): 38.69 | MFU (%): 21.32 | TFLOPs: 210.84
2025-05-23 16:51:57,526 - root - INFO - Step: 215 | Loss: 9.42 | Tokens per second: 15629.70 | Training tokens per second (%): 24.02 | MFU (%): 21.64 | TFLOPs: 213.99
2025-05-23 16:51:58,182 - root - INFO - Step: 220 | Loss: 9.77 | Tokens per second: 15680.05 | Training tokens per second (%): 24.01 | MFU (%): 21.71 | TFLOPs: 214.68
2025-05-23 16:51:58,246 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:51:58,248 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
set is 6845513728
start_pr_arr is 0x4014a0410000, curr_pr_arr is 0x4014a0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401638471a00!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4014a0410000!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4017d04d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401968534e00!
Thread ID: 5, savenvm_thread_nd took 5541.326508 ms
Thread ID: 5, set_cpu took 0.090397 ms
Thread ID: 6, savenvm_thread_nd took 5587.335874 ms
Thread ID: 6, set_cpu took 0.064862 ms
Thread ID: 7, savenvm_thread_nd took 5867.348724 ms
Thread ID: 7, set_cpu took 0.050590 ms
Thread ID: 8, savenvm_thread_nd took 5995.552153 ms
Thread ID: 8, set_cpu took 0.057918 ms
Threads took 5995.836144 ms
MSYNC 27382015120 TOOK 285.268600 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400e40200000, curr_checkpoint is 0x400e40200000
1, 6
Parall_iter 0, Write new metadata at address 0x400e40180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 85, parall_iter is 0, num_threads is 4, last counter is 6, curr_counter is 7
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e40280000, curr_pr_arr is 0x400e40280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x400fd82e1a00!
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400e40280000!
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x401170343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4013083a4e00!
Thread ID: 1, savenvm_thread_nd took 5675.391140 ms
Thread ID: 1, set_cpu took 0.086173 ms
Thread ID: 2, savenvm_thread_nd took 5714.940569 ms
Thread ID: 2, set_cpu took 0.067486 ms
Thread ID: 3, savenvm_thread_nd took 5931.774222 ms
Thread ID: 3, set_cpu took 0.056862 ms
Thread ID: 4, savenvm_thread_nd took 6002.800867 ms
Thread ID: 4, set_cpu took 0.047359 ms
Threads took 6002.996606 ms
MSYNC 27382015120 TOOK 265.306979 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x400e40180000, curr_checkpoint is 0x400e40180000
0, 7
Parall_iter 1, Write new metadata at address 0x400e40200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 112, parall_iter is 1, num_threads is 4, last counter is 7, curr_counter is 8
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4014a0410000, curr_pr_arr is 0x4014a0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401638471a00!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4014a0410000!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4017d04d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401968534e00!
Thread ID: 5, savenvm_thread_nd took 5549.659991 ms
Thread ID: 5, set_cpu took 0.075070 ms
Thread ID: 6, savenvm_thread_nd took 5594.744520 ms
Thread ID: 6, set_cpu took 0.053375 ms
Thread ID: 7, savenvm_thread_nd took 5892.079261 ms
Thread ID: 7, set_cpu took 0.048159 ms
Thread ID: 8, savenvm_thread_nd took 5988.679555 ms
Thread ID: 8, set_cpu took 0.050847 ms
Threads took 5988.881565 ms
MSYNC 27382015120 TOOK 299.790123 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x400e40200000, curr_checkpoint is 0x400e40200000
1, 8
Parall_iter 0, Write new metadata at address 0x400e40180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 11, parall_iter is 0, num_threads is 4, last counter is 8, curr_counter is 9
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e40280000, curr_pr_arr is 0x400e40280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400e40280000!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x400fd82e1a00!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x401170343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4013083a4e00!
Thread ID: 1, savenvm_thread_nd took 5707.433813 ms
Thread ID: 1, set_cpu took 0.081438 ms
Thread ID: 2, savenvm_thread_nd took 5736.002732 ms
Thread ID: 2, set_cpu took 0.059711 ms
Thread ID: 3, savenvm_thread_nd took 6008.651160 ms
Thread ID: 3, set_cpu took 0.053310 ms
Thread ID: 4, savenvm_thread_nd took 6081.762833 ms
Thread ID: 4, set_cpu took 0.055487 ms
Threads took 6081.967563 ms
MSYNC 27382015120 TOOK 253.146472 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x400e40180000, curr_checkpoint is 0x400e40180000
0, 9
Parall_iter 1, Write new metadata at address 0x400e40200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 36, parall_iter is 1, num_threads is 4, last counter is 9, curr_counter is 10
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4014a0410000, curr_pr_arr is 0x4014a0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401638471a00!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4014a0410000!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4017d04d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401968534e00!
Thread ID: 5, savenvm_thread_nd took 5602.115951 ms
Thread ID: 5, set_cpu took 0.089822 ms
Thread ID: 6, savenvm_thread_nd took 5724.904467 ms
Thread ID: 6, set_cpu took 0.064894 ms
Thread ID: 7, savenvm_thread_nd took 5957.454392 ms
Thread ID: 7, set_cpu took 0.051327 ms
Thread ID: 8, savenvm_thread_nd took 6049.632801 ms
Thread ID: 8, set_cpu took 0.051582 ms
Threads took 6049.839995 ms
MSYNC 27382015120 TOOK 275.240799 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x400e40200000, curr_checkpoint is 0x400e40200000
1, 10
Parall_iter 0, Write new metadata at address 0x400e40180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 59, parall_iter is 0, num_threads is 4, last counter is 10, curr_counter is 11
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e40280000, curr_pr_arr is 0x400e40280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 2, CPU USE: 12
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x401170343400!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x400fd82e1a00!
At savenvm_thread_nd id is 1, sz is 172025-05-23 16:52:02,766 - root - INFO - Step: 225 | Loss: 9.40 | Tokens per second: 2235.28 | Training tokens per second (%): 40.32 | MFU (%): 3.09 | TFLOPs: 30.60
2025-05-23 16:52:03,415 - root - INFO - Step: 230 | Loss: 9.29 | Tokens per second: 15873.78 | Training tokens per second (%): 12.54 | MFU (%): 21.97 | TFLOPs: 217.33
2025-05-23 16:52:04,078 - root - INFO - Step: 235 | Loss: 9.50 | Tokens per second: 15512.51 | Training tokens per second (%): 27.69 | MFU (%): 21.47 | TFLOPs: 212.38
2025-05-23 16:52:04,742 - root - INFO - Step: 240 | Loss: 9.49 | Tokens per second: 15480.59 | Training tokens per second (%): 45.88 | MFU (%): 21.43 | TFLOPs: 211.94
2025-05-23 16:52:04,808 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:52:04,809 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:52:09,311 - root - INFO - Step: 245 | Loss: 9.44 | Tokens per second: 2242.74 | Training tokens per second (%): 43.83 | MFU (%): 3.10 | TFLOPs: 30.71
2025-05-23 16:52:09,991 - root - INFO - Step: 250 | Loss: 9.72 | Tokens per second: 15117.58 | Training tokens per second (%): 46.86 | MFU (%): 20.93 | TFLOPs: 206.97
2025-05-23 16:52:10,647 - root - INFO - Step: 255 | Loss: 9.96 | Tokens per second: 15694.97 | Training tokens per second (%): 22.31 | MFU (%): 21.73 | TFLOPs: 214.88
2025-05-23 16:52:11,316 - root - INFO - Step: 260 | Loss: 10.18 | Tokens per second: 15364.21 | Training tokens per second (%): 40.04 | MFU (%): 21.27 | TFLOPs: 210.35
2025-05-23 16:52:11,381 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:52:11,383 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:52:15,828 - root - INFO - Step: 265 | Loss: 9.69 | Tokens per second: 2271.43 | Training tokens per second (%): 25.34 | MFU (%): 3.14 | TFLOPs: 31.10
2025-05-23 16:52:16,491 - root - INFO - Step: 270 | Loss: 9.46 | Tokens per second: 15513.46 | Training tokens per second (%): 34.54 | MFU (%): 21.48 | TFLOPs: 212.39
2025-05-23 16:52:17,146 - root - INFO - Step: 275 | Loss: 9.52 | Tokens per second: 15694.27 | Training tokens per second (%): 26.43 | MFU (%): 21.73 | TFLOPs: 214.87
2025-05-23 16:52:17,806 - root - INFO - Step: 280 | Loss: 9.50 | Tokens per second: 15591.66 | Training tokens per second (%): 45.45 | MFU (%): 21.58 | TFLOPs: 213.47
2025-05-23 16:52:17,869 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:52:17,871 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:52:22,413 - root - INFO - Step: 285 | Loss: 9.67 | Tokens per second: 2223.98 | Training tokens per second (%): 43.17 | MFU (%): 3.08 | TFLOPs: 30.45
2025-05-23 16:52:23,069 - root - INFO - Step: 290 | Loss: 9.48 | Tokens per second: 15691.96 | Training tokens per second (%): 27.31 | MFU (%): 21.72 | TFLOPs: 214.84
2025-05-23 16:52:23,720 - root - INFO - Step: 295 | Loss: 9.44 | Tokens per second: 15796.21 | Training tokens per second (%): 22.29 | MFU (%): 21.87 | TFLOPs: 216.27
2025-05-23 16:52:24,416 - root - INFO - Step: 300 | Loss: 9.28 | Tokens per second: 14786.83 | Training tokens per second (%): 81.27 | MFU (%): 20.47 | TFLOPs: 202.45
2025-05-23 16:52:24,479 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:52:24,481 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:52:28,991 - root - INFO - Step: 305 | Loss: 9.79 | Tokens per second: 2239.81 | Training tokens per second (%): 42.13 | MFU (%): 3.10 | TFLOPs: 30.67
2025-05-23 16:52:29,644 - root - INFO - Step: 310 | Loss: 9.59 | Tokens per second: 15751.73 | Training tokens per second (%): 31.69 | MFU (%): 21.81 | TFLOPs: 215.66
2025-05-23 16:52:30,311 - root - INFO - Step: 315 | Loss: 9.03 | Tokens per second: 15425.34 | Training tokens per second (%): 42.22 | MFU (%): 21.35 | TFLOPs: 211.19
2025-05-23 16:52:30,980 - root - INFO - Step: 320 | Loss: 9.43 | Tokens per second: 15374.40 | Training tokens per second (%): 49.90 | MFU (%): 21.28 | TFLOPs: 210.49
2025-05-23 16:52:31,046 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:52:31,048 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:52:35,521 - root - INFO - Step: 325 | Loss: 9.45 | Tokens per second: 2256.49 | Training tokens per second (%): 34.84 | MFU (%): 3.12 | TFLOPs: 30.89
2025-05-23 16:52:36,190 - root - INFO - Step: 330 | Loss: 8.74 | Tokens per second: 15367.35 | Training tokens per second (%): 45.21 | MFU (%): 21.27 | TFLOPs: 210.39
2025-05-23 16:52:36,840 - root - INFO - Step: 335 | Loss: 9.48 | Tokens per second: 15820.59 | Training tokens per second (%): 12.21 | MFU (%): 21.90 | TFLOPs: 216.60
2025-05-23 16:52:37,496 - root - INFO - Step: 340 | Loss: 9.62 | Tokens per second: 15690.26 | Training tokens per second (%): 33.55 | MFU (%): 21.72 | TFLOPs: 214.82
2025-05-23 16:52:37,562 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:52:37,564 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
11376000, start addr is 0x400e40280000!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4013083a4e00!
Thread ID: 2, savenvm_thread_nd took 5637.185655 ms
Thread ID: 2, set_cpu took 0.074014 ms
Thread ID: 1, savenvm_thread_nd took 5662.462031 ms
Thread ID: 1, set_cpu took 0.094429 ms
Thread ID: 3, savenvm_thread_nd took 5988.265172 ms
Thread ID: 3, set_cpu took 0.054526 ms
Thread ID: 4, savenvm_thread_nd took 6064.357042 ms
Thread ID: 4, set_cpu took 0.051039 ms
Threads took 6064.551181 ms
MSYNC 27382015120 TOOK 209.514215 ms
CAS was successful! new counter is 11, is_distributed is 0
******** checkp_info saved in 0x400e40180000, curr_checkpoint is 0x400e40180000
0, 11
Parall_iter 1, Write new metadata at address 0x400e40200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 65, parall_iter is 1, num_threads is 4, last counter is 11, curr_counter is 12
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4014a0410000, curr_pr_arr is 0x4014a0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401638471a00!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4014a0410000!
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4017d04d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401968534e00!
Thread ID: 5, savenvm_thread_nd took 5626.042796 ms
Thread ID: 5, set_cpu took 0.078557 ms
Thread ID: 6, savenvm_thread_nd took 5677.308741 ms
Thread ID: 6, set_cpu took 0.059422 ms
Thread ID: 7, savenvm_thread_nd took 5943.940024 ms
Thread ID: 7, set_cpu took 0.054815 ms
Thread ID: 8, savenvm_thread_nd took 6037.379833 ms
Thread ID: 8, set_cpu took 0.060030 ms
Threads took 6037.598483 ms
MSYNC 27382015120 TOOK 237.957344 ms
CAS was successful! new counter is 12, is_distributed is 0
******** checkp_info saved in 0x400e40200000, curr_checkpoint is 0x400e40200000
1, 12
Parall_iter 0, Write new metadata at address 0x400e40180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 92, parall_iter is 0, num_threads is 4, last counter is 12, curr_counter is 13
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e40280000, curr_pr_arr is 0x400e40280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400e40280000!
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x400fd82e1a00!
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x401170343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4013083a4e00!
Thread ID: 1, savenvm_thread_nd took 5662.302815 ms
Thread ID: 1, set_cpu took 0.092350 ms
Thread ID: 2, savenvm_thread_nd took 5684.381237 ms
Thread ID: 2, set_cpu took 0.063070 ms
Thread ID: 3, savenvm_thread_nd took 5998.317017 ms
Thread ID: 3, set_cpu took 0.053598 ms
Thread ID: 4, savenvm_thread_nd took 6066.338213 ms
Thread ID: 4, set_cpu took 0.052319 ms
Threads took 6066.556927 ms
MSYNC 27382015120 TOOK 263.280086 ms
CAS was successful! new counter is 13, is_distributed is 0
******** checkp_info saved in 0x400e40180000, curr_checkpoint is 0x400e40180000
0, 13
Parall_iter 1, Write new metadata at address 0x400e40200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 117, parall_iter is 1, num_threads is 4, last counter is 13, curr_counter is 14
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4014a0410000, curr_pr_arr is 0x4014a0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 6, CPU USE: 16
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401638471a00!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4014a0410000!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4017d04d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401968534e00!
Thread ID: 5, savenvm_thread_nd took 5668.483050 ms
Thread ID: 5, set_cpu took 0.083581 ms
Thread ID: 6, savenvm_thread_nd took 5711.322044 ms
Thread ID: 6, set_cpu took 0.063295 ms
Thread ID: 7, savenvm_thread_nd took 5951.915407 ms
Thread ID: 7, set_cpu took 0.051454 ms
Thread ID: 8, savenvm_thread_nd took 6051.202819 ms
Thread ID: 8, set_cpu took 0.055647 ms
Threads took 6051.416060 ms
MSYNC 27382015120 TOOK 263.052253 ms
CAS was successful! new counter is 14, is_distributed is 0
******** checkp_info saved in 0x400e40200000, curr_checkpoint is 0x400e40200000
1, 14
Parall_iter 0, Write new metadata at address 0x400e40180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 13, parall_iter is 0, num_threads is 4, last counter is 14, curr_counter is 15
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e40280000, curr_pr_arr is 0x400e40280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400e40280000!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x400fd82e1a00!
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x401170343400!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4013083a4e00!
Thread ID: 1, savenvm_thread_nd took 5539.459425 ms
Thread ID: 1, set_cpu took 0.087805 ms
Thread ID: 2, savenvm_thread_nd took 5582.136440 ms
Thread ID: 2, set_cpu took 0.067390 ms
Thread ID: 3, savenvm_thread_nd took 5965.784758 ms
Thread ID: 3, set_cpu took 0.054750 ms
Thread ID: 4, savenvm_thread_nd took 6038.452409 ms
Thread ID: 4, set_cpu took 0.050591 ms
Threads took 6038.649044 ms
MSYNC 27382015120 TOOK 232.831927 ms
CAS was successful! new counter is 15, is_distributed is 0
******** checkp_info saved in 0x400e40180000, curr_checkpoint is 0x400e40180000
0, 15
Parall_iter 1, Write new metadata at address 0x400e40200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 19, parall_iter is 1, num_threads is 4, last counter is 15, curr_counter is 16
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4014a0410000, curr_pr_arr is 0x4014a0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4014a0410000!
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401638471a00!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4017d04d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401968534e00!
Thread ID: 5, savenvm_thread_nd took 5577.677244 ms
Thread ID: 5, set_cpu took 0.082557 ms
Thread ID: 6, savenvm_thread_nd took 5610.727117 ms
Thread ID: 6, set_cpu took 0.059134 ms
Thread ID: 7, savenvm_thread_nd took 5948.730507 ms
Thread ID: 7, set_cpu took 0.050943 ms
Thread ID: 8, savenvm_thread_nd took 6044.225615 ms
Thread ID: 8, set_cpu took 0.048095 ms
Threads took 6044.426058 ms
MSYNC 27382015120 TOOK 22025-05-23 16:52:42,066 - root - INFO - Step: 345 | Loss: 9.39 | Tokens per second: 2242.49 | Training tokens per second (%): 38.32 | MFU (%): 3.10 | TFLOPs: 30.70
2025-05-23 16:52:42,728 - root - INFO - Step: 350 | Loss: 9.61 | Tokens per second: 15516.94 | Training tokens per second (%): 38.50 | MFU (%): 21.48 | TFLOPs: 212.44
2025-05-23 16:52:43,383 - root - INFO - Step: 355 | Loss: 9.29 | Tokens per second: 15707.13 | Training tokens per second (%): 18.47 | MFU (%): 21.74 | TFLOPs: 215.05
2025-05-23 16:52:44,047 - root - INFO - Step: 360 | Loss: 8.91 | Tokens per second: 15508.31 | Training tokens per second (%): 50.04 | MFU (%): 21.47 | TFLOPs: 212.32
2025-05-23 16:52:44,111 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:52:44,112 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:52:48,470 - root - INFO - Step: 365 | Loss: 9.39 | Tokens per second: 2316.34 | Training tokens per second (%): 41.02 | MFU (%): 3.21 | TFLOPs: 31.71
2025-05-23 16:52:49,125 - root - INFO - Step: 370 | Loss: 9.03 | Tokens per second: 15731.87 | Training tokens per second (%): 35.15 | MFU (%): 21.78 | TFLOPs: 215.39
2025-05-23 16:52:49,807 - root - INFO - Step: 375 | Loss: 9.42 | Tokens per second: 15090.90 | Training tokens per second (%): 78.84 | MFU (%): 20.89 | TFLOPs: 206.61
2025-05-23 16:52:50,492 - root - INFO - Step: 380 | Loss: 8.93 | Tokens per second: 15010.88 | Training tokens per second (%): 49.27 | MFU (%): 20.78 | TFLOPs: 205.51
2025-05-23 16:52:50,567 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:52:50,569 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-23 16:52:54,877 - root - INFO - Step: 385 | Loss: 9.24 | Tokens per second: 2336.76 | Training tokens per second (%): 34.22 | MFU (%): 3.23 | TFLOPs: 31.99
2025-05-23 16:52:55,540 - root - INFO - Step: 390 | Loss: 9.03 | Tokens per second: 15506.61 | Training tokens per second (%): 41.74 | MFU (%): 21.47 | TFLOPs: 212.30
2025-05-23 16:52:56,203 - root - INFO - Step: 395 | Loss: 9.32 | Tokens per second: 15522.13 | Training tokens per second (%): 45.66 | MFU (%): 21.49 | TFLOPs: 212.51
2025-05-23 16:52:56,869 - root - INFO - Step: 400 | Loss: 8.91 | Tokens per second: 15438.66 | Training tokens per second (%): 36.79 | MFU (%): 21.37 | TFLOPs: 211.37
2025-05-23 16:52:56,934 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-23 16:52:56,936 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
total_size: 6845503780, bsize: 6845503780, ratio: 2.0
6845503780 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 226.26495361328125 ms
CPU copy took 6360.274791717529 ms
---------------------- [PERF] Single Checkpoint time is 6.607250690460205 sec, average is 6.607247591018677
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 223.8304615020752 ms
CPU copy took 6350.656270980835 ms
---------------------- [PERF] Single Checkpoint time is 6.589960336685181 sec, average is 6.5986021757125854
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 223.82688522338867 ms
CPU copy took 6309.393644332886 ms
---------------------- [PERF] Single Checkpoint time is 6.548683166503906 sec, average is 6.589956760406494
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 223.79374504089355 ms
CPU copy took 6196.686506271362 ms
---------------------- [PERF] Single Checkpoint time is 6.4410388469696045 sec, average is 6.569318890571594
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 224.0452766418457 ms
CPU copy took 6253.46827507019 ms
---------------------- [PERF] Single Checkpoint time is 6.493014812469482 sec, average is 6.548681020736694
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 223.82354736328125 ms
CPU copy took 6286.69548034668 ms
---------------------- [PERF] Single Checkpoint time is 6.526058673858643 sec, average is 6.537369132041931
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 223.88219833374023 ms
CPU copy took 6273.831129074097 ms
---------------------- [PERF] Single Checkpoint time is 6.5182483196258545 sec, average is 6.526057243347168
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 223.76513481140137 ms
CPU copy took 6294.217348098755 ms
---------------------- [PERF] Single Checkpoint time is 6.533469200134277 sec, average is 6.529761910438538
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 224.0619659423828 ms
CPU copy took 6340.664386749268 ms
---------------------- [PERF] Single Checkpoint time is 6.580255031585693 sec, average is 6.533466577529907
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 223.83904457092285 ms
CPU copy took 6330.624580383301 ms
---------------------- [PERF] Single Checkpoint time is 6.569947242736816 sec, average is 6.541073799133301
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 223.7851619720459 ms
CPU copy took 6279.593706130981 ms
---------------------- [PERF] Single Checkpoint time is 6.523942470550537 sec, average is 6.533466577529907
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 223.78826141357422 ms
CPU copy took 6281.11720085144 ms
---------------------- [PERF] Single Checkpoint time is 6.520430088043213 sec, average is 6.529761910438538
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 224.3051528930664 ms
CPU copy took 6335.418462753296 ms
---------------------- [PERF] Single Checkpoint time is 6.575237989425659 sec, average is 6.533466577529907
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 223.82497787475586 ms
CPU copy took 6320.012807846069 ms
---------------------- [PERF] Single Checkpoint time is 6.559333562850952 sec, average is 6.541073799133301
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 223.83618354797363 ms
CPU copy took 6277.011394500732 ms
---------------------- [PERF] Single Checkpoint time is 6.521421194076538 sec, average is 6.533466577529907
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 223.79326820373535 ms
CPU copy took 6270.396947860718 ms
---------------------- [PERF] Single Checkpoint time is 6.5096821784973145 sec, average is 6.529761910438538
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 223.99210929870605 ms
CPU copy took 6174.410343170166 ms
---------------------- [PERF] Single Checkpoint time is 6.413915634155273 sec, average is 6.526057243347168
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 223.86646270751953 ms
CPU copy took 6158.27751159668 ms
---------------------- [PERF] Single Checkpoint time is 6.397629261016846 sec, average is 6.524998903274536
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 223.8931655883789 ms
CPU copy took 6153.568983078003 ms
---------------------- [PERF] Single Checkpoint time is 6.3930017948150635 sec, average is 6.523940563201904
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 223.50478172302246 ms
CPU copy took 6181.327342987061 ms
---------------------- [PERF] Single Checkpoint time is 6.4052393436431885 sec, average is 6.522679924964905
---- exit
20.409253 ms
CAS was successful! new counter is 16, is_distributed is 0
******** checkp_info saved in 0x400e40200000, curr_checkpoint is 0x400e40200000
1, 16
Parall_iter 0, Write new metadata at address 0x400e40180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 47, parall_iter is 0, num_threads is 4, last counter is 16, curr_counter is 17
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e40280000, curr_pr_arr is 0x400e40280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 2, CPU USE: 12
CPU: 1, CPU USE: 11
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x401170343400!
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400e40280000!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x400fd82e1a00!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4013083a4e00!
Thread ID: 2, savenvm_thread_nd took 5544.851715 ms
Thread ID: 2, set_cpu took 0.065694 ms
Thread ID: 1, savenvm_thread_nd took 5545.669515 ms
Thread ID: 1, set_cpu took 0.090493 ms
Thread ID: 3, savenvm_thread_nd took 5824.812270 ms
Thread ID: 3, set_cpu took 0.051487 ms
Thread ID: 4, savenvm_thread_nd took 5898.001026 ms
Thread ID: 4, set_cpu took 0.047551 ms
Threads took 5898.190333 ms
MSYNC 27382015120 TOOK 270.684445 ms
CAS was successful! new counter is 17, is_distributed is 0
******** checkp_info saved in 0x400e40180000, curr_checkpoint is 0x400e40180000
0, 17
Parall_iter 1, Write new metadata at address 0x400e40200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 53, parall_iter is 1, num_threads is 4, last counter is 17, curr_counter is 18
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4014a0410000, curr_pr_arr is 0x4014a0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 7, CPU USE: 17
CPU: 6, CPU USE: 16
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401638471a00!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4017d04d3400!
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4014a0410000!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401968534e00!
Thread ID: 5, savenvm_thread_nd took 5406.811715 ms
Thread ID: 5, set_cpu took 0.092861 ms
Thread ID: 6, savenvm_thread_nd took 5584.816106 ms
Thread ID: 6, set_cpu took 0.070590 ms
Thread ID: 7, savenvm_thread_nd took 5824.881227 ms
Thread ID: 7, set_cpu took 0.058366 ms
Thread ID: 8, savenvm_thread_nd took 5914.912911 ms
Thread ID: 8, set_cpu took 0.051262 ms
Threads took 5915.117353 ms
MSYNC 27382015120 TOOK 237.545326 ms
CAS was successful! new counter is 18, is_distributed is 0
******** checkp_info saved in 0x400e40200000, curr_checkpoint is 0x400e40200000
1, 18
Parall_iter 0, Write new metadata at address 0x400e40180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 98, parall_iter is 0, num_threads is 4, last counter is 18, curr_counter is 19
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e40280000, curr_pr_arr is 0x400e40280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 1, CPU USE: 11
CPU: 2, CPU USE: 12
CPU: 3, CPU USE: 13
CPU: 4, CPU USE: 14
At savenvm_thread_nd id is 3, sz is 1711376000, start addr is 0x401170343400!
At savenvm_thread_nd id is 1, sz is 1711376000, start addr is 0x400e40280000!
At savenvm_thread_nd id is 2, sz is 1711376000, start addr is 0x400fd82e1a00!
At savenvm_thread_nd id is 4, sz is 1711375780, start addr is 0x4013083a4e00!
Thread ID: 1, savenvm_thread_nd took 5510.583187 ms
Thread ID: 1, set_cpu took 0.086974 ms
Thread ID: 2, savenvm_thread_nd took 5535.734574 ms
Thread ID: 2, set_cpu took 0.067806 ms
Thread ID: 4, savenvm_thread_nd took 5871.169113 ms
Thread ID: 4, set_cpu took 0.053278 ms
Thread ID: 3, savenvm_thread_nd took 6072.611307 ms
Thread ID: 3, set_cpu took 0.052063 ms
Threads took 6072.807526 ms
MSYNC 27382015120 TOOK 75.236601 ms
CAS was successful! new counter is 19, is_distributed is 0
******** checkp_info saved in 0x400e40180000, curr_checkpoint is 0x400e40180000
0, 19
Parall_iter 1, Write new metadata at address 0x400e40200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 104, parall_iter is 1, num_threads is 4, last counter is 19, curr_counter is 20
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x4014a0410000, curr_pr_arr is 0x4014a0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711376000
size_for_thread_i is 1711375780
CPU: 5, CPU USE: 15
CPU: 6, CPU USE: 16
CPU: 7, CPU USE: 17
CPU: 8, CPU USE: 18
At savenvm_thread_nd id is 5, sz is 1711376000, start addr is 0x4014a0410000!
At savenvm_thread_nd id is 6, sz is 1711376000, start addr is 0x401638471a00!
At savenvm_thread_nd id is 7, sz is 1711376000, start addr is 0x4017d04d3400!
At savenvm_thread_nd id is 8, sz is 1711375780, start addr is 0x401968534e00!
Thread ID: 5, savenvm_thread_nd took 5542.642179 ms
Thread ID: 5, set_cpu took 0.090173 ms
Thread ID: 6, savenvm_thread_nd took 5589.155209 ms
Thread ID: 6, set_cpu took 0.071454 ms
Thread ID: 7, savenvm_thread_nd took 5820.974046 ms
Thread ID: 7, set_cpu took 0.054430 ms
Thread ID: 8, savenvm_thread_nd took 5906.429290 ms
Thread ID: 8, set_cpu took 0.050719 ms
Threads took 5906.643268 ms
MSYNC 27382015120 TOOK 274.168982 ms
CAS was successful! new counter is 20, is_distributed is 0
******** checkp_info saved in 0x400e40200000, curr_checkpoint is 0x400e40200000
1, 20
2025-05-23 16:53:08,784 - root - INFO - Training completed
2025-05-23 16:53:08,784 - root - INFO - Training run end: total time taken 135.08 seconds
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
==== PCCHECK END ====
Benchmarking complete.
