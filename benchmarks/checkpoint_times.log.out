==== RUNNING BASELINE FOR 1024 WITH fp32 ====
2025-05-22 20:41:59,532 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=10, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_1024/loss_trace.csv', checkpoint_freq=1, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 20:41:59,556 - root - INFO - Setting up DataLoaders...
2025-05-22 20:42:02,051 - root - INFO - Setting up Model...
2025-05-22 20:42:08,502 - root - INFO - Starting training!
2025-05-22 20:42:09,443 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 1089.71 | Training tokens per second (%): 77.54 | MFU (%): 0.45 | TFLOPs: 4.50
2025-05-22 20:42:14,479 - root - INFO - Checkpoint saved in 5.0361 seconds
2025-05-22 20:42:14,481 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:42:19,047 - root - INFO - Checkpoint saved in 4.4496 seconds
2025-05-22 20:42:19,048 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:42:24,087 - root - INFO - Checkpoint saved in 4.8974 seconds
2025-05-22 20:42:24,088 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:42:28,688 - root - INFO - Checkpoint saved in 4.4554 seconds
2025-05-22 20:42:28,689 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:42:28,837 - root - INFO - Step: 5 | Loss: 11.88 | Tokens per second: 211.24 | Training tokens per second (%): 40.14 | MFU (%): 0.09 | TFLOPs: 0.87
2025-05-22 20:42:33,717 - root - INFO - Checkpoint saved in 4.8797 seconds
2025-05-22 20:42:33,719 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:42:38,318 - root - INFO - Checkpoint saved in 4.4562 seconds
2025-05-22 20:42:38,320 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:42:42,909 - root - INFO - Checkpoint saved in 4.4459 seconds
2025-05-22 20:42:42,911 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:42:47,943 - root - INFO - Checkpoint saved in 4.8889 seconds
2025-05-22 20:42:47,945 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:42:52,542 - root - INFO - Checkpoint saved in 4.4541 seconds
2025-05-22 20:42:52,544 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:42:52,686 - root - INFO - Step: 10 | Loss: 11.77 | Tokens per second: 214.71 | Training tokens per second (%): 83.77 | MFU (%): 0.09 | TFLOPs: 0.89
2025-05-22 20:42:57,133 - root - INFO - Checkpoint saved in 4.4467 seconds
2025-05-22 20:42:57,135 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:42:57,135 - root - INFO - Training completed
==== BASELINE END ====
==== RUNNING PCCHECK FOR 1024 WITH fp32 ====
2025-05-22 20:43:00,960 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=10, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_1024/loss_trace.csv', checkpoint_freq=1, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 20:43:00,962 - root - INFO - Setting up DataLoaders...
2025-05-22 20:43:01,935 - root - INFO - Setting up Model...
Model size: 755041280, Optimizer size: 1510082852, Total size: 2265124132
BSIZE IS 2265124132
At checkpoint, bsize is 2265124132
2025-05-22 20:43:14,788 - root - INFO - Checkpointing warmup done
2025-05-22 20:43:14,789 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-22 20:43:15,110 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 3219.94 | Training tokens per second (%): 77.54 | MFU (%): 1.34 | TFLOPs: 13.29
2025-05-22 20:43:15,129 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:43:15,130 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:43:15,293 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:43:15,295 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:43:18,686 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:43:18,687 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:43:22,120 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:43:22,121 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:43:24,720 - root - INFO - Step: 5 | Loss: 11.89 | Tokens per second: 426.35 | Training tokens per second (%): 40.14 | MFU (%): 0.18 | TFLOPs: 1.76
2025-05-22 20:43:24,739 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:43:24,741 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:43:27,360 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:43:27,362 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:43:29,993 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:43:29,995 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:43:32,637 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:43:32,638 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:43:35,267 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:43:35,269 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:43:37,836 - root - INFO - Step: 10 | Loss: 11.78 | Tokens per second: 390.44 | Training tokens per second (%): 83.77 | MFU (%): 0.16 | TFLOPs: 1.61
2025-05-22 20:43:37,854 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:43:37,855 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x400800280000, PR_ADDR is 0x400800000000, PEER_CHECK_ADDR is 0x400800080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 2265124132
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 22, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 3259.413849 ms
Thread ID: 1, set_cpu took 0.082878 ms
Threads took 3280.159386 ms
MSYNC 9060496528 TOOK 49.005989 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 1
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 44, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 3308.124743 ms
Thread ID: 2, set_cpu took 0.096702 ms
Threads took 3324.986905 ms
MSYNC 9060496528 TOOK 45.129334 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 2
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 47, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2510.552999 ms
Thread ID: 1, set_cpu took 0.074814 ms
Threads took 2532.316073 ms
MSYNC 9060496528 TOOK 18.849303 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 3
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 50, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2500.896934 ms
Thread ID: 2, set_cpu took 0.069022 ms
Threads took 2521.037977 ms
MSYNC 9060496528 TOOK 22.288051 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 4
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 75, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2527.781812 ms
Thread ID: 1, set_cpu took 0.069342 ms
Threads took 2549.094852 ms
MSYNC 9060496528 TOOK 18.920502 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 5
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 78, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2523.468019 ms
Thread ID: 2, set_cpu took 0.067774 ms
Threads took 2543.597861 ms
MSYNC 9060496528 TOOK 18.353542 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 6
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 81, parall_iter is 0, num_threads is 1, last counter is 6, curr_counter is 7
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2513.061764 ms
Thread ID: 1, set_cpu took 0.058718 ms
Threads took 2533.185366 ms
MSYNC 9060496528 TOOK 18.814297 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 7
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 84, parall_iter is 1, num_threads is 1, last counter is 7, curr_counter is 8
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2476.860330 ms
Thread ID: 2, set_cpu took 0.067742 ms
Threads took 2501.166689 ms
MSYNC 9060496528 TOOK 19.633313 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 8
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 87, parall_iter is 0, num_threads is 1, last counter is 8, curr_counter is 9
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2500.796940 ms
Thread ID: 1, set_cpu took 0.056927 ms
Threads took 2520.919454 ms
MSYNC 9060496528 TOOK 18.331654 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 9
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 113, total_size: 2265124132, bsize: 2265124132, ratio: 2.0
2265124132 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 54.10361289978027 ms
CPU copy took 3334.7184658050537 ms
---------------------- [PERF] Single Checkpoint time is 3.4091525077819824 sec, average is 3.409149169921875
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 57.6019287109375 ms
CPU copy took 3375.610828399658 ms
---------------------- [PERF] Single Checkpoint time is 3.433652400970459 sec, average is 3.421399712562561
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 58.26759338378906 ms
CPU copy took 2556.710720062256 ms
---------------------- [PERF] Single Checkpoint time is 2.6153509616851807 sec, average is 3.409149169921875
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 58.87866020202637 ms
CPU copy took 2563.725709915161 ms
---------------------- [PERF] Single Checkpoint time is 2.622965097427368 sec, average is 3.0160566568374634
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.098005294799805 ms
CPU copy took 2573.431968688965 ms
---------------------- [PERF] Single Checkpoint time is 2.632859230041504 sec, average is 2.632857084274292
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 57.55305290222168 ms
CPU copy took 2586.3723754882812 ms
---------------------- [PERF] Single Checkpoint time is 2.644467830657959 sec, average is 2.638661742210388
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 56.5488338470459 ms
CPU copy took 2572.3769664764404 ms
---------------------- [PERF] Single Checkpoint time is 2.629333257675171 sec, average is 2.632857084274292
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 57.26981163024902 ms
CPU copy took 2526.210308074951 ms
---------------------- [PERF] Single Checkpoint time is 2.583889961242676 sec, average is 2.631094813346863
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.20219421386719 ms
CPU copy took 2562.3457431793213 ms
---------------------- [PERF] Single Checkpoint time is 2.621950149536133 sec, average is 2.6293325424194336
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 53.92956733703613 ms
CPU copy took 2504.784107208252 ms
---------------------- [PERF] Single Checkpoint time is 2.5590755939483643 sec, average is 2.6261483430862427
---- exit
parall_iter is 1, num_threads is 1, last counter is 9, curr_counter is 10
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2483.217391 ms
Thread ID: 2, set_cpu took 0.064158 ms
Threads took 2483.403626 ms
MSYNC 9060496528 TOOK 20.954009 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 10
2025-05-22 20:43:43,834 - root - INFO - Training completed
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
==== PCCHECK END ====
==== RUNNING BASELINE FOR 2048 WITH fp32 ====
2025-05-22 20:43:47,410 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=10, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_2048/loss_trace.csv', checkpoint_freq=1, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 20:43:47,411 - root - INFO - Setting up DataLoaders...
2025-05-22 20:43:48,523 - root - INFO - Setting up Model...
2025-05-22 20:43:59,765 - root - INFO - Starting training!
2025-05-22 20:44:00,346 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 3608.37 | Training tokens per second (%): 38.77 | MFU (%): 5.00 | TFLOPs: 49.40
2025-05-22 20:44:25,121 - root - INFO - Checkpoint saved in 24.7752 seconds
2025-05-22 20:44:25,124 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:44:50,236 - root - INFO - Checkpoint saved in 24.8447 seconds
2025-05-22 20:44:50,238 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:45:15,131 - root - INFO - Checkpoint saved in 24.6505 seconds
2025-05-22 20:45:15,133 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:45:40,053 - root - INFO - Checkpoint saved in 24.6585 seconds
2025-05-22 20:45:40,055 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:45:40,326 - root - INFO - Step: 5 | Loss: 11.84 | Tokens per second: 81.94 | Training tokens per second (%): 22.83 | MFU (%): 0.11 | TFLOPs: 1.12
2025-05-22 20:46:04,976 - root - INFO - Checkpoint saved in 24.6501 seconds
2025-05-22 20:46:04,979 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:46:29,804 - root - INFO - Checkpoint saved in 24.5661 seconds
2025-05-22 20:46:29,806 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:46:54,719 - root - INFO - Checkpoint saved in 24.6585 seconds
2025-05-22 20:46:54,722 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:47:19,865 - root - INFO - Checkpoint saved in 24.8683 seconds
2025-05-22 20:47:19,868 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:47:44,808 - root - INFO - Checkpoint saved in 24.6613 seconds
2025-05-22 20:47:44,810 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:47:45,078 - root - INFO - Step: 10 | Loss: 11.61 | Tokens per second: 82.09 | Training tokens per second (%): 51.44 | MFU (%): 0.11 | TFLOPs: 1.12
2025-05-22 20:48:09,766 - root - INFO - Checkpoint saved in 24.6879 seconds
2025-05-22 20:48:09,769 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:48:09,769 - root - INFO - Training completed
==== BASELINE END ====
==== RUNNING PCCHECK FOR 2048 WITH fp32 ====
2025-05-22 20:48:13,962 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=10, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_2048/loss_trace.csv', checkpoint_freq=1, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 20:48:13,964 - root - INFO - Setting up DataLoaders...
2025-05-22 20:48:14,916 - root - INFO - Setting up Model...
Model size: 2281834496, Optimizer size: 4563669284, Total size: 6845503780
BSIZE IS 6845503780
At checkpoint, bsize is 6845503780
2025-05-22 20:48:35,664 - root - INFO - Checkpointing warmup done
2025-05-22 20:48:35,666 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-22 20:48:36,362 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 2982.75 | Training tokens per second (%): 38.77 | MFU (%): 4.13 | TFLOPs: 40.84
2025-05-22 20:48:36,493 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:48:36,569 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:48:36,870 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:48:36,872 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:48:46,910 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:48:46,912 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:48:57,110 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:48:57,112 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:49:05,804 - root - INFO - Step: 5 | Loss: 11.85 | Tokens per second: 278.47 | Training tokens per second (%): 22.83 | MFU (%): 0.39 | TFLOPs: 3.81
2025-05-22 20:49:05,828 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:49:05,829 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:49:14,490 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:49:14,491 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:49:22,708 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:49:22,710 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:49:31,291 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:49:31,293 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:49:39,528 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:49:39,530 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:49:48,157 - root - INFO - Step: 10 | Loss: 11.62 | Tokens per second: 241.92 | Training tokens per second (%): 51.44 | MFU (%): 0.33 | TFLOPs: 3.31
2025-05-22 20:49:48,181 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:49:48,182 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x400f20280000, PR_ADDR is 0x400f20000000, PEER_CHECK_ADDR is 0x400f20080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 6845503780
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 93, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 9872.206024 ms
Thread ID: 1, set_cpu took 0.094461 ms
Threads took 9886.921112 ms
MSYNC 27382015120 TOOK 41.759253 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 1
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 121, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 9926.054394 ms
Thread ID: 2, set_cpu took 0.074685 ms
Threads took 9944.637111 ms
MSYNC 27382015120 TOOK 38.666096 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 2
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 34, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 8462.245638 ms
Thread ID: 1, set_cpu took 0.076829 ms
Threads took 8479.891391 ms
MSYNC 27382015120 TOOK 19.057072 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 3
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 37, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 8406.192437 ms
Thread ID: 2, set_cpu took 0.079678 ms
Threads took 8427.727677 ms
MSYNC 27382015120 TOOK 16.750676 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 4
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 61, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 7963.805086 ms
Thread ID: 1, set_cpu took 0.071326 ms
Threads took 7982.468698 ms
MSYNC 27382015120 TOOK 19.038353 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 5
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 102, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 8329.325800 ms
Thread ID: 2, set_cpu took 0.071166 ms
Threads took 8349.541110 ms
MSYNC 27382015120 TOOK 15.281311 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 6
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 126, parall_iter is 0, num_threads is 1, last counter is 6, curr_counter is 7
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 7983.138182 ms
Thread ID: 1, set_cpu took 0.071486 ms
Threads took 8001.668934 ms
MSYNC 27382015120 TOOK 18.894355 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 7
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 1, parall_iter is 1, num_threads is 1, last counter is 7, curr_counter is 8
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 8388.422528 ms
Thread ID: 2, set_cpu took 0.064126 ms
Threads took 8419.279476 ms
MSYNC 27382015120 TOOK 15.084421 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 8
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 44, parall_iter is 0, num_threads is 1, last counter is 8, curr_counter is 9
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 8061.916795 ms
Thread ID: 1, set_cpu took 0.068798 ms
Threads took 8080.341982 ms
MSYNC 27382015120 TOOK 22.307728 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 9
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, ttotal_size: 6845503780, bsize: 6845503780, ratio: 2.0
6845503780 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 210.158109664917 ms
CPU copy took 9934.230327606201 ms
---------------------- [PERF] Single Checkpoint time is 10.164692878723145 sec, average is 10.164690732955933
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 209.98811721801758 ms
CPU copy took 9988.768577575684 ms
---------------------- [PERF] Single Checkpoint time is 10.199457168579102 sec, average is 10.182072520256042
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 210.59298515319824 ms
CPU copy took 8504.408836364746 ms
---------------------- [PERF] Single Checkpoint time is 8.715397119522095 sec, average is 10.164690732955933
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 210.3714942932129 ms
CPU copy took 8449.910879135132 ms
---------------------- [PERF] Single Checkpoint time is 8.660691499710083 sec, average is 9.440043330192566
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 208.89592170715332 ms
CPU copy took 8006.954908370972 ms
---------------------- [PERF] Single Checkpoint time is 8.2186918258667 sec, average is 8.7153959274292
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 210.37721633911133 ms
CPU copy took 8370.268821716309 ms
---------------------- [PERF] Single Checkpoint time is 8.581057071685791 sec, average is 8.688042998313904
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 210.12401580810547 ms
CPU copy took 8026.008129119873 ms
---------------------- [PERF] Single Checkpoint time is 8.236703395843506 sec, average is 8.660690069198608
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 210.53504943847656 ms
CPU copy took 8439.821004867554 ms
---------------------- [PERF] Single Checkpoint time is 8.65083360671997 sec, average is 8.655760407447815
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 211.29274368286133 ms
CPU copy took 8108.093023300171 ms
---------------------- [PERF] Single Checkpoint time is 8.320003032684326 sec, average is 8.650830745697021
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 205.28793334960938 ms
CPU copy took 8389.940023422241 ms
---------------------- [PERF] Single Checkpoint time is 8.595602989196777 sec, average is 8.623215436935425
---- exit
id is 67, parall_iter is 1, num_threads is 1, last counter is 9, curr_counter is 10
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 8374.215777 ms
Thread ID: 2, set_cpu took 0.058942 ms
Threads took 8374.417979 ms
MSYNC 27382015120 TOOK 15.102084 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 10
2025-05-22 20:50:06,489 - root - INFO - Training completed
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
==== PCCHECK END ====
==== RUNNING BASELINE FOR 1024 WITH bf16 ====
2025-05-22 20:50:10,261 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=10, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_1024/loss_trace.csv', checkpoint_freq=1, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 20:50:10,263 - root - INFO - Setting up DataLoaders...
2025-05-22 20:50:12,018 - root - INFO - Setting up Model...
2025-05-22 20:50:19,780 - root - INFO - Starting training!
2025-05-22 20:50:20,500 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 1419.22 | Training tokens per second (%): 77.54 | MFU (%): 0.59 | TFLOPs: 5.86
2025-05-22 20:50:23,362 - root - INFO - Checkpoint saved in 2.8618 seconds
2025-05-22 20:50:23,363 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:50:25,839 - root - INFO - Checkpoint saved in 2.3342 seconds
2025-05-22 20:50:25,840 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:50:28,327 - root - INFO - Checkpoint saved in 2.3327 seconds
2025-05-22 20:50:28,328 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:50:30,815 - root - INFO - Checkpoint saved in 2.3371 seconds
2025-05-22 20:50:30,817 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:50:30,977 - root - INFO - Step: 5 | Loss: 11.92 | Tokens per second: 391.02 | Training tokens per second (%): 40.14 | MFU (%): 0.16 | TFLOPs: 1.61
2025-05-22 20:50:33,354 - root - INFO - Checkpoint saved in 2.3774 seconds
2025-05-22 20:50:33,356 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:50:35,844 - root - INFO - Checkpoint saved in 2.3371 seconds
2025-05-22 20:50:35,846 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:50:38,341 - root - INFO - Checkpoint saved in 2.3412 seconds
2025-05-22 20:50:38,342 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:50:40,832 - root - INFO - Checkpoint saved in 2.3340 seconds
2025-05-22 20:50:40,834 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:50:43,323 - root - INFO - Checkpoint saved in 2.3302 seconds
2025-05-22 20:50:43,324 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:50:43,471 - root - INFO - Step: 10 | Loss: 11.93 | Tokens per second: 409.82 | Training tokens per second (%): 83.77 | MFU (%): 0.17 | TFLOPs: 1.69
2025-05-22 20:50:45,800 - root - INFO - Checkpoint saved in 2.3280 seconds
2025-05-22 20:50:45,801 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:50:45,801 - root - INFO - Training completed
==== BASELINE END ====
==== RUNNING PCCHECK FOR 1024 WITH bf16 ====
2025-05-22 20:50:49,493 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=10, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_1024/loss_trace.csv', checkpoint_freq=1, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 20:50:49,496 - root - INFO - Setting up DataLoaders...
2025-05-22 20:50:50,521 - root - INFO - Setting up Model...
Model size: 755041280, Optimizer size: 1510082852, Total size: 2265124132
BSIZE IS 2265124132
At checkpoint, bsize is 2265124132
2025-05-22 20:51:05,010 - root - INFO - Checkpointing warmup done
2025-05-22 20:51:05,011 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-22 20:51:05,304 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 3509.62 | Training tokens per second (%): 77.54 | MFU (%): 1.46 | TFLOPs: 14.49
2025-05-22 20:51:05,343 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:51:05,344 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:51:05,515 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:51:05,517 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:51:08,929 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:51:08,930 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:51:12,336 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:51:12,337 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:51:14,957 - root - INFO - Step: 5 | Loss: 11.92 | Tokens per second: 424.38 | Training tokens per second (%): 40.14 | MFU (%): 0.18 | TFLOPs: 1.75
2025-05-22 20:51:15,004 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:51:15,005 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:51:17,644 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:51:17,646 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:51:20,325 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:51:20,327 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:51:23,015 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:51:23,016 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:51:25,681 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:51:25,682 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:51:28,297 - root - INFO - Step: 10 | Loss: 11.93 | Tokens per second: 383.85 | Training tokens per second (%): 83.77 | MFU (%): 0.16 | TFLOPs: 1.58
2025-05-22 20:51:28,344 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:51:28,345 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x4007c0280000, PR_ADDR is 0x4007c0000000, PEER_CHECK_ADDR is 0x4007c0080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 2265124132
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x4007c0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 3, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007c0280000, curr_pr_arr is 0x4007c0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007c0280000!
Thread ID: 1, savenvm_thread_nd took 3285.488723 ms
Thread ID: 1, set_cpu took 0.088318 ms
Threads took 3306.379180 ms
MSYNC 9060496528 TOOK 44.014547 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x4007c0180000, curr_checkpoint is 0x4007c0180000
0, 1
Parall_iter 1, Write new metadata at address 0x4007c0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 27, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009dc350000, curr_pr_arr is 0x4009dc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009dc350000!
Thread ID: 2, savenvm_thread_nd took 3262.059010 ms
Thread ID: 2, set_cpu took 0.094430 ms
Threads took 3282.223986 ms
MSYNC 9060496528 TOOK 42.169672 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x4007c0200000, curr_checkpoint is 0x4007c0200000
1, 2
Parall_iter 0, Write new metadata at address 0x4007c0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 30, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007c0280000, curr_pr_arr is 0x4007c0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007c0280000!
Thread ID: 1, savenvm_thread_nd took 2547.538602 ms
Thread ID: 1, set_cpu took 0.074430 ms
Threads took 2567.702106 ms
MSYNC 9060496528 TOOK 15.618677 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x4007c0180000, curr_checkpoint is 0x4007c0180000
0, 3
Parall_iter 1, Write new metadata at address 0x4007c0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 33, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009dc350000, curr_pr_arr is 0x4009dc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009dc350000!
Thread ID: 2, savenvm_thread_nd took 2541.390656 ms
Thread ID: 2, set_cpu took 0.067838 ms
Threads took 2563.730318 ms
MSYNC 9060496528 TOOK 17.119113 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x4007c0200000, curr_checkpoint is 0x4007c0200000
1, 4
Parall_iter 0, Write new metadata at address 0x4007c0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 36, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007c0280000, curr_pr_arr is 0x4007c0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007c0280000!
Thread ID: 1, savenvm_thread_nd took 2555.580478 ms
Thread ID: 1, set_cpu took 0.068062 ms
Threads took 2575.713998 ms
MSYNC 9060496528 TOOK 21.019702 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x4007c0180000, curr_checkpoint is 0x4007c0180000
0, 5
Parall_iter 1, Write new metadata at address 0x4007c0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 78, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009dc350000, curr_pr_arr is 0x4009dc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009dc350000!
Thread ID: 2, savenvm_thread_nd took 2566.022923 ms
Thread ID: 2, set_cpu took 0.065278 ms
Threads took 2586.161083 ms
MSYNC 9060496528 TOOK 20.702432 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x4007c0200000, curr_checkpoint is 0x4007c0200000
1, 6
Parall_iter 0, Write new metadata at address 0x4007c0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 81, parall_iter is 0, num_threads is 1, last counter is 6, curr_counter is 7
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007c0280000, curr_pr_arr is 0x4007c0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007c0280000!
Thread ID: 1, savenvm_thread_nd took 2542.025165 ms
Thread ID: 1, set_cpu took 0.074494 ms
Threads took 2562.170077 ms
MSYNC 9060496528 TOOK 18.887669 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x4007c0180000, curr_checkpoint is 0x4007c0180000
0, 7
Parall_iter 1, Write new metadata at address 0x4007c0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 84, parall_iter is 1, num_threads is 1, last counter is 7, curr_counter is 8
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009dc350000, curr_pr_arr is 0x4009dc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009dc350000!
Thread ID: 2, savenvm_thread_nd took 2545.887163 ms
Thread ID: 2, set_cpu took 0.069150 ms
Threads took 2566.033675 ms
MSYNC 9060496528 TOOK 18.968658 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x4007c0200000, curr_checkpoint is 0x4007c0200000
1, 8
Parall_iter 0, Write new metadata at address 0x4007c0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 87, parall_iter is 0, num_threads is 1, last counter is 8, curr_counter is 9
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007c0280000, curr_pr_arr is 0x4007c0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007c0280000!
Thread ID: 1, savenvm_thread_nd took 2566.499676 ms
Thread ID: 1, set_cpu took 0.065246 ms
Threads took 2587.471924 ms
MSYNC 9060496528 TOOK 19.680029 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x4007c0180000, curr_checkpoint is 0x4007c0180000
0, 9
Parall_iter 1, Write new metadata at address 0x4007c0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 90, patotal_size: 2265124132, bsize: 2265124132, ratio: 2.0
2265124132 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 53.966522216796875 ms
CPU copy took 3355.9367656707764 ms
---------------------- [PERF] Single Checkpoint time is 3.429807186126709 sec, average is 3.4298038482666016
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 57.40976333618164 ms
CPU copy took 3345.7744121551514 ms
---------------------- [PERF] Single Checkpoint time is 3.403639554977417 sec, average is 3.416720390319824
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 60.366153717041016 ms
CPU copy took 2607.267141342163 ms
---------------------- [PERF] Single Checkpoint time is 2.6680338382720947 sec, average is 3.403636932373047
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 57.96384811401367 ms
CPU copy took 2586.406469345093 ms
---------------------- [PERF] Single Checkpoint time is 2.644824981689453 sec, average is 3.035835027694702
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 56.20217323303223 ms
CPU copy took 2620.771884918213 ms
---------------------- [PERF] Single Checkpoint time is 2.6773242950439453 sec, average is 2.677320957183838
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.7684383392334 ms
CPU copy took 2629.2078495025635 ms
---------------------- [PERF] Single Checkpoint time is 2.6893844604492188 sec, average is 2.6833521127700806
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 57.07740783691406 ms
CPU copy took 2606.0869693756104 ms
---------------------- [PERF] Single Checkpoint time is 2.6635305881500244 sec, average is 2.677320957183838
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 57.31058120727539 ms
CPU copy took 2605.6225299835205 ms
---------------------- [PERF] Single Checkpoint time is 2.663287401199341 sec, average is 2.6726770401000977
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 57.71231651306152 ms
CPU copy took 2612.5802993774414 ms
---------------------- [PERF] Single Checkpoint time is 2.670621633529663 sec, average is 2.670619010925293
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 53.92622947692871 ms
CPU copy took 2561.805248260498 ms
---------------------- [PERF] Single Checkpoint time is 2.6160905361175537 sec, average is 2.669326066970825
---- exit
rall_iter is 1, num_threads is 1, last counter is 9, curr_counter is 10
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009dc350000, curr_pr_arr is 0x4009dc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009dc350000!
Thread ID: 2, savenvm_thread_nd took 2543.580542 ms
Thread ID: 2, set_cpu took 0.066718 ms
Threads took 2543.773496 ms
MSYNC 9060496528 TOOK 17.634426 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x4007c0200000, curr_checkpoint is 0x4007c0200000
1, 10
2025-05-22 20:51:34,439 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
==== PCCHECK END ====
==== RUNNING BASELINE FOR 2048 WITH bf16 ====
2025-05-22 20:51:38,084 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=10, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_2048/loss_trace.csv', checkpoint_freq=1, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 20:51:38,086 - root - INFO - Setting up DataLoaders...
2025-05-22 20:51:44,193 - root - INFO - Setting up Model...
2025-05-22 20:51:59,381 - root - INFO - Starting training!
2025-05-22 20:51:59,822 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 4640.42 | Training tokens per second (%): 38.77 | MFU (%): 6.42 | TFLOPs: 63.53
2025-05-22 20:52:07,354 - root - INFO - Checkpoint saved in 7.5320 seconds
2025-05-22 20:52:07,355 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:52:14,795 - root - INFO - Checkpoint saved in 7.2788 seconds
2025-05-22 20:52:14,796 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:52:22,692 - root - INFO - Checkpoint saved in 7.7201 seconds
2025-05-22 20:52:22,694 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:52:30,676 - root - INFO - Checkpoint saved in 7.7087 seconds
2025-05-22 20:52:30,677 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:52:30,987 - root - INFO - Step: 5 | Loss: 11.91 | Tokens per second: 262.88 | Training tokens per second (%): 22.83 | MFU (%): 0.36 | TFLOPs: 3.60
2025-05-22 20:52:38,693 - root - INFO - Checkpoint saved in 7.7062 seconds
2025-05-22 20:52:38,695 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:52:46,644 - root - INFO - Checkpoint saved in 7.7049 seconds
2025-05-22 20:52:46,646 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:52:54,659 - root - INFO - Checkpoint saved in 7.7109 seconds
2025-05-22 20:52:54,661 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:53:02,734 - root - INFO - Checkpoint saved in 7.7773 seconds
2025-05-22 20:53:02,736 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:53:10,665 - root - INFO - Checkpoint saved in 7.7336 seconds
2025-05-22 20:53:10,667 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:53:10,942 - root - INFO - Step: 10 | Loss: 11.87 | Tokens per second: 256.31 | Training tokens per second (%): 51.44 | MFU (%): 0.35 | TFLOPs: 3.51
2025-05-22 20:53:18,689 - root - INFO - Checkpoint saved in 7.7468 seconds
2025-05-22 20:53:18,691 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:53:18,691 - root - INFO - Training completed
==== BASELINE END ====
==== RUNNING PCCHECK FOR 2048 WITH bf16 ====
2025-05-22 20:53:22,884 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=10, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_2048/loss_trace.csv', checkpoint_freq=1, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 20:53:22,886 - root - INFO - Setting up DataLoaders...
2025-05-22 20:53:23,864 - root - INFO - Setting up Model...
Model size: 2281834496, Optimizer size: 4563669284, Total size: 6845503780
BSIZE IS 6845503780
At checkpoint, bsize is 6845503780
2025-05-22 20:53:47,696 - root - INFO - Checkpointing warmup done
2025-05-22 20:53:47,697 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-22 20:53:48,044 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 5961.34 | Training tokens per second (%): 38.77 | MFU (%): 8.25 | TFLOPs: 81.62
2025-05-22 20:53:48,102 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:53:48,103 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:53:48,431 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:53:48,433 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:53:58,641 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:53:58,642 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:54:09,010 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:54:09,013 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:54:19,000 - root - INFO - Step: 5 | Loss: 11.91 | Tokens per second: 264.66 | Training tokens per second (%): 22.83 | MFU (%): 0.37 | TFLOPs: 3.62
2025-05-22 20:54:19,064 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:54:19,066 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:54:29,152 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:54:29,154 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:54:39,310 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:54:39,311 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:54:49,441 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:54:49,443 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:54:59,654 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:54:59,656 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 20:55:09,833 - root - INFO - Step: 10 | Loss: 11.87 | Tokens per second: 201.46 | Training tokens per second (%): 51.44 | MFU (%): 0.28 | TFLOPs: 2.76
2025-05-22 20:55:09,897 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 20:55:09,898 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x400e20280000, PR_ADDR is 0x400e20000000, PEER_CHECK_ADDR is 0x400e20080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 6845503780
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400e20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 11, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e20280000, curr_pr_arr is 0x400e20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e20280000!
Thread ID: 1, savenvm_thread_nd took 9939.618538 ms
Thread ID: 1, set_cpu took 0.083838 ms
Threads took 9959.415878 ms
MSYNC 27382015120 TOOK 25.752300 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400e20180000, curr_checkpoint is 0x400e20180000
0, 1
Parall_iter 1, Write new metadata at address 0x400e20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 32, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401480410000, curr_pr_arr is 0x401480410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401480410000!
Thread ID: 2, savenvm_thread_nd took 10068.668387 ms
Thread ID: 2, set_cpu took 0.067102 ms
Threads took 10088.799284 ms
MSYNC 27382015120 TOOK 36.678990 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400e20200000, curr_checkpoint is 0x400e20200000
1, 2
Parall_iter 0, Write new metadata at address 0x400e20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 35, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e20280000, curr_pr_arr is 0x400e20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e20280000!
Thread ID: 1, savenvm_thread_nd took 9797.117114 ms
Thread ID: 1, set_cpu took 0.082686 ms
Threads took 9817.786685 ms
MSYNC 27382015120 TOOK 21.027257 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400e20180000, curr_checkpoint is 0x400e20180000
0, 3
Parall_iter 1, Write new metadata at address 0x400e20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 77, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401480410000, curr_pr_arr is 0x401480410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401480410000!
Thread ID: 2, savenvm_thread_nd took 9846.387606 ms
Thread ID: 2, set_cpu took 0.075646 ms
Threads took 9868.487342 ms
MSYNC 27382015120 TOOK 20.870364 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400e20200000, curr_checkpoint is 0x400e20200000
1, 4
Parall_iter 0, Write new metadata at address 0x400e20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 97, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e20280000, curr_pr_arr is 0x400e20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e20280000!
Thread ID: 1, savenvm_thread_nd took 9864.185805 ms
Thread ID: 1, set_cpu took 0.067102 ms
Threads took 9884.357629 ms
MSYNC 27382015120 TOOK 30.883767 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400e20180000, curr_checkpoint is 0x400e20180000
0, 5
Parall_iter 1, Write new metadata at address 0x400e20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 121, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401480410000, curr_pr_arr is 0x401480410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401480410000!
Thread ID: 2, savenvm_thread_nd took 9847.781294 ms
Thread ID: 2, set_cpu took 0.071294 ms
Threads took 9848.014504 ms
MSYNC 27382015120 TOOK 32.416393 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400e20200000, curr_checkpoint is 0x400e20200000
1, 6
Parall_iter 0, Write new metadata at address 0x400e20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 32, parall_iter is 0, num_threads is 1, last counter is 6, curr_counter is 7
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e20280000, curr_pr_arr is 0x400e20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e20280000!
Thread ID: 1, savenvm_thread_nd took 9942.704272 ms
Thread ID: 1, set_cpu took 0.056926 ms
Threads took 9963.365426 ms
MSYNC 27382015120 TOOK 20.518599 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x400e20180000, curr_checkpoint is 0x400e20180000
0, 7
Parall_iter 1, Write new metadata at address 0x400e20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 52, parall_iter is 1, num_threads is 1, last counter is 7, curr_counter is 8
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401480410000, curr_pr_arr is 0x401480410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401480410000!
Thread ID: 2, savenvm_thread_nd took 9990.201056 ms
Thread ID: 2, set_cpu took 0.074974 ms
Threads took 9990.402586 ms
MSYNC 27382015120 TOOK 20.531174 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x400e20200000, curr_checkpoint is 0x400e20200000
1, 8
Parall_iter 0, Write new metadata at address 0x400e20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 55, parall_iter is 0, num_threads is 1, last counter is 8, curr_counter is 9
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e20280000, curr_pr_arr is 0x400e20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e20280000!
Thread ID: 1, savenvm_thread_nd took 10100.324036 ms
Thread ID: 1, set_cpu took 0.072030 ms
Threads took 10120.968488 ms
MSYNC 27382015120 TOOK 24.576687 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x400e20180000, curr_checkpoint is 0x400e20180000
0, 9
Parall_iter 1, Write new metadata at address 0x400e20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNewtotal_size: 6845503780, bsize: 6845503780, ratio: 2.0
6845503780 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 190.1249885559082 ms
CPU copy took 10015.96999168396 ms
---------------------- [PERF] Single Checkpoint time is 10.226017713546753 sec, average is 10.226014375686646
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 193.48502159118652 ms
CPU copy took 10153.440952301025 ms
---------------------- [PERF] Single Checkpoint time is 10.34750771522522 sec, average is 10.286759734153748
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 211.73429489135742 ms
CPU copy took 9859.742403030396 ms
---------------------- [PERF] Single Checkpoint time is 10.071864366531372 sec, average is 10.226014375686646
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 192.19112396240234 ms
CPU copy took 9894.811630249023 ms
---------------------- [PERF] Single Checkpoint time is 10.087926626205444 sec, average is 10.156970024108887
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 193.56012344360352 ms
CPU copy took 9941.963911056519 ms
---------------------- [PERF] Single Checkpoint time is 10.136361598968506 sec, average is 10.136358737945557
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 211.6844654083252 ms
CPU copy took 9911.00025177002 ms
---------------------- [PERF] Single Checkpoint time is 10.12343955039978 sec, average is 10.12989854812622
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 217.5447940826416 ms
CPU copy took 10003.899097442627 ms
---------------------- [PERF] Single Checkpoint time is 10.222054719924927 sec, average is 10.136358737945557
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 208.08005332946777 ms
CPU copy took 10036.710023880005 ms
---------------------- [PERF] Single Checkpoint time is 10.245676755905151 sec, average is 10.179206132888794
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 202.5010585784912 ms
CPU copy took 10170.019149780273 ms
---------------------- [PERF] Single Checkpoint time is 10.373372077941895 sec, average is 10.222053527832031
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 193.2969093322754 ms
CPU copy took 10247.41506576538 ms
---------------------- [PERF] Single Checkpoint time is 10.441139698028564 sec, average is 10.224033951759338
---- exit
, tid is 100, parall_iter is 1, num_threads is 1, last counter is 9, curr_counter is 10
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401480410000, curr_pr_arr is 0x401480410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401480410000!
Thread ID: 2, savenvm_thread_nd took 10199.439338 ms
Thread ID: 2, set_cpu took 0.068542 ms
Threads took 10199.686948 ms
MSYNC 27382015120 TOOK 46.687208 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x400e20200000, curr_checkpoint is 0x400e20200000
1, 10
2025-05-22 20:55:32,392 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
==== PCCHECK END ====
Benchmarking complete.
