==== RUNNING BASELINE FOR 1024 WITH fp32 ====
2025-05-22 21:22:50,802 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_1024/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 21:22:50,803 - root - INFO - Setting up DataLoaders...
2025-05-22 21:22:51,945 - root - INFO - Setting up Model...
2025-05-22 21:22:58,602 - root - INFO - Starting training!
2025-05-22 21:23:02,026 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 299.24 | Training tokens per second (%): 77.54 | MFU (%): 0.12 | TFLOPs: 1.24
2025-05-22 21:23:02,830 - root - INFO - Step: 5 | Loss: 11.88 | Tokens per second: 5109.69 | Training tokens per second (%): 40.14 | MFU (%): 2.13 | TFLOPs: 21.09
2025-05-22 21:23:03,386 - root - INFO - Step: 10 | Loss: 11.77 | Tokens per second: 9268.77 | Training tokens per second (%): 83.77 | MFU (%): 3.87 | TFLOPs: 38.26
2025-05-22 21:23:03,945 - root - INFO - Step: 15 | Loss: 11.39 | Tokens per second: 9213.93 | Training tokens per second (%): 57.17 | MFU (%): 3.85 | TFLOPs: 38.03
2025-05-22 21:23:04,502 - root - INFO - Step: 20 | Loss: 11.16 | Tokens per second: 9237.62 | Training tokens per second (%): 75.68 | MFU (%): 3.86 | TFLOPs: 38.13
2025-05-22 21:23:09,523 - root - INFO - Checkpoint saved in 5.0210 seconds
2025-05-22 21:23:09,525 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:23:10,124 - root - INFO - Step: 25 | Loss: 10.91 | Tokens per second: 911.23 | Training tokens per second (%): 70.53 | MFU (%): 0.38 | TFLOPs: 3.76
2025-05-22 21:23:10,669 - root - INFO - Step: 30 | Loss: 10.38 | Tokens per second: 9431.91 | Training tokens per second (%): 68.73 | MFU (%): 3.94 | TFLOPs: 38.93
2025-05-22 21:23:11,209 - root - INFO - Step: 35 | Loss: 10.48 | Tokens per second: 9543.79 | Training tokens per second (%): 49.82 | MFU (%): 3.98 | TFLOPs: 39.39
2025-05-22 21:23:11,747 - root - INFO - Step: 40 | Loss: 10.70 | Tokens per second: 9568.96 | Training tokens per second (%): 39.80 | MFU (%): 3.99 | TFLOPs: 39.50
2025-05-22 21:23:16,756 - root - INFO - Checkpoint saved in 5.0090 seconds
2025-05-22 21:23:16,757 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:23:17,365 - root - INFO - Step: 45 | Loss: 10.09 | Tokens per second: 911.84 | Training tokens per second (%): 62.34 | MFU (%): 0.38 | TFLOPs: 3.76
2025-05-22 21:23:17,912 - root - INFO - Step: 50 | Loss: 10.19 | Tokens per second: 9413.07 | Training tokens per second (%): 40.70 | MFU (%): 3.93 | TFLOPs: 38.85
2025-05-22 21:23:18,458 - root - INFO - Step: 55 | Loss: 10.62 | Tokens per second: 9418.36 | Training tokens per second (%): 71.37 | MFU (%): 3.93 | TFLOPs: 38.88
2025-05-22 21:23:19,003 - root - INFO - Step: 60 | Loss: 10.21 | Tokens per second: 9446.12 | Training tokens per second (%): 79.02 | MFU (%): 3.94 | TFLOPs: 38.99
2025-05-22 21:23:23,805 - root - INFO - Checkpoint saved in 4.8017 seconds
2025-05-22 21:23:23,807 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:23:24,407 - root - INFO - Step: 65 | Loss: 10.43 | Tokens per second: 948.00 | Training tokens per second (%): 73.18 | MFU (%): 0.40 | TFLOPs: 3.91
2025-05-22 21:23:24,956 - root - INFO - Step: 70 | Loss: 10.13 | Tokens per second: 9370.87 | Training tokens per second (%): 44.98 | MFU (%): 3.91 | TFLOPs: 38.68
2025-05-22 21:23:25,497 - root - INFO - Step: 75 | Loss: 9.77 | Tokens per second: 9514.64 | Training tokens per second (%): 46.62 | MFU (%): 3.97 | TFLOPs: 39.27
2025-05-22 21:23:26,040 - root - INFO - Step: 80 | Loss: 9.82 | Tokens per second: 9486.98 | Training tokens per second (%): 57.97 | MFU (%): 3.96 | TFLOPs: 39.16
2025-05-22 21:23:30,848 - root - INFO - Checkpoint saved in 4.8077 seconds
2025-05-22 21:23:30,849 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:23:31,445 - root - INFO - Step: 85 | Loss: 10.02 | Tokens per second: 947.83 | Training tokens per second (%): 64.18 | MFU (%): 0.40 | TFLOPs: 3.91
2025-05-22 21:23:32,008 - root - INFO - Step: 90 | Loss: 9.72 | Tokens per second: 9138.44 | Training tokens per second (%): 93.67 | MFU (%): 3.81 | TFLOPs: 37.72
2025-05-22 21:23:32,571 - root - INFO - Step: 95 | Loss: 9.57 | Tokens per second: 9140.74 | Training tokens per second (%): 88.40 | MFU (%): 3.81 | TFLOPs: 37.73
2025-05-22 21:23:33,151 - root - INFO - Step: 100 | Loss: 9.60 | Tokens per second: 8879.86 | Training tokens per second (%): 100.00 | MFU (%): 3.71 | TFLOPs: 36.65
2025-05-22 21:23:37,961 - root - INFO - Checkpoint saved in 4.8106 seconds
2025-05-22 21:23:37,964 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:23:38,559 - root - INFO - Step: 105 | Loss: 9.71 | Tokens per second: 947.18 | Training tokens per second (%): 46.11 | MFU (%): 0.40 | TFLOPs: 3.91
2025-05-22 21:23:39,128 - root - INFO - Step: 110 | Loss: 9.80 | Tokens per second: 9052.25 | Training tokens per second (%): 43.05 | MFU (%): 3.78 | TFLOPs: 37.36
2025-05-22 21:23:39,666 - root - INFO - Step: 115 | Loss: 9.60 | Tokens per second: 9563.62 | Training tokens per second (%): 39.90 | MFU (%): 3.99 | TFLOPs: 39.47
2025-05-22 21:23:40,216 - root - INFO - Step: 120 | Loss: 9.42 | Tokens per second: 9363.37 | Training tokens per second (%): 66.80 | MFU (%): 3.91 | TFLOPs: 38.65
2025-05-22 21:23:45,017 - root - INFO - Checkpoint saved in 4.8012 seconds
2025-05-22 21:23:45,019 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:23:45,613 - root - INFO - Step: 125 | Loss: 9.76 | Tokens per second: 949.16 | Training tokens per second (%): 58.54 | MFU (%): 0.40 | TFLOPs: 3.92
2025-05-22 21:23:46,164 - root - INFO - Step: 130 | Loss: 9.75 | Tokens per second: 9336.17 | Training tokens per second (%): 42.27 | MFU (%): 3.90 | TFLOPs: 38.54
2025-05-22 21:23:46,708 - root - INFO - Step: 135 | Loss: 9.21 | Tokens per second: 9471.66 | Training tokens per second (%): 63.54 | MFU (%): 3.95 | TFLOPs: 39.10
2025-05-22 21:23:47,256 - root - INFO - Step: 140 | Loss: 9.29 | Tokens per second: 9381.29 | Training tokens per second (%): 45.02 | MFU (%): 3.92 | TFLOPs: 38.72
2025-05-22 21:23:52,055 - root - INFO - Checkpoint saved in 4.7982 seconds
2025-05-22 21:23:52,057 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:23:52,654 - root - INFO - Step: 145 | Loss: 8.96 | Tokens per second: 949.12 | Training tokens per second (%): 59.90 | MFU (%): 0.40 | TFLOPs: 3.92
2025-05-22 21:23:53,201 - root - INFO - Step: 150 | Loss: 9.42 | Tokens per second: 9410.18 | Training tokens per second (%): 67.87 | MFU (%): 3.93 | TFLOPs: 38.84
2025-05-22 21:23:53,755 - root - INFO - Step: 155 | Loss: 9.29 | Tokens per second: 9286.28 | Training tokens per second (%): 87.15 | MFU (%): 3.88 | TFLOPs: 38.33
2025-05-22 21:23:54,306 - root - INFO - Step: 160 | Loss: 8.70 | Tokens per second: 9348.67 | Training tokens per second (%): 64.86 | MFU (%): 3.90 | TFLOPs: 38.59
2025-05-22 21:23:59,118 - root - INFO - Checkpoint saved in 4.8115 seconds
2025-05-22 21:23:59,120 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:23:59,728 - root - INFO - Step: 165 | Loss: 8.94 | Tokens per second: 944.77 | Training tokens per second (%): 45.74 | MFU (%): 0.39 | TFLOPs: 3.90
2025-05-22 21:24:00,289 - root - INFO - Step: 170 | Loss: 9.24 | Tokens per second: 9170.55 | Training tokens per second (%): 78.38 | MFU (%): 3.83 | TFLOPs: 37.85
2025-05-22 21:24:00,831 - root - INFO - Step: 175 | Loss: 9.17 | Tokens per second: 9498.37 | Training tokens per second (%): 57.73 | MFU (%): 3.96 | TFLOPs: 39.21
2025-05-22 21:24:01,371 - root - INFO - Step: 180 | Loss: 8.85 | Tokens per second: 9532.85 | Training tokens per second (%): 58.32 | MFU (%): 3.98 | TFLOPs: 39.35
2025-05-22 21:24:06,179 - root - INFO - Checkpoint saved in 4.8074 seconds
2025-05-22 21:24:06,181 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:24:06,779 - root - INFO - Step: 185 | Loss: 9.23 | Tokens per second: 947.39 | Training tokens per second (%): 50.92 | MFU (%): 0.40 | TFLOPs: 3.91
2025-05-22 21:24:07,330 - root - INFO - Step: 190 | Loss: 8.84 | Tokens per second: 9337.06 | Training tokens per second (%): 62.42 | MFU (%): 3.90 | TFLOPs: 38.54
2025-05-22 21:24:07,899 - root - INFO - Step: 195 | Loss: 8.71 | Tokens per second: 9041.91 | Training tokens per second (%): 50.66 | MFU (%): 3.77 | TFLOPs: 37.32
2025-05-22 21:24:08,447 - root - INFO - Step: 200 | Loss: 9.07 | Tokens per second: 9403.28 | Training tokens per second (%): 52.85 | MFU (%): 3.92 | TFLOPs: 38.81
2025-05-22 21:24:13,239 - root - INFO - Checkpoint saved in 4.7917 seconds
2025-05-22 21:24:13,241 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:24:13,849 - root - INFO - Step: 205 | Loss: 8.34 | Tokens per second: 948.26 | Training tokens per second (%): 38.81 | MFU (%): 0.40 | TFLOPs: 3.91
2025-05-22 21:24:14,403 - root - INFO - Step: 210 | Loss: 8.65 | Tokens per second: 9290.43 | Training tokens per second (%): 67.71 | MFU (%): 3.88 | TFLOPs: 38.35
2025-05-22 21:24:14,951 - root - INFO - Step: 215 | Loss: 8.52 | Tokens per second: 9394.93 | Training tokens per second (%): 48.05 | MFU (%): 3.92 | TFLOPs: 38.78
2025-05-22 21:24:15,497 - root - INFO - Step: 220 | Loss: 8.75 | Tokens per second: 9430.23 | Training tokens per second (%): 47.36 | MFU (%): 3.94 | TFLOPs: 38.92
2025-05-22 21:24:20,305 - root - INFO - Checkpoint saved in 4.8079 seconds
2025-05-22 21:24:20,307 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:24:20,917 - root - INFO - Step: 225 | Loss: 8.38 | Tokens per second: 945.22 | Training tokens per second (%): 59.55 | MFU (%): 0.39 | TFLOPs: 3.90
2025-05-22 21:24:21,466 - root - INFO - Step: 230 | Loss: 8.25 | Tokens per second: 9366.21 | Training tokens per second (%): 25.08 | MFU (%): 3.91 | TFLOPs: 38.66
2025-05-22 21:24:22,016 - root - INFO - Step: 235 | Loss: 8.53 | Tokens per second: 9357.90 | Training tokens per second (%): 43.71 | MFU (%): 3.91 | TFLOPs: 38.63
2025-05-22 21:24:22,566 - root - INFO - Step: 240 | Loss: 8.33 | Tokens per second: 9358.58 | Training tokens per second (%): 71.23 | MFU (%): 3.91 | TFLOPs: 38.63
2025-05-22 21:24:27,365 - root - INFO - Checkpoint saved in 4.7990 seconds
2025-05-22 21:24:27,367 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:24:27,972 - root - INFO - Step: 245 | Loss: 8.39 | Tokens per second: 947.64 | Training tokens per second (%): 58.46 | MFU (%): 0.40 | TFLOPs: 3.91
2025-05-22 21:24:28,534 - root - INFO - Step: 250 | Loss: 8.54 | Tokens per second: 9164.72 | Training tokens per second (%): 53.71 | MFU (%): 3.82 | TFLOPs: 37.83
2025-05-22 21:24:29,083 - root - INFO - Step: 255 | Loss: 9.02 | Tokens per second: 9370.86 | Training tokens per second (%): 42.27 | MFU (%): 3.91 | TFLOPs: 38.68
2025-05-22 21:24:29,639 - root - INFO - Step: 260 | Loss: 9.25 | Tokens per second: 9265.56 | Training tokens per second (%): 60.08 | MFU (%): 3.87 | TFLOPs: 38.24
2025-05-22 21:24:34,432 - root - INFO - Checkpoint saved in 4.7930 seconds
2025-05-22 21:24:34,434 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:24:35,023 - root - INFO - Step: 265 | Loss: 8.47 | Tokens per second: 951.45 | Training tokens per second (%): 50.68 | MFU (%): 0.40 | TFLOPs: 3.93
2025-05-22 21:24:35,574 - root - INFO - Step: 270 | Loss: 8.31 | Tokens per second: 9335.46 | Training tokens per second (%): 68.73 | MFU (%): 3.90 | TFLOPs: 38.53
2025-05-22 21:24:36,123 - root - INFO - Step: 275 | Loss: 8.55 | Tokens per second: 9374.59 | Training tokens per second (%): 47.05 | MFU (%): 3.91 | TFLOPs: 38.69
2025-05-22 21:24:36,679 - root - INFO - Step: 280 | Loss: 8.11 | Tokens per second: 9260.38 | Training tokens per second (%): 65.78 | MFU (%): 3.86 | TFLOPs: 38.22
2025-05-22 21:24:41,474 - root - INFO - Checkpoint saved in 4.7946 seconds
2025-05-22 21:24:41,476 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:24:42,080 - root - INFO - Step: 285 | Loss: 8.56 | Tokens per second: 948.56 | Training tokens per second (%): 73.09 | MFU (%): 0.40 | TFLOPs: 3.92
2025-05-22 21:24:42,629 - root - INFO - Step: 290 | Loss: 8.14 | Tokens per second: 9379.47 | Training tokens per second (%): 54.63 | MFU (%): 3.91 | TFLOPs: 38.71
2025-05-22 21:24:43,175 - root - INFO - Step: 295 | Loss: 7.91 | Tokens per second: 9422.37 | Training tokens per second (%): 44.59 | MFU (%): 3.93 | TFLOPs: 38.89
2025-05-22 21:24:43,743 - root - INFO - Step: 300 | Loss: 7.98 | Tokens per second: 9064.36 | Training tokens per second (%): 83.14 | MFU (%): 3.78 | TFLOPs: 37.41
2025-05-22 21:24:48,541 - root - INFO - Checkpoint saved in 4.7977 seconds
2025-05-22 21:24:48,543 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:24:49,147 - root - INFO - Step: 305 | Loss: 8.81 | Tokens per second: 947.99 | Training tokens per second (%): 64.26 | MFU (%): 0.40 | TFLOPs: 3.91
2025-05-22 21:24:49,698 - root - INFO - Step: 310 | Loss: 8.46 | Tokens per second: 9339.23 | Training tokens per second (%): 58.93 | MFU (%): 3.90 | TFLOPs: 38.55
2025-05-22 21:24:50,251 - root - INFO - Step: 315 | Loss: 7.74 | Tokens per second: 9299.97 | Training tokens per second (%): 64.43 | MFU (%): 3.88 | TFLOPs: 38.39
2025-05-22 21:24:50,806 - root - INFO - Step: 320 | Loss: 8.35 | Tokens per second: 9281.06 | Training tokens per second (%): 73.79 | MFU (%): 3.87 | TFLOPs: 38.31
2025-05-22 21:24:55,611 - root - INFO - Checkpoint saved in 4.8048 seconds
2025-05-22 21:24:55,613 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:24:56,218 - root - INFO - Step: 325 | Loss: 8.13 | Tokens per second: 946.50 | Training tokens per second (%): 49.69 | MFU (%): 0.40 | TFLOPs: 3.91
2025-05-22 21:24:56,772 - root - INFO - Step: 330 | Loss: 7.10 | Tokens per second: 9288.21 | Training tokens per second (%): 60.96 | MFU (%): 3.88 | TFLOPs: 38.34
2025-05-22 21:24:57,316 - root - INFO - Step: 335 | Loss: 8.48 | Tokens per second: 9473.69 | Training tokens per second (%): 24.41 | MFU (%): 3.95 | TFLOPs: 39.10
2025-05-22 21:24:57,867 - root - INFO - Step: 340 | Loss: 8.33 | Tokens per second: 9333.06 | Training tokens per second (%): 59.49 | MFU (%): 3.90 | TFLOPs: 38.52
2025-05-22 21:25:02,669 - root - INFO - Checkpoint saved in 4.8015 seconds
2025-05-22 21:25:02,671 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:25:03,279 - root - INFO - Step: 345 | Loss: 8.23 | Tokens per second: 946.65 | Training tokens per second (%): 63.32 | MFU (%): 0.40 | TFLOPs: 3.91
2025-05-22 21:25:03,829 - root - INFO - Step: 350 | Loss: 8.22 | Tokens per second: 9360.06 | Training tokens per second (%): 62.03 | MFU (%): 3.91 | TFLOPs: 38.63
2025-05-22 21:25:04,378 - root - INFO - Step: 355 | Loss: 8.13 | Tokens per second: 9371.37 | Training tokens per second (%): 36.93 | MFU (%): 3.91 | TFLOPs: 38.68
2025-05-22 21:25:04,925 - root - INFO - Step: 360 | Loss: 7.73 | Tokens per second: 9404.13 | Training tokens per second (%): 72.48 | MFU (%): 3.92 | TFLOPs: 38.82
2025-05-22 21:25:09,727 - root - INFO - Checkpoint saved in 4.8011 seconds
2025-05-22 21:25:09,729 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:25:10,333 - root - INFO - Step: 365 | Loss: 7.91 | Tokens per second: 947.27 | Training tokens per second (%): 82.03 | MFU (%): 0.40 | TFLOPs: 3.91
2025-05-22 21:25:10,881 - root - INFO - Step: 370 | Loss: 7.59 | Tokens per second: 9393.65 | Training tokens per second (%): 70.29 | MFU (%): 3.92 | TFLOPs: 38.77
2025-05-22 21:25:11,446 - root - INFO - Step: 375 | Loss: 8.38 | Tokens per second: 9111.09 | Training tokens per second (%): 91.58 | MFU (%): 3.80 | TFLOPs: 37.61
2025-05-22 21:25:12,018 - root - INFO - Step: 380 | Loss: 7.42 | Tokens per second: 8994.14 | Training tokens per second (%): 66.46 | MFU (%): 3.75 | TFLOPs: 37.12
2025-05-22 21:25:16,816 - root - INFO - Checkpoint saved in 4.7978 seconds
2025-05-22 21:25:16,819 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:25:17,386 - root - INFO - Step: 385 | Loss: 7.79 | Tokens per second: 954.42 | Training tokens per second (%): 48.44 | MFU (%): 0.40 | TFLOPs: 3.94
2025-05-22 21:25:17,953 - root - INFO - Step: 390 | Loss: 7.59 | Tokens per second: 9072.93 | Training tokens per second (%): 63.48 | MFU (%): 3.79 | TFLOPs: 37.45
2025-05-22 21:25:18,522 - root - INFO - Step: 395 | Loss: 7.94 | Tokens per second: 9048.38 | Training tokens per second (%): 73.14 | MFU (%): 3.78 | TFLOPs: 37.35
2025-05-22 21:25:19,091 - root - INFO - Step: 400 | Loss: 7.72 | Tokens per second: 9053.99 | Training tokens per second (%): 53.57 | MFU (%): 3.78 | TFLOPs: 37.37
2025-05-22 21:25:23,881 - root - INFO - Checkpoint saved in 4.7907 seconds
2025-05-22 21:25:23,883 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:25:23,883 - root - INFO - Training completed
Baseline duration: 158 s
==== BASELINE END ====
==== RUNNING PCCHECK FOR 1024 WITH fp32 ====
2025-05-22 21:25:28,310 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_1024/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 21:25:28,312 - root - INFO - Setting up DataLoaders...
2025-05-22 21:25:29,300 - root - INFO - Setting up Model...
Model size: 755041280, Optimizer size: 1510082852, Total size: 2265124132
BSIZE IS 2265124132
At checkpoint, bsize is 2265124132
2025-05-22 21:25:41,605 - root - INFO - Checkpointing warmup done
2025-05-22 21:25:41,606 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-22 21:25:41,911 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 3392.78 | Training tokens per second (%): 77.54 | MFU (%): 1.42 | TFLOPs: 14.00
2025-05-22 21:25:42,358 - root - INFO - Step: 5 | Loss: 11.89 | Tokens per second: 9227.51 | Training tokens per second (%): 40.14 | MFU (%): 3.85 | TFLOPs: 38.09
2025-05-22 21:25:42,913 - root - INFO - Step: 10 | Loss: 11.78 | Tokens per second: 9273.10 | Training tokens per second (%): 83.77 | MFU (%): 3.87 | TFLOPs: 38.28
2025-05-22 21:25:43,484 - root - INFO - Step: 15 | Loss: 11.40 | Tokens per second: 9020.07 | Training tokens per second (%): 57.17 | MFU (%): 3.76 | TFLOPs: 37.23
2025-05-22 21:25:44,043 - root - INFO - Step: 20 | Loss: 11.17 | Tokens per second: 9197.93 | Training tokens per second (%): 75.68 | MFU (%): 3.84 | TFLOPs: 37.97
2025-05-22 21:25:44,060 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:25:44,062 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:25:44,686 - root - INFO - Step: 25 | Loss: 10.91 | Tokens per second: 8005.75 | Training tokens per second (%): 70.53 | MFU (%): 3.34 | TFLOPs: 33.04
2025-05-22 21:25:45,301 - root - INFO - Step: 30 | Loss: 10.38 | Tokens per second: 8357.29 | Training tokens per second (%): 68.73 | MFU (%): 3.49 | TFLOPs: 34.50
2025-05-22 21:25:45,909 - root - INFO - Step: 35 | Loss: 10.48 | Tokens per second: 8464.54 | Training tokens per second (%): 49.82 | MFU (%): 3.53 | TFLOPs: 34.94
2025-05-22 21:25:46,519 - root - INFO - Step: 40 | Loss: 10.70 | Tokens per second: 8429.51 | Training tokens per second (%): 39.80 | MFU (%): 3.52 | TFLOPs: 34.79
2025-05-22 21:25:46,537 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:25:46,539 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:25:48,300 - root - INFO - Step: 45 | Loss: 10.09 | Tokens per second: 2879.71 | Training tokens per second (%): 62.34 | MFU (%): 1.20 | TFLOPs: 11.89
2025-05-22 21:25:48,897 - root - INFO - Step: 50 | Loss: 10.18 | Tokens per second: 8623.77 | Training tokens per second (%): 40.70 | MFU (%): 3.60 | TFLOPs: 35.60
2025-05-22 21:25:49,518 - root - INFO - Step: 55 | Loss: 10.62 | Tokens per second: 8283.54 | Training tokens per second (%): 71.37 | MFU (%): 3.46 | TFLOPs: 34.19
2025-05-22 21:25:50,123 - root - INFO - Step: 60 | Loss: 10.20 | Tokens per second: 8498.79 | Training tokens per second (%): 79.02 | MFU (%): 3.55 | TFLOPs: 35.08
2025-05-22 21:25:50,141 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:25:50,142 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:25:52,197 - root - INFO - Step: 65 | Loss: 10.42 | Tokens per second: 2473.29 | Training tokens per second (%): 73.18 | MFU (%): 1.03 | TFLOPs: 10.21
2025-05-22 21:25:52,764 - root - INFO - Step: 70 | Loss: 10.13 | Tokens per second: 9076.27 | Training tokens per second (%): 44.98 | MFU (%): 3.79 | TFLOPs: 37.46
2025-05-22 21:25:53,350 - root - INFO - Step: 75 | Loss: 9.77 | Tokens per second: 8784.49 | Training tokens per second (%): 46.62 | MFU (%): 3.67 | TFLOPs: 36.26
2025-05-22 21:25:53,902 - root - INFO - Step: 80 | Loss: 9.82 | Tokens per second: 9315.87 | Training tokens per second (%): 57.97 | MFU (%): 3.89 | TFLOPs: 38.45
2025-05-22 21:25:53,919 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:25:53,921 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:25:54,849 - root - INFO - Step: 85 | Loss: 10.01 | Tokens per second: 5425.87 | Training tokens per second (%): 64.18 | MFU (%): 2.26 | TFLOPs: 22.40
2025-05-22 21:25:55,441 - root - INFO - Step: 90 | Loss: 9.72 | Tokens per second: 8684.79 | Training tokens per second (%): 93.67 | MFU (%): 3.62 | TFLOPs: 35.85
2025-05-22 21:25:56,035 - root - INFO - Step: 95 | Loss: 9.56 | Tokens per second: 8668.40 | Training tokens per second (%): 88.40 | MFU (%): 3.62 | TFLOPs: 35.78
2025-05-22 21:25:56,654 - root - INFO - Step: 100 | Loss: 9.59 | Tokens per second: 8313.34 | Training tokens per second (%): 100.00 | MFU (%): 3.47 | TFLOPs: 34.31
2025-05-22 21:25:56,672 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:25:56,673 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:25:57,629 - root - INFO - Step: 105 | Loss: 9.71 | Tokens per second: 5267.06 | Training tokens per second (%): 46.11 | MFU (%): 2.20 | TFLOPs: 21.74
2025-05-22 21:25:58,227 - root - INFO - Step: 110 | Loss: 9.80 | Tokens per second: 8611.48 | Training tokens per second (%): 43.05 | MFU (%): 3.59 | TFLOPs: 35.54
2025-05-22 21:25:58,802 - root - INFO - Step: 115 | Loss: 9.60 | Tokens per second: 8943.22 | Training tokens per second (%): 39.90 | MFU (%): 3.73 | TFLOPs: 36.91
2025-05-22 21:25:59,383 - root - INFO - Step: 120 | Loss: 9.41 | Tokens per second: 8866.29 | Training tokens per second (%): 66.80 | MFU (%): 3.70 | TFLOPs: 36.60
2025-05-22 21:25:59,401 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:25:59,402 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:00,455 - root - INFO - Step: 125 | Loss: 9.76 | Tokens per second: 4788.69 | Training tokens per second (%): 58.54 | MFU (%): 2.00 | TFLOPs: 19.77
2025-05-22 21:26:01,034 - root - INFO - Step: 130 | Loss: 9.75 | Tokens per second: 8896.91 | Training tokens per second (%): 42.27 | MFU (%): 3.71 | TFLOPs: 36.72
2025-05-22 21:26:01,610 - root - INFO - Step: 135 | Loss: 9.20 | Tokens per second: 8923.12 | Training tokens per second (%): 63.54 | MFU (%): 3.72 | TFLOPs: 36.83
2025-05-22 21:26:02,184 - root - INFO - Step: 140 | Loss: 9.28 | Tokens per second: 8967.74 | Training tokens per second (%): 45.02 | MFU (%): 3.74 | TFLOPs: 37.02
2025-05-22 21:26:02,202 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:02,203 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:03,254 - root - INFO - Step: 145 | Loss: 8.96 | Tokens per second: 4800.42 | Training tokens per second (%): 59.90 | MFU (%): 2.00 | TFLOPs: 19.81
2025-05-22 21:26:03,829 - root - INFO - Step: 150 | Loss: 9.42 | Tokens per second: 8947.31 | Training tokens per second (%): 67.87 | MFU (%): 3.73 | TFLOPs: 36.93
2025-05-22 21:26:04,413 - root - INFO - Step: 155 | Loss: 9.29 | Tokens per second: 8818.68 | Training tokens per second (%): 87.15 | MFU (%): 3.68 | TFLOPs: 36.40
2025-05-22 21:26:04,990 - root - INFO - Step: 160 | Loss: 8.70 | Tokens per second: 8912.34 | Training tokens per second (%): 64.86 | MFU (%): 3.72 | TFLOPs: 36.79
2025-05-22 21:26:05,007 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:05,009 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:06,101 - root - INFO - Step: 165 | Loss: 8.93 | Tokens per second: 4624.36 | Training tokens per second (%): 45.74 | MFU (%): 1.93 | TFLOPs: 19.09
2025-05-22 21:26:06,692 - root - INFO - Step: 170 | Loss: 9.24 | Tokens per second: 8705.83 | Training tokens per second (%): 78.38 | MFU (%): 3.63 | TFLOPs: 35.93
2025-05-22 21:26:07,275 - root - INFO - Step: 175 | Loss: 9.16 | Tokens per second: 8822.15 | Training tokens per second (%): 57.73 | MFU (%): 3.68 | TFLOPs: 36.41
2025-05-22 21:26:07,852 - root - INFO - Step: 180 | Loss: 8.84 | Tokens per second: 8916.18 | Training tokens per second (%): 58.32 | MFU (%): 3.72 | TFLOPs: 36.80
2025-05-22 21:26:07,871 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:07,872 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:08,846 - root - INFO - Step: 185 | Loss: 9.23 | Tokens per second: 5171.10 | Training tokens per second (%): 50.92 | MFU (%): 2.16 | TFLOPs: 21.34
2025-05-22 21:26:09,420 - root - INFO - Step: 190 | Loss: 8.84 | Tokens per second: 8953.67 | Training tokens per second (%): 62.42 | MFU (%): 3.74 | TFLOPs: 36.96
2025-05-22 21:26:10,000 - root - INFO - Step: 195 | Loss: 8.70 | Tokens per second: 8880.59 | Training tokens per second (%): 50.66 | MFU (%): 3.71 | TFLOPs: 36.66
2025-05-22 21:26:10,569 - root - INFO - Step: 200 | Loss: 9.06 | Tokens per second: 9040.67 | Training tokens per second (%): 52.85 | MFU (%): 3.77 | TFLOPs: 37.32
2025-05-22 21:26:10,587 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:10,589 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x400800280000, PR_ADDR is 0x400800000000, PEER_CHECK_ADDR is 0x400800080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 2265124132
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 117, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 3496.660232 ms
Thread ID: 1, set_cpu took 0.075806 ms
Threads took 3517.426596 ms
MSYNC 9060496528 TOOK 29.698709 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 1
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 120, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 3791.436151 ms
Thread ID: 2, set_cpu took 0.075966 ms
Threads took 3811.631044 ms
MSYNC 9060496528 TOOK 43.063820 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 2
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 14, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2542.898329 ms
Thread ID: 1, set_cpu took 0.079838 ms
Threads took 2565.605083 ms
MSYNC 9060496528 TOOK 20.052592 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 3
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 17, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2662.917575 ms
Thread ID: 2, set_cpu took 0.057406 ms
Threads took 2687.680589 ms
MSYNC 9060496528 TOOK 15.057348 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 4
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 41, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2711.145369 ms
Thread ID: 1, set_cpu took 0.071134 ms
Threads took 2731.295752 ms
MSYNC 9060496528 TOOK 15.634291 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 5
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 44, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2702.791760 ms
Thread ID: 2, set_cpu took 0.056575 ms
Threads took 2724.091771 ms
MSYNC 9060496528 TOOK 15.395354 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 6
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 49, parall_iter is 0, num_threads is 1, last counter is 6, curr_counter is 7
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2710.660231 ms
Thread ID: 1, set_cpu took 0.063326 ms
Threads took 2730.799638 ms
MSYNC 9060496528 TOOK 16.483290 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 7
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 52, parall_iter is 1, num_threads is 1, last counter is 7, curr_counter is 8
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2661.495504 ms
Thread ID: 2, set_cpu took 0.055742 ms
Threads took 2682.772446 ms
MSYNC 9060496528 TOOK 18.707098 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 8
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 84, parall_iter is 0, num_threads is 1, last counter is 8, curr_counter is 9
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2689.004294 ms
Thread ID: 1, set_cpu took 0.057694 ms
Threads took 2709.148755 ms
MSYNC 9060496528 TOOK 16.101093 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 9
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 87,2025-05-22 21:26:11,648 - root - INFO - Step: 205 | Loss: 8.34 | Tokens per second: 4760.86 | Training tokens per second (%): 38.81 | MFU (%): 1.99 | TFLOPs: 19.65
2025-05-22 21:26:12,228 - root - INFO - Step: 210 | Loss: 8.65 | Tokens per second: 8874.71 | Training tokens per second (%): 67.71 | MFU (%): 3.70 | TFLOPs: 36.63
2025-05-22 21:26:12,801 - root - INFO - Step: 215 | Loss: 8.51 | Tokens per second: 8980.48 | Training tokens per second (%): 48.05 | MFU (%): 3.75 | TFLOPs: 37.07
2025-05-22 21:26:13,374 - root - INFO - Step: 220 | Loss: 8.75 | Tokens per second: 8974.94 | Training tokens per second (%): 47.36 | MFU (%): 3.75 | TFLOPs: 37.04
2025-05-22 21:26:13,392 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:13,393 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:14,481 - root - INFO - Step: 225 | Loss: 8.37 | Tokens per second: 4637.71 | Training tokens per second (%): 59.55 | MFU (%): 1.94 | TFLOPs: 19.14
2025-05-22 21:26:15,054 - root - INFO - Step: 230 | Loss: 8.24 | Tokens per second: 8984.36 | Training tokens per second (%): 25.08 | MFU (%): 3.75 | TFLOPs: 37.08
2025-05-22 21:26:15,629 - root - INFO - Step: 235 | Loss: 8.52 | Tokens per second: 8959.40 | Training tokens per second (%): 43.71 | MFU (%): 3.74 | TFLOPs: 36.98
2025-05-22 21:26:16,209 - root - INFO - Step: 240 | Loss: 8.32 | Tokens per second: 8873.07 | Training tokens per second (%): 71.23 | MFU (%): 3.70 | TFLOPs: 36.62
2025-05-22 21:26:16,226 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:16,228 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:17,369 - root - INFO - Step: 245 | Loss: 8.39 | Tokens per second: 4422.77 | Training tokens per second (%): 58.46 | MFU (%): 1.85 | TFLOPs: 18.26
2025-05-22 21:26:17,979 - root - INFO - Step: 250 | Loss: 8.53 | Tokens per second: 8448.45 | Training tokens per second (%): 53.71 | MFU (%): 3.53 | TFLOPs: 34.87
2025-05-22 21:26:18,567 - root - INFO - Step: 255 | Loss: 9.02 | Tokens per second: 8745.54 | Training tokens per second (%): 42.27 | MFU (%): 3.65 | TFLOPs: 36.10
2025-05-22 21:26:19,165 - root - INFO - Step: 260 | Loss: 9.25 | Tokens per second: 8607.12 | Training tokens per second (%): 60.08 | MFU (%): 3.59 | TFLOPs: 35.53
2025-05-22 21:26:19,183 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:19,184 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:20,175 - root - INFO - Step: 265 | Loss: 8.46 | Tokens per second: 5083.24 | Training tokens per second (%): 50.68 | MFU (%): 2.12 | TFLOPs: 20.98
2025-05-22 21:26:20,768 - root - INFO - Step: 270 | Loss: 8.30 | Tokens per second: 8673.74 | Training tokens per second (%): 68.73 | MFU (%): 3.62 | TFLOPs: 35.80
2025-05-22 21:26:21,362 - root - INFO - Step: 275 | Loss: 8.55 | Tokens per second: 8675.02 | Training tokens per second (%): 47.05 | MFU (%): 3.62 | TFLOPs: 35.81
2025-05-22 21:26:21,956 - root - INFO - Step: 280 | Loss: 8.10 | Tokens per second: 8654.39 | Training tokens per second (%): 65.78 | MFU (%): 3.61 | TFLOPs: 35.72
2025-05-22 21:26:21,974 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:21,976 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:22,995 - root - INFO - Step: 285 | Loss: 8.55 | Tokens per second: 4944.81 | Training tokens per second (%): 73.09 | MFU (%): 2.06 | TFLOPs: 20.41
2025-05-22 21:26:23,586 - root - INFO - Step: 290 | Loss: 8.13 | Tokens per second: 8700.28 | Training tokens per second (%): 54.63 | MFU (%): 3.63 | TFLOPs: 35.91
2025-05-22 21:26:24,177 - root - INFO - Step: 295 | Loss: 7.91 | Tokens per second: 8714.99 | Training tokens per second (%): 44.59 | MFU (%): 3.64 | TFLOPs: 35.97
2025-05-22 21:26:24,774 - root - INFO - Step: 300 | Loss: 7.97 | Tokens per second: 8616.35 | Training tokens per second (%): 83.14 | MFU (%): 3.60 | TFLOPs: 35.56
2025-05-22 21:26:24,791 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:24,793 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:25,771 - root - INFO - Step: 305 | Loss: 8.81 | Tokens per second: 5152.88 | Training tokens per second (%): 64.26 | MFU (%): 2.15 | TFLOPs: 21.27
2025-05-22 21:26:26,358 - root - INFO - Step: 310 | Loss: 8.46 | Tokens per second: 8771.46 | Training tokens per second (%): 58.93 | MFU (%): 3.66 | TFLOPs: 36.21
2025-05-22 21:26:26,949 - root - INFO - Step: 315 | Loss: 7.73 | Tokens per second: 8695.00 | Training tokens per second (%): 64.43 | MFU (%): 3.63 | TFLOPs: 35.89
2025-05-22 21:26:27,543 - root - INFO - Step: 320 | Loss: 8.34 | Tokens per second: 8671.74 | Training tokens per second (%): 73.79 | MFU (%): 3.62 | TFLOPs: 35.79
2025-05-22 21:26:27,560 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:27,562 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:28,625 - root - INFO - Step: 325 | Loss: 8.13 | Tokens per second: 4744.83 | Training tokens per second (%): 49.69 | MFU (%): 1.98 | TFLOPs: 19.58
2025-05-22 21:26:29,216 - root - INFO - Step: 330 | Loss: 7.10 | Tokens per second: 8708.19 | Training tokens per second (%): 60.96 | MFU (%): 3.63 | TFLOPs: 35.94
2025-05-22 21:26:29,798 - root - INFO - Step: 335 | Loss: 8.48 | Tokens per second: 8837.25 | Training tokens per second (%): 24.41 | MFU (%): 3.69 | TFLOPs: 36.48
2025-05-22 21:26:30,380 - root - INFO - Step: 340 | Loss: 8.32 | Tokens per second: 8848.86 | Training tokens per second (%): 59.49 | MFU (%): 3.69 | TFLOPs: 36.52
2025-05-22 21:26:30,398 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:30,400 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:31,455 - root - INFO - Step: 345 | Loss: 8.22 | Tokens per second: 4775.07 | Training tokens per second (%): 63.32 | MFU (%): 1.99 | TFLOPs: 19.71
2025-05-22 21:26:32,041 - root - INFO - Step: 350 | Loss: 8.22 | Tokens per second: 8778.82 | Training tokens per second (%): 62.03 | MFU (%): 3.66 | TFLOPs: 36.24
2025-05-22 21:26:32,623 - root - INFO - Step: 355 | Loss: 8.13 | Tokens per second: 8856.75 | Training tokens per second (%): 36.93 | MFU (%): 3.70 | TFLOPs: 36.56
2025-05-22 21:26:33,210 - root - INFO - Step: 360 | Loss: 7.73 | Tokens per second: 8760.70 | Training tokens per second (%): 72.48 | MFU (%): 3.66 | TFLOPs: 36.16
2025-05-22 21:26:33,227 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:33,229 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:34,280 - root - INFO - Step: 365 | Loss: 7.91 | Tokens per second: 4796.77 | Training tokens per second (%): 82.03 | MFU (%): 2.00 | TFLOPs: 19.80
2025-05-22 21:26:34,861 - root - INFO - Step: 370 | Loss: 7.58 | Tokens per second: 8865.15 | Training tokens per second (%): 70.29 | MFU (%): 3.70 | TFLOPs: 36.59
2025-05-22 21:26:35,457 - root - INFO - Step: 375 | Loss: 8.37 | Tokens per second: 8633.27 | Training tokens per second (%): 91.58 | MFU (%): 3.60 | TFLOPs: 35.63
2025-05-22 21:26:36,065 - root - INFO - Step: 380 | Loss: 7.41 | Tokens per second: 8462.02 | Training tokens per second (%): 66.46 | MFU (%): 3.53 | TFLOPs: 34.93
2025-05-22 21:26:36,083 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:36,084 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:26:37,065 - root - INFO - Step: 385 | Loss: 7.78 | Tokens per second: 5137.85 | Training tokens per second (%): 48.44 | MFU (%): 2.14 | TFLOPs: 21.21
2025-05-22 21:26:37,653 - root - INFO - Step: 390 | Loss: 7.59 | Tokens per second: 8745.99 | Training tokens per second (%): 63.48 | MFU (%): 3.65 | TFLOPs: 36.10
2025-05-22 21:26:38,238 - root - INFO - Step: 395 | Loss: 7.94 | Tokens per second: 8797.09 | Training tokens per second (%): 73.14 | MFU (%): 3.67 | TFLOPs: 36.31
2025-05-22 21:26:38,829 - root - INFO - Step: 400 | Loss: 7.72 | Tokens per second: 8701.32 | Training tokens per second (%): 53.57 | MFU (%): 3.63 | TFLOPs: 35.92
2025-05-22 21:26:38,847 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:26:38,848 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
 parall_iter is 1, num_threads is 1, last counter is 9, curr_counter is 10
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2725.681036 ms
Thread ID: 2, set_cpu took 0.064895 ms
Threads took 2749.308244 ms
MSYNC 9060496528 TOOK 22.579175 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 10
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 91, parall_iter is 0, num_threads is 1, last counter is 10, curr_counter is 11
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2751.964486 ms
Thread ID: 1, set_cpu took 0.051039 ms
Threads took 2772.097941 ms
MSYNC 9060496528 TOOK 21.734560 ms
CAS was successful! new counter is 11, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 11
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 95, parall_iter is 1, num_threads is 1, last counter is 11, curr_counter is 12
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2699.031325 ms
Thread ID: 2, set_cpu took 0.055455 ms
Threads took 2722.782082 ms
MSYNC 9060496528 TOOK 16.437180 ms
CAS was successful! new counter is 12, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 12
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 10, parall_iter is 0, num_threads is 1, last counter is 12, curr_counter is 13
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2711.143289 ms
Thread ID: 1, set_cpu took 0.062719 ms
Threads took 2733.309356 ms
MSYNC 9060496528 TOOK 21.049396 ms
CAS was successful! new counter is 13, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 13
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 13, parall_iter is 1, num_threads is 1, last counter is 13, curr_counter is 14
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2681.328200 ms
Thread ID: 2, set_cpu took 0.053950 ms
Threads took 2703.268193 ms
MSYNC 9060496528 TOOK 16.416541 ms
CAS was successful! new counter is 14, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 14
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 19, parall_iter is 0, num_threads is 1, last counter is 14, curr_counter is 15
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2741.705076 ms
Thread ID: 1, set_cpu took 0.060223 ms
Threads took 2772.126483 ms
MSYNC 9060496528 TOOK 19.163020 ms
CAS was successful! new counter is 15, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 15
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 24, parall_iter is 1, num_threads is 1, last counter is 15, curr_counter is 16
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2705.135115 ms
Thread ID: 2, set_cpu took 0.061023 ms
Threads took 2725.264857 ms
MSYNC 9060496528 TOOK 20.452132 ms
CAS was successful! new counter is 16, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 16
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 49, parall_iter is 0, num_threads is 1, last counter is 16, curr_counter is 17
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, savenvm_thread_nd took 2710.850365 ms
Thread ID: 1, set_cpu took 0.058270 ms
Threads took 2730.990411 ms
MSYNC 9060496528 TOOK 19.028144 ms
CAS was successful! new counter is 17, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 17
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 52, parall_iter is 1, num_threads is 1, last counter is 17, curr_counter is 18
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2664.019944 ms
Thread ID: 2, set_cpu took 0.063262 ms
Threads took 2684.163702 ms
MSYNC 9060496528 TOOK 17.706711 ms
CAS was successful! new counter is 18, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 18
Parall_iter 0, Write new metadata at address 0x400800180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 55, parall_iter is 0, num_threads is 1, last counter is 18, curr_counter is 19
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400800280000, curr_pr_arr is 0x400800280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400800280000!
Thread ID: 1, satotal_size: 2265124132, bsize: 2265124132, ratio: 2.0
2265124132 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 54.07834053039551 ms
CPU copy took 3552.665948867798 ms
---------------------- [PERF] Single Checkpoint time is 3.6270267963409424 sec, average is 3.627023696899414
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 57.07144737243652 ms
CPU copy took 3879.6868324279785 ms
---------------------- [PERF] Single Checkpoint time is 3.9371602535247803 sec, average is 3.782090902328491
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 56.00881576538086 ms
CPU copy took 2591.0844802856445 ms
---------------------- [PERF] Single Checkpoint time is 2.6475415229797363 sec, average is 3.627023696899414
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 55.904388427734375 ms
CPU copy took 2708.1563472747803 ms
---------------------- [PERF] Single Checkpoint time is 2.7644336223602295 sec, average is 3.1957281827926636
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 56.292057037353516 ms
CPU copy took 2771.5606689453125 ms
---------------------- [PERF] Single Checkpoint time is 2.8282699584960938 sec, average is 2.828268527984619
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 55.3593635559082 ms
CPU copy took 2744.8861598968506 ms
---------------------- [PERF] Single Checkpoint time is 2.8005659580230713 sec, average is 2.8144168853759766
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 56.282997131347656 ms
CPU copy took 2771.7010974884033 ms
---------------------- [PERF] Single Checkpoint time is 2.8283894062042236 sec, average is 2.828268527984619
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 55.31001091003418 ms
CPU copy took 2706.897974014282 ms
---------------------- [PERF] Single Checkpoint time is 2.762472629547119 sec, average is 2.8144168853759766
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 56.12039566040039 ms
CPU copy took 2747.7574348449707 ms
---------------------- [PERF] Single Checkpoint time is 2.8041536808013916 sec, average is 2.804151773452759
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 54.9163818359375 ms
CPU copy took 2777.3234844207764 ms
---------------------- [PERF] Single Checkpoint time is 2.832533597946167 sec, average is 2.816210150718689
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 56.91170692443848 ms
CPU copy took 2817.5675868988037 ms
---------------------- [PERF] Single Checkpoint time is 2.8748743534088135 sec, average is 2.828268527984619
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 56.113243103027344 ms
CPU copy took 2744.624614715576 ms
---------------------- [PERF] Single Checkpoint time is 2.80107045173645 sec, average is 2.816210150718689
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 55.98044395446777 ms
CPU copy took 2759.7575187683105 ms
---------------------- [PERF] Single Checkpoint time is 2.8160338401794434 sec, average is 2.816032886505127
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 58.908939361572266 ms
CPU copy took 2725.104808807373 ms
---------------------- [PERF] Single Checkpoint time is 2.7844038009643555 sec, average is 2.810092329978943
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 55.593013763427734 ms
CPU copy took 2796.7028617858887 ms
---------------------- [PERF] Single Checkpoint time is 2.852555990219116 sec, average is 2.816032886505127
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 56.76102638244629 ms
CPU copy took 2766.9200897216797 ms
---------------------- [PERF] Single Checkpoint time is 2.824192523956299 sec, average is 2.8201123476028442
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.211015701293945 ms
CPU copy took 2773.902416229248 ms
---------------------- [PERF] Single Checkpoint time is 2.833698272705078 sec, average is 2.8241918087005615
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 57.62839317321777 ms
CPU copy took 2723.0541706085205 ms
---------------------- [PERF] Single Checkpoint time is 2.7812697887420654 sec, average is 2.8201123476028442
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 56.37216567993164 ms
CPU copy took 2752.7332305908203 ms
---------------------- [PERF] Single Checkpoint time is 2.809422016143799 sec, average is 2.816032886505127
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 53.74741554260254 ms
CPU copy took 2678.2915592193604 ms
---------------------- [PERF] Single Checkpoint time is 2.732327461242676 sec, average is 2.812727212905884
---- exit
venvm_thread_nd took 2681.444391 ms
Thread ID: 1, set_cpu took 0.060574 ms
Threads took 2701.608502 ms
MSYNC 9060496528 TOOK 30.228710 ms
CAS was successful! new counter is 19, is_distributed is 0
******** checkp_info saved in 0x400800180000, curr_checkpoint is 0x400800180000
0, 19
Parall_iter 1, Write new metadata at address 0x400800200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 58, parall_iter is 1, num_threads is 1, last counter is 19, curr_counter is 20
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400a1c350000, curr_pr_arr is 0x400a1c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400a1c350000!
Thread ID: 2, savenvm_thread_nd took 2662.820684 ms
Thread ID: 2, set_cpu took 0.062303 ms
Threads took 2663.023654 ms
MSYNC 9060496528 TOOK 14.907369 ms
CAS was successful! new counter is 20, is_distributed is 0
******** checkp_info saved in 0x400800200000, curr_checkpoint is 0x400800200000
1, 20
2025-05-22 21:26:42,947 - root - INFO - Training completed
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
PCCHECK duration: 78 s
==== PCCHECK END ====
---- Total for fp32 / 1024: 236 s ----

==== RUNNING BASELINE FOR 2048 WITH fp32 ====
2025-05-22 21:26:46,542 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_2048/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 21:26:46,543 - root - INFO - Setting up DataLoaders...
2025-05-22 21:26:47,707 - root - INFO - Setting up Model...
2025-05-22 21:26:59,501 - root - INFO - Starting training!
2025-05-22 21:27:00,095 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 3497.75 | Training tokens per second (%): 38.77 | MFU (%): 4.84 | TFLOPs: 47.89
2025-05-22 21:27:01,145 - root - INFO - Step: 5 | Loss: 11.84 | Tokens per second: 7894.44 | Training tokens per second (%): 22.83 | MFU (%): 10.93 | TFLOPs: 108.08
2025-05-22 21:27:02,468 - root - INFO - Step: 10 | Loss: 11.61 | Tokens per second: 7847.44 | Training tokens per second (%): 51.44 | MFU (%): 10.86 | TFLOPs: 107.44
2025-05-22 21:27:03,884 - root - INFO - Step: 15 | Loss: 10.76 | Tokens per second: 7295.45 | Training tokens per second (%): 48.58 | MFU (%): 10.10 | TFLOPs: 99.88
2025-05-22 21:27:05,212 - root - INFO - Step: 20 | Loss: 10.43 | Tokens per second: 7782.73 | Training tokens per second (%): 49.55 | MFU (%): 10.77 | TFLOPs: 106.55
2025-05-22 21:27:29,917 - root - INFO - Checkpoint saved in 24.7051 seconds
2025-05-22 21:27:29,921 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:27:31,237 - root - INFO - Step: 25 | Loss: 10.21 | Tokens per second: 393.68 | Training tokens per second (%): 36.56 | MFU (%): 0.54 | TFLOPs: 5.39
2025-05-22 21:27:32,560 - root - INFO - Step: 30 | Loss: 9.54 | Tokens per second: 7827.39 | Training tokens per second (%): 50.15 | MFU (%): 10.84 | TFLOPs: 107.16
2025-05-22 21:27:33,866 - root - INFO - Step: 35 | Loss: 9.74 | Tokens per second: 7926.05 | Training tokens per second (%): 27.57 | MFU (%): 10.97 | TFLOPs: 108.52
2025-05-22 21:27:35,166 - root - INFO - Step: 40 | Loss: 9.91 | Tokens per second: 7963.03 | Training tokens per second (%): 19.90 | MFU (%): 11.02 | TFLOPs: 109.02
2025-05-22 21:27:59,801 - root - INFO - Checkpoint saved in 24.6343 seconds
2025-05-22 21:27:59,803 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:28:01,138 - root - INFO - Step: 45 | Loss: 9.43 | Tokens per second: 394.47 | Training tokens per second (%): 31.17 | MFU (%): 0.55 | TFLOPs: 5.40
2025-05-22 21:28:02,431 - root - INFO - Step: 50 | Loss: 9.49 | Tokens per second: 8000.98 | Training tokens per second (%): 21.87 | MFU (%): 11.08 | TFLOPs: 109.54
2025-05-22 21:28:03,756 - root - INFO - Step: 55 | Loss: 9.86 | Tokens per second: 7821.00 | Training tokens per second (%): 54.01 | MFU (%): 10.83 | TFLOPs: 107.08
2025-05-22 21:28:05,071 - root - INFO - Step: 60 | Loss: 9.46 | Tokens per second: 7873.17 | Training tokens per second (%): 49.63 | MFU (%): 10.90 | TFLOPs: 107.79
2025-05-22 21:28:29,766 - root - INFO - Checkpoint saved in 24.6954 seconds
2025-05-22 21:28:29,768 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:28:31,094 - root - INFO - Step: 65 | Loss: 9.69 | Tokens per second: 393.70 | Training tokens per second (%): 48.10 | MFU (%): 0.55 | TFLOPs: 5.39
2025-05-22 21:28:32,407 - root - INFO - Step: 70 | Loss: 9.37 | Tokens per second: 7886.70 | Training tokens per second (%): 32.49 | MFU (%): 10.92 | TFLOPs: 107.98
2025-05-22 21:28:33,731 - root - INFO - Step: 75 | Loss: 9.10 | Tokens per second: 7820.14 | Training tokens per second (%): 33.31 | MFU (%): 10.83 | TFLOPs: 107.07
2025-05-22 21:28:35,046 - root - INFO - Step: 80 | Loss: 9.09 | Tokens per second: 7879.08 | Training tokens per second (%): 34.72 | MFU (%): 10.91 | TFLOPs: 107.87
2025-05-22 21:28:59,703 - root - INFO - Checkpoint saved in 24.6569 seconds
2025-05-22 21:28:59,705 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:29:01,027 - root - INFO - Step: 85 | Loss: 9.16 | Tokens per second: 394.36 | Training tokens per second (%): 32.09 | MFU (%): 0.55 | TFLOPs: 5.40
2025-05-22 21:29:02,390 - root - INFO - Step: 90 | Loss: 8.64 | Tokens per second: 7586.60 | Training tokens per second (%): 76.84 | MFU (%): 10.50 | TFLOPs: 103.87
2025-05-22 21:29:03,735 - root - INFO - Step: 95 | Loss: 8.43 | Tokens per second: 7694.08 | Training tokens per second (%): 76.98 | MFU (%): 10.65 | TFLOPs: 105.34
2025-05-22 21:29:05,106 - root - INFO - Step: 100 | Loss: 8.63 | Tokens per second: 7539.06 | Training tokens per second (%): 100.00 | MFU (%): 10.44 | TFLOPs: 103.22
2025-05-22 21:29:29,827 - root - INFO - Checkpoint saved in 24.7208 seconds
2025-05-22 21:29:29,829 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:29:31,152 - root - INFO - Step: 105 | Loss: 8.70 | Tokens per second: 393.34 | Training tokens per second (%): 33.06 | MFU (%): 0.54 | TFLOPs: 5.39
2025-05-22 21:29:32,465 - root - INFO - Step: 110 | Loss: 8.91 | Tokens per second: 7879.16 | Training tokens per second (%): 31.52 | MFU (%): 10.91 | TFLOPs: 107.87
2025-05-22 21:29:33,765 - root - INFO - Step: 115 | Loss: 8.52 | Tokens per second: 7953.41 | Training tokens per second (%): 19.95 | MFU (%): 11.01 | TFLOPs: 108.89
2025-05-22 21:29:35,094 - root - INFO - Step: 120 | Loss: 8.55 | Tokens per second: 7779.95 | Training tokens per second (%): 47.53 | MFU (%): 10.77 | TFLOPs: 106.52
2025-05-22 21:29:59,896 - root - INFO - Checkpoint saved in 24.8012 seconds
2025-05-22 21:29:59,898 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:30:01,216 - root - INFO - Step: 125 | Loss: 8.77 | Tokens per second: 392.19 | Training tokens per second (%): 39.27 | MFU (%): 0.54 | TFLOPs: 5.37
2025-05-22 21:30:02,531 - root - INFO - Step: 130 | Loss: 9.07 | Tokens per second: 7857.80 | Training tokens per second (%): 31.13 | MFU (%): 10.88 | TFLOPs: 107.58
2025-05-22 21:30:03,846 - root - INFO - Step: 135 | Loss: 8.31 | Tokens per second: 7855.45 | Training tokens per second (%): 43.91 | MFU (%): 10.87 | TFLOPs: 107.55
2025-05-22 21:30:05,164 - root - INFO - Step: 140 | Loss: 8.14 | Tokens per second: 7847.27 | Training tokens per second (%): 23.79 | MFU (%): 10.86 | TFLOPs: 107.44
2025-05-22 21:30:29,999 - root - INFO - Checkpoint saved in 24.8347 seconds
2025-05-22 21:30:30,001 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:30:31,329 - root - INFO - Step: 145 | Loss: 8.13 | Tokens per second: 391.53 | Training tokens per second (%): 40.89 | MFU (%): 0.54 | TFLOPs: 5.36
2025-05-22 21:30:32,635 - root - INFO - Step: 150 | Loss: 8.41 | Tokens per second: 7921.88 | Training tokens per second (%): 39.48 | MFU (%): 10.97 | TFLOPs: 108.46
2025-05-22 21:30:33,967 - root - INFO - Step: 155 | Loss: 8.25 | Tokens per second: 7763.93 | Training tokens per second (%): 59.66 | MFU (%): 10.75 | TFLOPs: 106.30
2025-05-22 21:30:35,285 - root - INFO - Step: 160 | Loss: 7.57 | Tokens per second: 7845.91 | Training tokens per second (%): 42.43 | MFU (%): 10.86 | TFLOPs: 107.42
2025-05-22 21:30:59,973 - root - INFO - Checkpoint saved in 24.6883 seconds
2025-05-22 21:30:59,976 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:31:01,313 - root - INFO - Step: 165 | Loss: 7.89 | Tokens per second: 393.62 | Training tokens per second (%): 32.87 | MFU (%): 0.54 | TFLOPs: 5.39
2025-05-22 21:31:02,646 - root - INFO - Step: 170 | Loss: 8.34 | Tokens per second: 7749.18 | Training tokens per second (%): 58.68 | MFU (%): 10.73 | TFLOPs: 106.09
2025-05-22 21:31:03,965 - root - INFO - Step: 175 | Loss: 8.05 | Tokens per second: 7848.04 | Training tokens per second (%): 39.18 | MFU (%): 10.86 | TFLOPs: 107.45
2025-05-22 21:31:05,266 - root - INFO - Step: 180 | Loss: 7.73 | Tokens per second: 7942.63 | Training tokens per second (%): 29.38 | MFU (%): 11.00 | TFLOPs: 108.74
2025-05-22 21:31:30,074 - root - INFO - Checkpoint saved in 24.8083 seconds
2025-05-22 21:31:30,078 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:31:31,408 - root - INFO - Step: 185 | Loss: 8.21 | Tokens per second: 391.88 | Training tokens per second (%): 27.41 | MFU (%): 0.54 | TFLOPs: 5.37
2025-05-22 21:31:32,720 - root - INFO - Step: 190 | Loss: 7.69 | Tokens per second: 7874.01 | Training tokens per second (%): 41.21 | MFU (%): 10.90 | TFLOPs: 107.80
2025-05-22 21:31:34,052 - root - INFO - Step: 195 | Loss: 7.95 | Tokens per second: 7755.22 | Training tokens per second (%): 45.33 | MFU (%): 10.74 | TFLOPs: 106.18
2025-05-22 21:31:35,374 - root - INFO - Step: 200 | Loss: 8.18 | Tokens per second: 7824.35 | Training tokens per second (%): 33.85 | MFU (%): 10.83 | TFLOPs: 107.12
2025-05-22 21:32:00,080 - root - INFO - Checkpoint saved in 24.7063 seconds
2025-05-22 21:32:00,087 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:32:01,412 - root - INFO - Step: 205 | Loss: 7.23 | Tokens per second: 393.43 | Training tokens per second (%): 19.40 | MFU (%): 0.54 | TFLOPs: 5.39
2025-05-22 21:32:02,715 - root - INFO - Step: 210 | Loss: 7.87 | Tokens per second: 7927.96 | Training tokens per second (%): 38.69 | MFU (%): 10.97 | TFLOPs: 108.54
2025-05-22 21:32:04,020 - root - INFO - Step: 215 | Loss: 7.60 | Tokens per second: 7919.81 | Training tokens per second (%): 24.02 | MFU (%): 10.96 | TFLOPs: 108.43
2025-05-22 21:32:05,329 - root - INFO - Step: 220 | Loss: 7.87 | Tokens per second: 7891.34 | Training tokens per second (%): 24.01 | MFU (%): 10.92 | TFLOPs: 108.04
2025-05-22 21:32:30,162 - root - INFO - Checkpoint saved in 24.8334 seconds
2025-05-22 21:32:30,165 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:32:31,490 - root - INFO - Step: 225 | Loss: 7.53 | Tokens per second: 391.61 | Training tokens per second (%): 40.32 | MFU (%): 0.54 | TFLOPs: 5.36
2025-05-22 21:32:32,789 - root - INFO - Step: 230 | Loss: 7.39 | Tokens per second: 7963.28 | Training tokens per second (%): 12.54 | MFU (%): 11.02 | TFLOPs: 109.03
2025-05-22 21:32:34,103 - root - INFO - Step: 235 | Loss: 7.77 | Tokens per second: 7866.83 | Training tokens per second (%): 27.69 | MFU (%): 10.89 | TFLOPs: 107.70
2025-05-22 21:32:35,423 - root - INFO - Step: 240 | Loss: 7.31 | Tokens per second: 7830.30 | Training tokens per second (%): 45.88 | MFU (%): 10.84 | TFLOPs: 107.20
2025-05-22 21:33:00,090 - root - INFO - Checkpoint saved in 24.6659 seconds
2025-05-22 21:33:00,092 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:33:01,435 - root - INFO - Step: 245 | Loss: 7.56 | Tokens per second: 393.85 | Training tokens per second (%): 43.83 | MFU (%): 0.55 | TFLOPs: 5.39
2025-05-22 21:33:02,769 - root - INFO - Step: 250 | Loss: 7.66 | Tokens per second: 7757.52 | Training tokens per second (%): 46.86 | MFU (%): 10.74 | TFLOPs: 106.21
2025-05-22 21:33:04,076 - root - INFO - Step: 255 | Loss: 8.36 | Tokens per second: 7905.07 | Training tokens per second (%): 22.31 | MFU (%): 10.94 | TFLOPs: 108.23
2025-05-22 21:33:05,390 - root - INFO - Step: 260 | Loss: 8.63 | Tokens per second: 7872.60 | Training tokens per second (%): 40.04 | MFU (%): 10.90 | TFLOPs: 107.78
2025-05-22 21:33:30,238 - root - INFO - Checkpoint saved in 24.8473 seconds
2025-05-22 21:33:30,241 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:33:31,560 - root - INFO - Step: 265 | Loss: 7.60 | Tokens per second: 391.47 | Training tokens per second (%): 25.34 | MFU (%): 0.54 | TFLOPs: 5.36
2025-05-22 21:33:32,865 - root - INFO - Step: 270 | Loss: 7.50 | Tokens per second: 7927.44 | Training tokens per second (%): 34.54 | MFU (%): 10.97 | TFLOPs: 108.53
2025-05-22 21:33:34,176 - root - INFO - Step: 275 | Loss: 7.64 | Tokens per second: 7895.57 | Training tokens per second (%): 26.43 | MFU (%): 10.93 | TFLOPs: 108.10
2025-05-22 21:33:35,504 - root - INFO - Step: 280 | Loss: 7.22 | Tokens per second: 7778.44 | Training tokens per second (%): 45.45 | MFU (%): 10.77 | TFLOPs: 106.49
2025-05-22 21:34:00,325 - root - INFO - Checkpoint saved in 24.8205 seconds
2025-05-22 21:34:00,328 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:34:01,660 - root - INFO - Step: 285 | Loss: 7.86 | Tokens per second: 391.67 | Training tokens per second (%): 43.17 | MFU (%): 0.54 | TFLOPs: 5.36
2025-05-22 21:34:02,967 - root - INFO - Step: 290 | Loss: 7.22 | Tokens per second: 7910.79 | Training tokens per second (%): 27.31 | MFU (%): 10.95 | TFLOPs: 108.31
2025-05-22 21:34:04,263 - root - INFO - Step: 295 | Loss: 7.01 | Tokens per second: 7969.19 | Training tokens per second (%): 22.29 | MFU (%): 11.03 | TFLOPs: 109.11
2025-05-22 21:34:05,613 - root - INFO - Step: 300 | Loss: 7.03 | Tokens per second: 7654.36 | Training tokens per second (%): 81.27 | MFU (%): 10.60 | TFLOPs: 104.80
2025-05-22 21:34:30,449 - root - INFO - Checkpoint saved in 24.8358 seconds
2025-05-22 21:34:30,453 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:34:31,788 - root - INFO - Step: 305 | Loss: 8.35 | Tokens per second: 391.38 | Training tokens per second (%): 42.13 | MFU (%): 0.54 | TFLOPs: 5.36
2025-05-22 21:34:33,091 - root - INFO - Step: 310 | Loss: 7.85 | Tokens per second: 7935.30 | Training tokens per second (%): 31.69 | MFU (%): 10.99 | TFLOPs: 108.64
2025-05-22 21:34:34,415 - root - INFO - Step: 315 | Loss: 7.11 | Tokens per second: 7810.91 | Training tokens per second (%): 42.22 | MFU (%): 10.81 | TFLOPs: 106.94
2025-05-22 21:34:35,737 - root - INFO - Step: 320 | Loss: 7.86 | Tokens per second: 7823.11 | Training tokens per second (%): 49.90 | MFU (%): 10.83 | TFLOPs: 107.11
2025-05-22 21:35:00,391 - root - INFO - Checkpoint saved in 24.6541 seconds
2025-05-22 21:35:00,394 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:35:01,740 - root - INFO - Step: 325 | Loss: 7.39 | Tokens per second: 393.97 | Training tokens per second (%): 34.84 | MFU (%): 0.55 | TFLOPs: 5.39
2025-05-22 21:35:03,062 - root - INFO - Step: 330 | Loss: 6.65 | Tokens per second: 7806.27 | Training tokens per second (%): 45.21 | MFU (%): 10.81 | TFLOPs: 106.88
2025-05-22 21:35:04,358 - root - INFO - Step: 335 | Loss: 7.89 | Tokens per second: 7979.26 | Training tokens per second (%): 12.21 | MFU (%): 11.05 | TFLOPs: 109.24
2025-05-22 21:35:05,668 - root - INFO - Step: 340 | Loss: 7.67 | Tokens per second: 7889.45 | Training tokens per second (%): 33.55 | MFU (%): 10.92 | TFLOPs: 108.01
2025-05-22 21:35:30,417 - root - INFO - Checkpoint saved in 24.7481 seconds
2025-05-22 21:35:30,420 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:35:31,730 - root - INFO - Step: 345 | Loss: 7.65 | Tokens per second: 393.12 | Training tokens per second (%): 38.32 | MFU (%): 0.54 | TFLOPs: 5.38
2025-05-22 21:35:33,048 - root - INFO - Step: 350 | Loss: 7.65 | Tokens per second: 7847.11 | Training tokens per second (%): 38.50 | MFU (%): 10.86 | TFLOPs: 107.43
2025-05-22 21:35:34,357 - root - INFO - Step: 355 | Loss: 7.52 | Tokens per second: 7896.21 | Training tokens per second (%): 18.47 | MFU (%): 10.93 | TFLOPs: 108.11
2025-05-22 21:35:35,668 - root - INFO - Step: 360 | Loss: 7.19 | Tokens per second: 7893.87 | Training tokens per second (%): 50.04 | MFU (%): 10.93 | TFLOPs: 108.08
2025-05-22 21:36:00,416 - root - INFO - Checkpoint saved in 24.7482 seconds
2025-05-22 21:36:00,420 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:36:01,758 - root - INFO - Step: 365 | Loss: 7.22 | Tokens per second: 392.66 | Training tokens per second (%): 41.02 | MFU (%): 0.54 | TFLOPs: 5.38
2025-05-22 21:36:03,072 - root - INFO - Step: 370 | Loss: 6.79 | Tokens per second: 7876.08 | Training tokens per second (%): 35.15 | MFU (%): 10.90 | TFLOPs: 107.83
2025-05-22 21:36:04,424 - root - INFO - Step: 375 | Loss: 7.76 | Tokens per second: 7644.62 | Training tokens per second (%): 78.84 | MFU (%): 10.58 | TFLOPs: 104.66
2025-05-22 21:36:05,759 - root - INFO - Step: 380 | Loss: 6.59 | Tokens per second: 7750.46 | Training tokens per second (%): 49.27 | MFU (%): 10.73 | TFLOPs: 106.11
2025-05-22 21:36:30,492 - root - INFO - Checkpoint saved in 24.7332 seconds
2025-05-22 21:36:30,495 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:36:31,816 - root - INFO - Step: 385 | Loss: 7.13 | Tokens per second: 393.17 | Training tokens per second (%): 34.22 | MFU (%): 0.54 | TFLOPs: 5.38
2025-05-22 21:36:33,136 - root - INFO - Step: 390 | Loss: 7.00 | Tokens per second: 7854.17 | Training tokens per second (%): 41.74 | MFU (%): 10.87 | TFLOPs: 107.53
2025-05-22 21:36:34,461 - root - INFO - Step: 395 | Loss: 7.46 | Tokens per second: 7799.40 | Training tokens per second (%): 45.66 | MFU (%): 10.80 | TFLOPs: 106.78
2025-05-22 21:36:35,783 - root - INFO - Step: 400 | Loss: 7.03 | Tokens per second: 7821.49 | Training tokens per second (%): 36.79 | MFU (%): 10.83 | TFLOPs: 107.08
2025-05-22 21:37:00,633 - root - INFO - Checkpoint saved in 24.8498 seconds
2025-05-22 21:37:00,635 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:37:00,636 - root - INFO - Training completed
Baseline duration: 618 s
==== BASELINE END ====
==== RUNNING PCCHECK FOR 2048 WITH fp32 ====
2025-05-22 21:37:04,812 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='fp32', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/fp32/sl_2048/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 21:37:04,814 - root - INFO - Setting up DataLoaders...
2025-05-22 21:37:05,784 - root - INFO - Setting up Model...
Model size: 2281834496, Optimizer size: 4563669284, Total size: 6845503780
BSIZE IS 6845503780
At checkpoint, bsize is 6845503780
2025-05-22 21:37:26,308 - root - INFO - Checkpointing warmup done
2025-05-22 21:37:26,310 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-22 21:37:26,799 - root - INFO - Step: 1 | Loss: 11.91 | Tokens per second: 4272.00 | Training tokens per second (%): 38.77 | MFU (%): 5.91 | TFLOPs: 58.49
2025-05-22 21:37:27,847 - root - INFO - Step: 5 | Loss: 11.85 | Tokens per second: 7955.74 | Training tokens per second (%): 22.83 | MFU (%): 11.01 | TFLOPs: 108.92
2025-05-22 21:37:29,169 - root - INFO - Step: 10 | Loss: 11.62 | Tokens per second: 7863.16 | Training tokens per second (%): 51.44 | MFU (%): 10.89 | TFLOPs: 107.65
2025-05-22 21:37:30,503 - root - INFO - Step: 15 | Loss: 10.78 | Tokens per second: 7787.30 | Training tokens per second (%): 48.58 | MFU (%): 10.78 | TFLOPs: 106.62
2025-05-22 21:37:31,824 - root - INFO - Step: 20 | Loss: 10.44 | Tokens per second: 7861.32 | Training tokens per second (%): 49.55 | MFU (%): 10.88 | TFLOPs: 107.63
2025-05-22 21:37:31,849 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:37:31,850 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:37:33,225 - root - INFO - Step: 25 | Loss: 10.21 | Tokens per second: 7404.92 | Training tokens per second (%): 36.56 | MFU (%): 10.25 | TFLOPs: 101.38
2025-05-22 21:37:34,578 - root - INFO - Step: 30 | Loss: 9.54 | Tokens per second: 7676.71 | Training tokens per second (%): 50.15 | MFU (%): 10.63 | TFLOPs: 105.10
2025-05-22 21:37:35,923 - root - INFO - Step: 35 | Loss: 9.74 | Tokens per second: 7728.01 | Training tokens per second (%): 27.57 | MFU (%): 10.70 | TFLOPs: 105.80
2025-05-22 21:37:37,268 - root - INFO - Step: 40 | Loss: 9.91 | Tokens per second: 7723.21 | Training tokens per second (%): 19.90 | MFU (%): 10.69 | TFLOPs: 105.74
2025-05-22 21:37:37,294 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:37:37,295 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:37:43,628 - root - INFO - Step: 45 | Loss: 9.42 | Tokens per second: 1614.81 | Training tokens per second (%): 31.17 | MFU (%): 2.24 | TFLOPs: 22.11
2025-05-22 21:37:44,984 - root - INFO - Step: 50 | Loss: 9.49 | Tokens per second: 7648.20 | Training tokens per second (%): 21.87 | MFU (%): 10.59 | TFLOPs: 104.71
2025-05-22 21:37:46,362 - root - INFO - Step: 55 | Loss: 9.86 | Tokens per second: 7553.88 | Training tokens per second (%): 54.01 | MFU (%): 10.46 | TFLOPs: 103.42
2025-05-22 21:37:47,733 - root - INFO - Step: 60 | Loss: 9.46 | Tokens per second: 7563.14 | Training tokens per second (%): 49.63 | MFU (%): 10.47 | TFLOPs: 103.55
2025-05-22 21:37:47,758 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:37:47,760 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:37:54,364 - root - INFO - Step: 65 | Loss: 9.69 | Tokens per second: 1548.19 | Training tokens per second (%): 48.10 | MFU (%): 2.14 | TFLOPs: 21.20
2025-05-22 21:37:55,734 - root - INFO - Step: 70 | Loss: 9.37 | Tokens per second: 7573.35 | Training tokens per second (%): 32.49 | MFU (%): 10.48 | TFLOPs: 103.69
2025-05-22 21:37:57,101 - root - INFO - Step: 75 | Loss: 9.10 | Tokens per second: 7590.31 | Training tokens per second (%): 33.31 | MFU (%): 10.51 | TFLOPs: 103.92
2025-05-22 21:37:58,465 - root - INFO - Step: 80 | Loss: 9.09 | Tokens per second: 7599.15 | Training tokens per second (%): 34.72 | MFU (%): 10.52 | TFLOPs: 104.04
2025-05-22 21:37:58,491 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:37:58,493 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:38:04,600 - root - INFO - Step: 85 | Loss: 9.15 | Tokens per second: 1673.83 | Training tokens per second (%): 32.09 | MFU (%): 2.32 | TFLOPs: 22.92
2025-05-22 21:38:06,007 - root - INFO - Step: 90 | Loss: 8.64 | Tokens per second: 7364.51 | Training tokens per second (%): 76.84 | MFU (%): 10.19 | TFLOPs: 100.83
2025-05-22 21:38:07,403 - root - INFO - Step: 95 | Loss: 8.43 | Tokens per second: 7421.24 | Training tokens per second (%): 76.98 | MFU (%): 10.27 | TFLOPs: 101.60
2025-05-22 21:38:08,819 - root - INFO - Step: 100 | Loss: 8.62 | Tokens per second: 7321.46 | Training tokens per second (%): 100.00 | MFU (%): 10.14 | TFLOPs: 100.24
2025-05-22 21:38:08,846 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:38:08,847 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:38:14,779 - root - INFO - Step: 105 | Loss: 8.70 | Tokens per second: 1722.37 | Training tokens per second (%): 33.06 | MFU (%): 2.38 | TFLOPs: 23.58
2025-05-22 21:38:16,161 - root - INFO - Step: 110 | Loss: 8.91 | Tokens per second: 7493.01 | Training tokens per second (%): 31.52 | MFU (%): 10.37 | TFLOPs: 102.59
2025-05-22 21:38:17,543 - root - INFO - Step: 115 | Loss: 8.52 | Tokens per second: 7438.94 | Training tokens per second (%): 19.95 | MFU (%): 10.30 | TFLOPs: 101.85
2025-05-22 21:38:18,925 - root - INFO - Step: 120 | Loss: 8.55 | Tokens per second: 7500.55 | Training tokens per second (%): 47.53 | MFU (%): 10.38 | TFLOPs: 102.69
2025-05-22 21:38:18,951 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:38:18,954 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:38:24,868 - root - INFO - Step: 125 | Loss: 8.76 | Tokens per second: 1728.04 | Training tokens per second (%): 39.27 | MFU (%): 2.39 | TFLOPs: 23.66
2025-05-22 21:38:26,241 - root - INFO - Step: 130 | Loss: 9.07 | Tokens per second: 7555.88 | Training tokens per second (%): 31.13 | MFU (%): 10.46 | TFLOPs: 103.45
2025-05-22 21:38:27,613 - root - INFO - Step: 135 | Loss: 8.31 | Tokens per second: 7556.00 | Training tokens per second (%): 43.91 | MFU (%): 10.46 | TFLOPs: 103.45
2025-05-22 21:38:28,978 - root - INFO - Step: 140 | Loss: 8.13 | Tokens per second: 7594.45 | Training tokens per second (%): 23.79 | MFU (%): 10.51 | TFLOPs: 103.98
2025-05-22 21:38:29,005 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:38:29,007 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:38:35,115 - root - INFO - Step: 145 | Loss: 8.13 | Tokens per second: 1672.92 | Training tokens per second (%): 40.89 | MFU (%): 2.32 | TFLOPs: 22.90
2025-05-22 21:38:36,482 - root - INFO - Step: 150 | Loss: 8.40 | Tokens per second: 7584.36 | Training tokens per second (%): 39.48 | MFU (%): 10.50 | TFLOPs: 103.84
2025-05-22 21:38:37,869 - root - INFO - Step: 155 | Loss: 8.24 | Tokens per second: 7481.06 | Training tokens per second (%): 59.66 | MFU (%): 10.36 | TFLOPs: 102.42
2025-05-22 21:38:39,241 - root - INFO - Step: 160 | Loss: 7.57 | Tokens per second: 7554.13 | Training tokens per second (%): 42.43 | MFU (%): 10.46 | TFLOPs: 103.42
2025-05-22 21:38:39,268 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:38:39,270 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:38:45,302 - root - INFO - Step: 165 | Loss: 7.88 | Tokens per second: 1693.76 | Training tokens per second (%): 32.87 | MFU (%): 2.34 | TFLOPs: 23.19
2025-05-22 21:38:46,686 - root - INFO - Step: 170 | Loss: 8.33 | Tokens per second: 7498.05 | Training tokens per second (%): 58.68 | MFU (%): 10.38 | TFLOPs: 102.66
2025-05-22 21:38:48,058 - root - INFO - Step: 175 | Loss: 8.04 | Tokens per second: 7550.52 | Training tokens per second (%): 39.18 | MFU (%): 10.45 | TFLOPs: 103.37
2025-05-22 21:38:49,423 - root - INFO - Step: 180 | Loss: 7.72 | Tokens per second: 7587.91 | Training tokens per second (%): 29.38 | MFU (%): 10.50 | TFLOPs: 103.89
2025-05-22 21:38:49,449 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:38:49,451 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:38:55,622 - root - INFO - Step: 185 | Loss: 8.20 | Tokens per second: 1656.35 | Training tokens per second (%): 27.41 | MFU (%): 2.29 | TFLOPs: 22.68
2025-05-22 21:38:56,997 - root - INFO - Step: 190 | Loss: 7.69 | Tokens per second: 7534.94 | Training tokens per second (%): 41.21 | MFU (%): 10.43 | TFLOPs: 103.16
2025-05-22 21:38:58,379 - root - INFO - Step: 195 | Loss: 7.94 | Tokens per second: 7490.05 | Training tokens per second (%): 45.33 | MFU (%): 10.37 | TFLOPs: 102.55
2025-05-22 21:38:59,748 - root - INFO - Step: 200 | Loss: 8.18 | Tokens per second: 7577.46 | Training tokens per second (%): 33.85 | MFU (%): 10.49 | TFLOPs: 103.74
2025-05-22 21:38:59,774 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:38:59,775 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x400f20280000, PR_ADDR is 0x400f20000000, PEER_CHECK_ADDR is 0x400f20080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 6845503780
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 58, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 10095.709302 ms
Thread ID: 1, set_cpu took 0.078078 ms
Threads took 10115.505269 ms
MSYNC 27382015120 TOOK 28.854457 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 1
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 83, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 10443.418319 ms
Thread ID: 2, set_cpu took 0.069533 ms
Threads took 10464.108789 ms
MSYNC 27382015120 TOOK 26.904657 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 2
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 126, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 9934.687333 ms
Thread ID: 1, set_cpu took 0.080765 ms
Threads took 9954.871001 ms
MSYNC 27382015120 TOOK 30.465065 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 3
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 22, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 9906.649684 ms
Thread ID: 2, set_cpu took 0.071134 ms
Threads took 9926.794475 ms
MSYNC 27382015120 TOOK 21.326067 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 4
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 45, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 9840.659055 ms
Thread ID: 1, set_cpu took 0.068158 ms
Threads took 9840.889831 ms
MSYNC 27382015120 TOOK 17.904053 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 5
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 66, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 9975.462068 ms
Thread ID: 2, set_cpu took 0.080286 ms
Threads took 9975.708782 ms
MSYNC 27382015120 TOOK 27.649912 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 6
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 87, parall_iter is 0, num_threads is 1, last counter is 6, curr_counter is 7
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 9918.246589 ms
Thread ID: 1, set_cpu took 0.074398 ms
Threads took 9938.908322 ms
MSYNC 27382015120 TOOK 13.370746 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 7
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 111, parall_iter is 1, num_threads is 1, last counter is 7, curr_counter is 8
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 10066.716236 ms
Thread ID: 2, set_cpu took 0.075934 ms
Threads took 10086.890111 ms
MSYNC 27382015120 TOOK 24.197309 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 8
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 27, parall_iter is 0, num_threads is 1, last counter is 8, curr_counter is 9
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 10173.358593 ms
Thread ID: 1, set_cpu took 0.077213 ms
Threads took 10197.504928 ms
MSYNC 27382015120 TOOK 38.439774 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 9
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At saven2025-05-22 21:39:06,053 - root - INFO - Step: 205 | Loss: 7.22 | Tokens per second: 1628.61 | Training tokens per second (%): 19.40 | MFU (%): 2.25 | TFLOPs: 22.30
2025-05-22 21:39:07,421 - root - INFO - Step: 210 | Loss: 7.87 | Tokens per second: 7570.80 | Training tokens per second (%): 38.69 | MFU (%): 10.48 | TFLOPs: 103.65
2025-05-22 21:39:08,785 - root - INFO - Step: 215 | Loss: 7.60 | Tokens per second: 7607.90 | Training tokens per second (%): 24.02 | MFU (%): 10.53 | TFLOPs: 104.16
2025-05-22 21:39:10,146 - root - INFO - Step: 220 | Loss: 7.87 | Tokens per second: 7613.21 | Training tokens per second (%): 24.01 | MFU (%): 10.54 | TFLOPs: 104.23
2025-05-22 21:39:10,172 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:39:10,174 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:39:16,511 - root - INFO - Step: 225 | Loss: 7.53 | Tokens per second: 1612.64 | Training tokens per second (%): 40.32 | MFU (%): 2.23 | TFLOPs: 22.08
2025-05-22 21:39:17,871 - root - INFO - Step: 230 | Loss: 7.39 | Tokens per second: 7624.93 | Training tokens per second (%): 12.54 | MFU (%): 10.56 | TFLOPs: 104.39
2025-05-22 21:39:19,230 - root - INFO - Step: 235 | Loss: 7.77 | Tokens per second: 7631.41 | Training tokens per second (%): 27.69 | MFU (%): 10.56 | TFLOPs: 104.48
2025-05-22 21:39:20,602 - root - INFO - Step: 240 | Loss: 7.31 | Tokens per second: 7559.54 | Training tokens per second (%): 45.88 | MFU (%): 10.46 | TFLOPs: 103.50
2025-05-22 21:39:20,628 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:39:20,630 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:39:26,856 - root - INFO - Step: 245 | Loss: 7.55 | Tokens per second: 1641.54 | Training tokens per second (%): 43.83 | MFU (%): 2.27 | TFLOPs: 22.47
2025-05-22 21:39:28,238 - root - INFO - Step: 250 | Loss: 7.66 | Tokens per second: 7497.75 | Training tokens per second (%): 46.86 | MFU (%): 10.38 | TFLOPs: 102.65
2025-05-22 21:39:29,599 - root - INFO - Step: 255 | Loss: 8.36 | Tokens per second: 7620.18 | Training tokens per second (%): 22.31 | MFU (%): 10.55 | TFLOPs: 104.33
2025-05-22 21:39:30,976 - root - INFO - Step: 260 | Loss: 8.62 | Tokens per second: 7526.13 | Training tokens per second (%): 40.04 | MFU (%): 10.42 | TFLOPs: 103.04
2025-05-22 21:39:31,003 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:39:31,006 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:39:37,049 - root - INFO - Step: 265 | Loss: 7.59 | Tokens per second: 1690.50 | Training tokens per second (%): 25.34 | MFU (%): 2.34 | TFLOPs: 23.14
2025-05-22 21:39:38,410 - root - INFO - Step: 270 | Loss: 7.50 | Tokens per second: 7623.09 | Training tokens per second (%): 34.54 | MFU (%): 10.55 | TFLOPs: 104.37
2025-05-22 21:39:39,778 - root - INFO - Step: 275 | Loss: 7.63 | Tokens per second: 7567.39 | Training tokens per second (%): 26.43 | MFU (%): 10.48 | TFLOPs: 103.61
2025-05-22 21:39:41,159 - root - INFO - Step: 280 | Loss: 7.22 | Tokens per second: 7510.74 | Training tokens per second (%): 45.45 | MFU (%): 10.40 | TFLOPs: 102.83
2025-05-22 21:39:41,189 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:39:41,193 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:39:47,498 - root - INFO - Step: 285 | Loss: 7.86 | Tokens per second: 1619.69 | Training tokens per second (%): 43.17 | MFU (%): 2.24 | TFLOPs: 22.18
2025-05-22 21:39:48,863 - root - INFO - Step: 290 | Loss: 7.22 | Tokens per second: 7595.49 | Training tokens per second (%): 27.31 | MFU (%): 10.51 | TFLOPs: 103.99
2025-05-22 21:39:50,226 - root - INFO - Step: 295 | Loss: 7.01 | Tokens per second: 7606.79 | Training tokens per second (%): 22.29 | MFU (%): 10.53 | TFLOPs: 104.14
2025-05-22 21:39:51,629 - root - INFO - Step: 300 | Loss: 7.03 | Tokens per second: 7385.12 | Training tokens per second (%): 81.27 | MFU (%): 10.22 | TFLOPs: 101.11
2025-05-22 21:39:51,655 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:39:51,656 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:39:57,839 - root - INFO - Step: 305 | Loss: 8.35 | Tokens per second: 1653.75 | Training tokens per second (%): 42.13 | MFU (%): 2.29 | TFLOPs: 22.64
2025-05-22 21:39:59,205 - root - INFO - Step: 310 | Loss: 7.85 | Tokens per second: 7590.31 | Training tokens per second (%): 31.69 | MFU (%): 10.51 | TFLOPs: 103.92
2025-05-22 21:40:00,578 - root - INFO - Step: 315 | Loss: 7.11 | Tokens per second: 7553.94 | Training tokens per second (%): 42.22 | MFU (%): 10.46 | TFLOPs: 103.42
2025-05-22 21:40:01,957 - root - INFO - Step: 320 | Loss: 7.86 | Tokens per second: 7522.17 | Training tokens per second (%): 49.90 | MFU (%): 10.41 | TFLOPs: 102.99
2025-05-22 21:40:01,983 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:40:01,984 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:40:08,048 - root - INFO - Step: 325 | Loss: 7.39 | Tokens per second: 1685.35 | Training tokens per second (%): 34.84 | MFU (%): 2.33 | TFLOPs: 23.07
2025-05-22 21:40:09,424 - root - INFO - Step: 330 | Loss: 6.65 | Tokens per second: 7535.50 | Training tokens per second (%): 45.21 | MFU (%): 10.43 | TFLOPs: 103.17
2025-05-22 21:40:10,782 - root - INFO - Step: 335 | Loss: 7.89 | Tokens per second: 7638.57 | Training tokens per second (%): 12.21 | MFU (%): 10.57 | TFLOPs: 104.58
2025-05-22 21:40:12,150 - root - INFO - Step: 340 | Loss: 7.67 | Tokens per second: 7604.39 | Training tokens per second (%): 33.55 | MFU (%): 10.53 | TFLOPs: 104.11
2025-05-22 21:40:12,175 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:40:12,177 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:40:18,561 - root - INFO - Step: 345 | Loss: 7.65 | Tokens per second: 1601.35 | Training tokens per second (%): 38.32 | MFU (%): 2.22 | TFLOPs: 21.92
2025-05-22 21:40:19,930 - root - INFO - Step: 350 | Loss: 7.65 | Tokens per second: 7571.55 | Training tokens per second (%): 38.50 | MFU (%): 10.48 | TFLOPs: 103.66
2025-05-22 21:40:21,291 - root - INFO - Step: 355 | Loss: 7.52 | Tokens per second: 7623.84 | Training tokens per second (%): 18.47 | MFU (%): 10.55 | TFLOPs: 104.38
2025-05-22 21:40:22,668 - root - INFO - Step: 360 | Loss: 7.18 | Tokens per second: 7528.86 | Training tokens per second (%): 50.04 | MFU (%): 10.42 | TFLOPs: 103.08
2025-05-22 21:40:22,694 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:40:22,696 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:40:29,044 - root - INFO - Step: 365 | Loss: 7.22 | Tokens per second: 1609.83 | Training tokens per second (%): 41.02 | MFU (%): 2.23 | TFLOPs: 22.04
2025-05-22 21:40:30,391 - root - INFO - Step: 370 | Loss: 6.79 | Tokens per second: 7699.61 | Training tokens per second (%): 35.15 | MFU (%): 10.66 | TFLOPs: 105.42
2025-05-22 21:40:31,794 - root - INFO - Step: 375 | Loss: 7.76 | Tokens per second: 7393.60 | Training tokens per second (%): 78.84 | MFU (%): 10.24 | TFLOPs: 101.23
2025-05-22 21:40:33,191 - root - INFO - Step: 380 | Loss: 6.59 | Tokens per second: 7414.51 | Training tokens per second (%): 49.27 | MFU (%): 10.26 | TFLOPs: 101.51
2025-05-22 21:40:33,217 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:40:33,219 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
vmNew, tid is 51, parall_iter is 1, num_threads is 1, last counter is 9, curr_counter is 10
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 10171.380250 ms
Thread ID: 2, set_cpu took 0.083518 ms
Threads took 10195.548089 ms
MSYNC 27382015120 TOOK 44.435790 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 10
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 74, parall_iter is 0, num_threads is 1, last counter is 10, curr_counter is 11
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 10025.019981 ms
Thread ID: 1, set_cpu took 0.083870 ms
Threads took 10045.204672 ms
MSYNC 27382015120 TOOK 40.165899 ms
CAS was successful! new counter is 11, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 11
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 101, parall_iter is 1, num_threads is 1, last counter is 11, curr_counter is 12
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 9958.580600 ms
Thread ID: 2, set_cpu took 0.071902 ms
Threads took 9978.730860 ms
MSYNC 27382015120 TOOK 6.553248 ms
CAS was successful! new counter is 12, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 12
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 124, parall_iter is 0, num_threads is 1, last counter is 12, curr_counter is 13
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 10165.878645 ms
Thread ID: 1, set_cpu took 0.075038 ms
Threads took 10185.529175 ms
MSYNC 27382015120 TOOK 44.769157 ms
CAS was successful! new counter is 13, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 13
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 20, parall_iter is 1, num_threads is 1, last counter is 13, curr_counter is 14
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 10038.711800 ms
Thread ID: 2, set_cpu took 0.073950 ms
Threads took 10063.499716 ms
MSYNC 27382015120 TOOK 40.903606 ms
CAS was successful! new counter is 14, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 14
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 62, parall_iter is 0, num_threads is 1, last counter is 14, curr_counter is 15
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 9972.361897 ms
Thread ID: 1, set_cpu took 0.066846 ms
Threads took 9972.580643 ms
MSYNC 27382015120 TOOK 18.706846 ms
CAS was successful! new counter is 15, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 15
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 82, parall_iter is 1, num_threads is 1, last counter is 15, curr_counter is 16
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 10253.737967 ms
Thread ID: 2, set_cpu took 0.073534 ms
Threads took 10273.545965 ms
MSYNC 27382015120 TOOK 28.219688 ms
CAS was successful! new counter is 16, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 16
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 105, parall_iter is 0, num_threads is 1, last counter is 16, curr_counter is 17
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 10228.544464 ms
Thread ID: 1, set_cpu took 0.067742 ms
Threads took 10252.835755 ms
MSYNC 27382015120 TOOK 29.653662 ms
CAS was successful! new counter is 17, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 17
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 14, parall_iter is 1, num_threads is 1, last counter is 17, curr_counter is 18
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 9792.496423 ms
Thread ID: 2, set_cpu took 0.058622 ms
Threads took 9812.660890 ms
MSYNC 27382015120 TOOK 29.085230 ms
CAS was successful! new counter is 18, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 18
Parall_iter 0, Write new metadata at address 0x400f20180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 17, parall_iter is 0, num_threads is 1, last counter is 18, curr_counter is 19
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400f20280000, curr_pr_arr is 0x400f20280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start 2025-05-22 21:40:39,145 - root - INFO - Step: 385 | Loss: 7.13 | Tokens per second: 1724.71 | Training tokens per second (%): 34.22 | MFU (%): 2.39 | TFLOPs: 23.61
2025-05-22 21:40:40,511 - root - INFO - Step: 390 | Loss: 7.00 | Tokens per second: 7590.86 | Training tokens per second (%): 41.74 | MFU (%): 10.51 | TFLOPs: 103.93
2025-05-22 21:40:41,884 - root - INFO - Step: 395 | Loss: 7.46 | Tokens per second: 7545.21 | Training tokens per second (%): 45.66 | MFU (%): 10.45 | TFLOPs: 103.30
2025-05-22 21:40:43,250 - root - INFO - Step: 400 | Loss: 7.03 | Tokens per second: 7572.00 | Training tokens per second (%): 36.79 | MFU (%): 10.48 | TFLOPs: 103.67
2025-05-22 21:40:43,277 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:40:43,279 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
total_size: 6845503780, bsize: 6845503780, ratio: 2.0
6845503780 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 196.61188125610352 ms
CPU copy took 10178.668975830078 ms
---------------------- [PERF] Single Checkpoint time is 10.394965887069702 sec, average is 10.394964218139648
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 216.53342247009277 ms
CPU copy took 10517.797708511353 ms
---------------------- [PERF] Single Checkpoint time is 10.734787940979004 sec, average is 10.564874649047852
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 208.9977264404297 ms
CPU copy took 10013.653993606567 ms
---------------------- [PERF] Single Checkpoint time is 10.223109006881714 sec, average is 10.394964218139648
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 220.11947631835938 ms
CPU copy took 9969.574451446533 ms
---------------------- [PERF] Single Checkpoint time is 10.19038724899292 sec, average is 10.309036016464233
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 203.38153839111328 ms
CPU copy took 9884.071826934814 ms
---------------------- [PERF] Single Checkpoint time is 10.08797001838684 sec, average is 10.223107814788818
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 203.83548736572266 ms
CPU copy took 10028.759002685547 ms
---------------------- [PERF] Single Checkpoint time is 10.233490943908691 sec, average is 10.228298902511597
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 215.7726287841797 ms
CPU copy took 9981.441974639893 ms
---------------------- [PERF] Single Checkpoint time is 10.19774842262268 sec, average is 10.223107814788818
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 197.90005683898926 ms
CPU copy took 10129.424095153809 ms
---------------------- [PERF] Single Checkpoint time is 10.327737808227539 sec, average is 10.228298902511597
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 197.9067325592041 ms
CPU copy took 10241.40453338623 ms
---------------------- [PERF] Single Checkpoint time is 10.439732313156128 sec, average is 10.233489990234375
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 197.0689296722412 ms
CPU copy took 10245.493173599243 ms
---------------------- [PERF] Single Checkpoint time is 10.442909002304077 sec, average is 10.280613422393799
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 197.98541069030762 ms
CPU copy took 10109.822988510132 ms
---------------------- [PERF] Single Checkpoint time is 10.308291912078857 sec, average is 10.30829119682312
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 220.09921073913574 ms
CPU copy took 10006.67667388916 ms
---------------------- [PERF] Single Checkpoint time is 10.22746467590332 sec, average is 10.270890593528748
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 198.47869873046875 ms
CPU copy took 10254.306077957153 ms
---------------------- [PERF] Single Checkpoint time is 10.453344106674194 sec, average is 10.30829119682312
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 197.5116729736328 ms
CPU copy took 10109.864473342896 ms
---------------------- [PERF] Single Checkpoint time is 10.307855367660522 sec, average is 10.308072686195374
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 221.1611270904541 ms
CPU copy took 10018.673419952393 ms
---------------------- [PERF] Single Checkpoint time is 10.240201473236084 sec, average is 10.307854175567627
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 198.8368034362793 ms
CPU copy took 10307.193756103516 ms
---------------------- [PERF] Single Checkpoint time is 10.509629964828491 sec, average is 10.308072686195374
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 196.80261611938477 ms
CPU copy took 10287.920236587524 ms
---------------------- [PERF] Single Checkpoint time is 10.48514437675476 sec, average is 10.30829119682312
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 196.93374633789062 ms
CPU copy took 9865.097284317017 ms
---------------------- [PERF] Single Checkpoint time is 10.062373161315918 sec, average is 10.308072686195374
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 217.09871292114258 ms
CPU copy took 10205.420732498169 ms
---------------------- [PERF] Single Checkpoint time is 10.423563003540039 sec, average is 10.30829119682312
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 215.3928279876709 ms
CPU copy took 10067.60573387146 ms
---------------------- [PERF] Single Checkpoint time is 10.283378839492798 sec, average is 10.308072686195374
---- exit
addr is 0x400f20280000!
Thread ID: 1, savenvm_thread_nd took 10132.001691 ms
Thread ID: 1, set_cpu took 0.072638 ms
Threads took 10152.720062 ms
MSYNC 27382015120 TOOK 24.422902 ms
CAS was successful! new counter is 19, is_distributed is 0
******** checkp_info saved in 0x400f20180000, curr_checkpoint is 0x400f20180000
0, 19
Parall_iter 1, Write new metadata at address 0x400f20200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 59, parall_iter is 1, num_threads is 1, last counter is 19, curr_counter is 20
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401580410000, curr_pr_arr is 0x401580410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401580410000!
Thread ID: 2, savenvm_thread_nd took 10038.494629 ms
Thread ID: 2, set_cpu took 0.078942 ms
Threads took 10038.750975 ms
MSYNC 27382015120 TOOK 27.905969 ms
CAS was successful! new counter is 20, is_distributed is 0
******** checkp_info saved in 0x400f20200000, curr_checkpoint is 0x400f20200000
1, 20
2025-05-22 21:41:00,564 - root - INFO - Training completed
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
Setting optimizer state...
******************** CALL SAVE ********************
PCCHECK duration: 240 s
==== PCCHECK END ====
---- Total for fp32 / 2048: 858 s ----

==== RUNNING BASELINE FOR 1024 WITH bf16 ====
2025-05-22 21:41:23,124 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_1024/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 21:41:23,174 - root - INFO - Setting up DataLoaders...
2025-05-22 21:41:31,203 - root - INFO - Setting up Model...
2025-05-22 21:41:39,583 - root - INFO - Starting training!
2025-05-22 21:41:41,551 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 520.45 | Training tokens per second (%): 77.54 | MFU (%): 0.22 | TFLOPs: 2.15
2025-05-22 21:41:42,013 - root - INFO - Step: 5 | Loss: 11.92 | Tokens per second: 8884.55 | Training tokens per second (%): 40.14 | MFU (%): 3.71 | TFLOPs: 36.67
2025-05-22 21:41:42,599 - root - INFO - Step: 10 | Loss: 11.93 | Tokens per second: 8770.56 | Training tokens per second (%): 83.77 | MFU (%): 3.66 | TFLOPs: 36.20
2025-05-22 21:41:43,179 - root - INFO - Step: 15 | Loss: 11.86 | Tokens per second: 8838.31 | Training tokens per second (%): 57.17 | MFU (%): 3.69 | TFLOPs: 36.48
2025-05-22 21:41:43,755 - root - INFO - Step: 20 | Loss: 11.87 | Tokens per second: 8920.33 | Training tokens per second (%): 75.68 | MFU (%): 3.72 | TFLOPs: 36.82
2025-05-22 21:41:46,557 - root - INFO - Checkpoint saved in 2.8021 seconds
2025-05-22 21:41:46,559 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:41:47,204 - root - INFO - Step: 25 | Loss: 11.79 | Tokens per second: 1484.85 | Training tokens per second (%): 70.53 | MFU (%): 0.62 | TFLOPs: 6.13
2025-05-22 21:41:47,799 - root - INFO - Step: 30 | Loss: 11.72 | Tokens per second: 8625.86 | Training tokens per second (%): 68.73 | MFU (%): 3.60 | TFLOPs: 35.60
2025-05-22 21:41:48,380 - root - INFO - Step: 35 | Loss: 11.66 | Tokens per second: 8846.41 | Training tokens per second (%): 49.82 | MFU (%): 3.69 | TFLOPs: 36.51
2025-05-22 21:41:48,947 - root - INFO - Step: 40 | Loss: 11.75 | Tokens per second: 9054.45 | Training tokens per second (%): 39.80 | MFU (%): 3.78 | TFLOPs: 37.37
2025-05-22 21:41:51,277 - root - INFO - Checkpoint saved in 2.3300 seconds
2025-05-22 21:41:51,278 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:41:51,932 - root - INFO - Step: 45 | Loss: 11.52 | Tokens per second: 1715.77 | Training tokens per second (%): 62.34 | MFU (%): 0.72 | TFLOPs: 7.08
2025-05-22 21:41:52,509 - root - INFO - Step: 50 | Loss: 11.55 | Tokens per second: 8901.61 | Training tokens per second (%): 40.70 | MFU (%): 3.72 | TFLOPs: 36.74
2025-05-22 21:41:53,098 - root - INFO - Step: 55 | Loss: 11.64 | Tokens per second: 8714.28 | Training tokens per second (%): 71.37 | MFU (%): 3.64 | TFLOPs: 35.97
2025-05-22 21:41:53,681 - root - INFO - Step: 60 | Loss: 11.52 | Tokens per second: 8796.56 | Training tokens per second (%): 79.02 | MFU (%): 3.67 | TFLOPs: 36.31
2025-05-22 21:41:56,012 - root - INFO - Checkpoint saved in 2.3309 seconds
2025-05-22 21:41:56,013 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:41:56,661 - root - INFO - Step: 65 | Loss: 11.62 | Tokens per second: 1718.88 | Training tokens per second (%): 73.18 | MFU (%): 0.72 | TFLOPs: 7.09
2025-05-22 21:41:57,247 - root - INFO - Step: 70 | Loss: 11.47 | Tokens per second: 8771.06 | Training tokens per second (%): 44.98 | MFU (%): 3.66 | TFLOPs: 36.20
2025-05-22 21:41:57,834 - root - INFO - Step: 75 | Loss: 11.36 | Tokens per second: 8736.94 | Training tokens per second (%): 46.62 | MFU (%): 3.65 | TFLOPs: 36.06
2025-05-22 21:41:58,423 - root - INFO - Step: 80 | Loss: 11.40 | Tokens per second: 8718.05 | Training tokens per second (%): 57.97 | MFU (%): 3.64 | TFLOPs: 35.98
2025-05-22 21:42:00,758 - root - INFO - Checkpoint saved in 2.3352 seconds
2025-05-22 21:42:00,759 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:42:01,623 - root - INFO - Step: 85 | Loss: 11.35 | Tokens per second: 1600.74 | Training tokens per second (%): 64.18 | MFU (%): 0.67 | TFLOPs: 6.61
2025-05-22 21:42:02,494 - root - INFO - Step: 90 | Loss: 11.27 | Tokens per second: 5887.03 | Training tokens per second (%): 93.67 | MFU (%): 2.46 | TFLOPs: 24.30
2025-05-22 21:42:03,387 - root - INFO - Step: 95 | Loss: 11.20 | Tokens per second: 5744.47 | Training tokens per second (%): 88.40 | MFU (%): 2.40 | TFLOPs: 23.71
2025-05-22 21:42:04,319 - root - INFO - Step: 100 | Loss: 11.20 | Tokens per second: 5501.12 | Training tokens per second (%): 100.00 | MFU (%): 2.30 | TFLOPs: 22.71
2025-05-22 21:42:06,650 - root - INFO - Checkpoint saved in 2.3308 seconds
2025-05-22 21:42:06,651 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:42:07,623 - root - INFO - Step: 105 | Loss: 11.25 | Tokens per second: 1550.35 | Training tokens per second (%): 46.11 | MFU (%): 0.65 | TFLOPs: 6.40
2025-05-22 21:42:08,512 - root - INFO - Step: 110 | Loss: 11.20 | Tokens per second: 5766.91 | Training tokens per second (%): 43.05 | MFU (%): 2.41 | TFLOPs: 23.80
2025-05-22 21:42:09,387 - root - INFO - Step: 115 | Loss: 11.05 | Tokens per second: 5861.53 | Training tokens per second (%): 39.90 | MFU (%): 2.45 | TFLOPs: 24.19
2025-05-22 21:42:10,268 - root - INFO - Step: 120 | Loss: 10.97 | Tokens per second: 5816.37 | Training tokens per second (%): 66.80 | MFU (%): 2.43 | TFLOPs: 24.01
2025-05-22 21:42:12,611 - root - INFO - Checkpoint saved in 2.3425 seconds
2025-05-22 21:42:12,613 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:42:13,631 - root - INFO - Step: 125 | Loss: 11.26 | Tokens per second: 1523.23 | Training tokens per second (%): 58.54 | MFU (%): 0.64 | TFLOPs: 6.29
2025-05-22 21:42:14,517 - root - INFO - Step: 130 | Loss: 11.24 | Tokens per second: 5787.96 | Training tokens per second (%): 42.27 | MFU (%): 2.42 | TFLOPs: 23.89
2025-05-22 21:42:15,405 - root - INFO - Step: 135 | Loss: 10.84 | Tokens per second: 5774.16 | Training tokens per second (%): 63.54 | MFU (%): 2.41 | TFLOPs: 23.83
2025-05-22 21:42:16,285 - root - INFO - Step: 140 | Loss: 11.03 | Tokens per second: 5827.68 | Training tokens per second (%): 45.02 | MFU (%): 2.43 | TFLOPs: 24.05
2025-05-22 21:42:18,613 - root - INFO - Checkpoint saved in 2.3275 seconds
2025-05-22 21:42:18,615 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:42:19,639 - root - INFO - Step: 145 | Loss: 10.80 | Tokens per second: 1527.23 | Training tokens per second (%): 59.90 | MFU (%): 0.64 | TFLOPs: 6.30
2025-05-22 21:42:20,514 - root - INFO - Step: 150 | Loss: 10.98 | Tokens per second: 5864.01 | Training tokens per second (%): 67.87 | MFU (%): 2.45 | TFLOPs: 24.20
2025-05-22 21:42:21,403 - root - INFO - Step: 155 | Loss: 10.93 | Tokens per second: 5763.62 | Training tokens per second (%): 87.15 | MFU (%): 2.41 | TFLOPs: 23.79
2025-05-22 21:42:22,289 - root - INFO - Step: 160 | Loss: 10.52 | Tokens per second: 5789.86 | Training tokens per second (%): 64.86 | MFU (%): 2.42 | TFLOPs: 23.90
2025-05-22 21:42:24,627 - root - INFO - Checkpoint saved in 2.3379 seconds
2025-05-22 21:42:24,629 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:42:25,624 - root - INFO - Step: 165 | Loss: 10.69 | Tokens per second: 1535.84 | Training tokens per second (%): 45.74 | MFU (%): 0.64 | TFLOPs: 6.34
2025-05-22 21:42:26,538 - root - INFO - Step: 170 | Loss: 10.88 | Tokens per second: 5609.34 | Training tokens per second (%): 78.38 | MFU (%): 2.34 | TFLOPs: 23.15
2025-05-22 21:42:27,444 - root - INFO - Step: 175 | Loss: 11.02 | Tokens per second: 5659.82 | Training tokens per second (%): 57.73 | MFU (%): 2.36 | TFLOPs: 23.36
2025-05-22 21:42:28,345 - root - INFO - Step: 180 | Loss: 10.84 | Tokens per second: 5690.19 | Training tokens per second (%): 58.32 | MFU (%): 2.37 | TFLOPs: 23.49
2025-05-22 21:42:30,893 - root - INFO - Checkpoint saved in 2.5471 seconds
2025-05-22 21:42:30,895 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:42:32,048 - root - INFO - Step: 185 | Loss: 11.03 | Tokens per second: 1383.19 | Training tokens per second (%): 50.92 | MFU (%): 0.58 | TFLOPs: 5.71
2025-05-22 21:42:33,029 - root - INFO - Step: 190 | Loss: 10.81 | Tokens per second: 5228.31 | Training tokens per second (%): 62.42 | MFU (%): 2.18 | TFLOPs: 21.58
2025-05-22 21:42:34,060 - root - INFO - Step: 195 | Loss: 10.58 | Tokens per second: 4975.57 | Training tokens per second (%): 50.66 | MFU (%): 2.08 | TFLOPs: 20.54
2025-05-22 21:42:35,040 - root - INFO - Step: 200 | Loss: 10.93 | Tokens per second: 5228.55 | Training tokens per second (%): 52.85 | MFU (%): 2.18 | TFLOPs: 21.58
2025-05-22 21:42:37,578 - root - INFO - Checkpoint saved in 2.5375 seconds
2025-05-22 21:42:37,580 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:42:38,759 - root - INFO - Step: 205 | Loss: 10.52 | Tokens per second: 1377.41 | Training tokens per second (%): 38.81 | MFU (%): 0.57 | TFLOPs: 5.69
2025-05-22 21:42:39,759 - root - INFO - Step: 210 | Loss: 10.55 | Tokens per second: 5124.77 | Training tokens per second (%): 67.71 | MFU (%): 2.14 | TFLOPs: 21.15
2025-05-22 21:42:40,761 - root - INFO - Step: 215 | Loss: 10.46 | Tokens per second: 5118.55 | Training tokens per second (%): 48.05 | MFU (%): 2.14 | TFLOPs: 21.13
2025-05-22 21:42:41,753 - root - INFO - Step: 220 | Loss: 10.67 | Tokens per second: 5169.58 | Training tokens per second (%): 47.36 | MFU (%): 2.16 | TFLOPs: 21.34
2025-05-22 21:42:44,285 - root - INFO - Checkpoint saved in 2.5318 seconds
2025-05-22 21:42:44,287 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:42:45,468 - root - INFO - Step: 225 | Loss: 10.53 | Tokens per second: 1378.71 | Training tokens per second (%): 59.55 | MFU (%): 0.58 | TFLOPs: 5.69
2025-05-22 21:42:46,455 - root - INFO - Step: 230 | Loss: 10.31 | Tokens per second: 5196.00 | Training tokens per second (%): 25.08 | MFU (%): 2.17 | TFLOPs: 21.45
2025-05-22 21:42:47,453 - root - INFO - Step: 235 | Loss: 10.49 | Tokens per second: 5136.23 | Training tokens per second (%): 43.71 | MFU (%): 2.14 | TFLOPs: 21.20
2025-05-22 21:42:48,463 - root - INFO - Step: 240 | Loss: 10.49 | Tokens per second: 5077.30 | Training tokens per second (%): 71.23 | MFU (%): 2.12 | TFLOPs: 20.96
2025-05-22 21:42:50,999 - root - INFO - Checkpoint saved in 2.5362 seconds
2025-05-22 21:42:51,001 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:42:52,198 - root - INFO - Step: 245 | Loss: 10.55 | Tokens per second: 1371.46 | Training tokens per second (%): 58.46 | MFU (%): 0.57 | TFLOPs: 5.66
2025-05-22 21:42:53,222 - root - INFO - Step: 250 | Loss: 10.66 | Tokens per second: 5007.33 | Training tokens per second (%): 53.71 | MFU (%): 2.09 | TFLOPs: 20.67
2025-05-22 21:42:54,233 - root - INFO - Step: 255 | Loss: 10.72 | Tokens per second: 5071.03 | Training tokens per second (%): 42.27 | MFU (%): 2.12 | TFLOPs: 20.93
2025-05-22 21:42:55,248 - root - INFO - Step: 260 | Loss: 10.91 | Tokens per second: 5051.79 | Training tokens per second (%): 60.08 | MFU (%): 2.11 | TFLOPs: 20.85
2025-05-22 21:42:57,781 - root - INFO - Checkpoint saved in 2.5336 seconds
2025-05-22 21:42:57,784 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:42:58,964 - root - INFO - Step: 265 | Loss: 10.68 | Tokens per second: 1378.22 | Training tokens per second (%): 50.68 | MFU (%): 0.58 | TFLOPs: 5.69
2025-05-22 21:42:59,980 - root - INFO - Step: 270 | Loss: 10.48 | Tokens per second: 5048.81 | Training tokens per second (%): 68.73 | MFU (%): 2.11 | TFLOPs: 20.84
2025-05-22 21:43:00,983 - root - INFO - Step: 275 | Loss: 10.51 | Tokens per second: 5109.42 | Training tokens per second (%): 47.05 | MFU (%): 2.13 | TFLOPs: 21.09
2025-05-22 21:43:01,993 - root - INFO - Step: 280 | Loss: 10.49 | Tokens per second: 5074.89 | Training tokens per second (%): 65.78 | MFU (%): 2.12 | TFLOPs: 20.95
2025-05-22 21:43:04,518 - root - INFO - Checkpoint saved in 2.5242 seconds
2025-05-22 21:43:04,520 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:43:05,672 - root - INFO - Step: 285 | Loss: 10.55 | Tokens per second: 1392.40 | Training tokens per second (%): 73.09 | MFU (%): 0.58 | TFLOPs: 5.75
2025-05-22 21:43:06,684 - root - INFO - Step: 290 | Loss: 10.68 | Tokens per second: 5065.25 | Training tokens per second (%): 54.63 | MFU (%): 2.11 | TFLOPs: 20.91
2025-05-22 21:43:07,711 - root - INFO - Step: 295 | Loss: 10.50 | Tokens per second: 4992.16 | Training tokens per second (%): 44.59 | MFU (%): 2.08 | TFLOPs: 20.61
2025-05-22 21:43:08,771 - root - INFO - Step: 300 | Loss: 10.42 | Tokens per second: 4837.42 | Training tokens per second (%): 83.14 | MFU (%): 2.02 | TFLOPs: 19.97
2025-05-22 21:43:11,303 - root - INFO - Checkpoint saved in 2.5317 seconds
2025-05-22 21:43:11,305 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:43:12,488 - root - INFO - Step: 305 | Loss: 10.63 | Tokens per second: 1378.18 | Training tokens per second (%): 64.26 | MFU (%): 0.58 | TFLOPs: 5.69
2025-05-22 21:43:13,526 - root - INFO - Step: 310 | Loss: 10.49 | Tokens per second: 4936.06 | Training tokens per second (%): 58.93 | MFU (%): 2.06 | TFLOPs: 20.37
2025-05-22 21:43:14,562 - root - INFO - Step: 315 | Loss: 10.12 | Tokens per second: 4952.78 | Training tokens per second (%): 64.43 | MFU (%): 2.07 | TFLOPs: 20.44
2025-05-22 21:43:15,601 - root - INFO - Step: 320 | Loss: 10.40 | Tokens per second: 4931.75 | Training tokens per second (%): 73.79 | MFU (%): 2.06 | TFLOPs: 20.36
2025-05-22 21:43:18,127 - root - INFO - Checkpoint saved in 2.5258 seconds
2025-05-22 21:43:18,129 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:43:19,358 - root - INFO - Step: 325 | Loss: 10.47 | Tokens per second: 1363.26 | Training tokens per second (%): 49.69 | MFU (%): 0.57 | TFLOPs: 5.63
2025-05-22 21:43:20,417 - root - INFO - Step: 330 | Loss: 9.94 | Tokens per second: 4844.12 | Training tokens per second (%): 60.96 | MFU (%): 2.02 | TFLOPs: 19.99
2025-05-22 21:43:21,446 - root - INFO - Step: 335 | Loss: 10.51 | Tokens per second: 4979.06 | Training tokens per second (%): 24.41 | MFU (%): 2.08 | TFLOPs: 20.55
2025-05-22 21:43:22,475 - root - INFO - Step: 340 | Loss: 10.52 | Tokens per second: 4984.29 | Training tokens per second (%): 59.49 | MFU (%): 2.08 | TFLOPs: 20.57
2025-05-22 21:43:25,008 - root - INFO - Checkpoint saved in 2.5326 seconds
2025-05-22 21:43:25,010 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:43:26,241 - root - INFO - Step: 345 | Loss: 10.39 | Tokens per second: 1359.99 | Training tokens per second (%): 63.32 | MFU (%): 0.57 | TFLOPs: 5.61
2025-05-22 21:43:27,285 - root - INFO - Step: 350 | Loss: 10.69 | Tokens per second: 4909.95 | Training tokens per second (%): 62.03 | MFU (%): 2.05 | TFLOPs: 20.27
2025-05-22 21:43:28,312 - root - INFO - Step: 355 | Loss: 10.30 | Tokens per second: 4992.79 | Training tokens per second (%): 36.93 | MFU (%): 2.08 | TFLOPs: 20.61
2025-05-22 21:43:29,361 - root - INFO - Step: 360 | Loss: 10.00 | Tokens per second: 4890.10 | Training tokens per second (%): 72.48 | MFU (%): 2.04 | TFLOPs: 20.18
2025-05-22 21:43:31,888 - root - INFO - Checkpoint saved in 2.5267 seconds
2025-05-22 21:43:31,890 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:43:33,110 - root - INFO - Step: 365 | Loss: 10.48 | Tokens per second: 1365.97 | Training tokens per second (%): 82.03 | MFU (%): 0.57 | TFLOPs: 5.64
2025-05-22 21:43:34,139 - root - INFO - Step: 370 | Loss: 10.33 | Tokens per second: 4985.44 | Training tokens per second (%): 70.29 | MFU (%): 2.08 | TFLOPs: 20.58
2025-05-22 21:43:35,186 - root - INFO - Step: 375 | Loss: 10.55 | Tokens per second: 4896.98 | Training tokens per second (%): 91.58 | MFU (%): 2.04 | TFLOPs: 20.21
2025-05-22 21:43:36,237 - root - INFO - Step: 380 | Loss: 10.14 | Tokens per second: 4875.57 | Training tokens per second (%): 66.46 | MFU (%): 2.03 | TFLOPs: 20.12
2025-05-22 21:43:38,759 - root - INFO - Checkpoint saved in 2.5214 seconds
2025-05-22 21:43:38,761 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:43:40,007 - root - INFO - Step: 385 | Loss: 10.39 | Tokens per second: 1358.68 | Training tokens per second (%): 48.44 | MFU (%): 0.57 | TFLOPs: 5.61
2025-05-22 21:43:41,078 - root - INFO - Step: 390 | Loss: 10.21 | Tokens per second: 4789.42 | Training tokens per second (%): 63.48 | MFU (%): 2.00 | TFLOPs: 19.77
2025-05-22 21:43:42,131 - root - INFO - Step: 395 | Loss: 10.31 | Tokens per second: 4869.42 | Training tokens per second (%): 73.14 | MFU (%): 2.03 | TFLOPs: 20.10
2025-05-22 21:43:43,200 - root - INFO - Step: 400 | Loss: 10.18 | Tokens per second: 4796.01 | Training tokens per second (%): 53.57 | MFU (%): 2.00 | TFLOPs: 19.80
2025-05-22 21:43:45,731 - root - INFO - Checkpoint saved in 2.5313 seconds
2025-05-22 21:43:45,733 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:43:45,733 - root - INFO - Training completed
Baseline duration: 166 s
==== BASELINE END ====
==== RUNNING PCCHECK FOR 1024 WITH bf16 ====
2025-05-22 21:43:50,114 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_1024/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 21:43:50,116 - root - INFO - Setting up DataLoaders...
2025-05-22 21:43:51,093 - root - INFO - Setting up Model...
Model size: 755041280, Optimizer size: 1510082852, Total size: 2265124132
BSIZE IS 2265124132
At checkpoint, bsize is 2265124132
2025-05-22 21:44:05,016 - root - INFO - Checkpointing warmup done
2025-05-22 21:44:05,017 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-22 21:44:05,297 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 3683.57 | Training tokens per second (%): 77.54 | MFU (%): 1.54 | TFLOPs: 15.20
2025-05-22 21:44:05,742 - root - INFO - Step: 5 | Loss: 11.92 | Tokens per second: 9221.86 | Training tokens per second (%): 40.14 | MFU (%): 3.85 | TFLOPs: 38.06
2025-05-22 21:44:06,299 - root - INFO - Step: 10 | Loss: 11.93 | Tokens per second: 9227.02 | Training tokens per second (%): 83.77 | MFU (%): 3.85 | TFLOPs: 38.09
2025-05-22 21:44:06,846 - root - INFO - Step: 15 | Loss: 11.86 | Tokens per second: 9380.26 | Training tokens per second (%): 57.17 | MFU (%): 3.91 | TFLOPs: 38.72
2025-05-22 21:44:07,405 - root - INFO - Step: 20 | Loss: 11.87 | Tokens per second: 9176.56 | Training tokens per second (%): 75.68 | MFU (%): 3.83 | TFLOPs: 37.88
2025-05-22 21:44:07,441 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:07,443 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:08,040 - root - INFO - Step: 25 | Loss: 11.79 | Tokens per second: 8082.15 | Training tokens per second (%): 70.53 | MFU (%): 3.37 | TFLOPs: 33.36
2025-05-22 21:44:08,645 - root - INFO - Step: 30 | Loss: 11.72 | Tokens per second: 8492.49 | Training tokens per second (%): 68.73 | MFU (%): 3.54 | TFLOPs: 35.05
2025-05-22 21:44:09,260 - root - INFO - Step: 35 | Loss: 11.65 | Tokens per second: 8346.11 | Training tokens per second (%): 49.82 | MFU (%): 3.48 | TFLOPs: 34.45
2025-05-22 21:44:09,858 - root - INFO - Step: 40 | Loss: 11.75 | Tokens per second: 8579.01 | Training tokens per second (%): 39.80 | MFU (%): 3.58 | TFLOPs: 35.41
2025-05-22 21:44:09,907 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:09,908 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:11,482 - root - INFO - Step: 45 | Loss: 11.51 | Tokens per second: 3155.03 | Training tokens per second (%): 62.34 | MFU (%): 1.32 | TFLOPs: 13.02
2025-05-22 21:44:12,082 - root - INFO - Step: 50 | Loss: 11.54 | Tokens per second: 8561.35 | Training tokens per second (%): 40.70 | MFU (%): 3.57 | TFLOPs: 35.34
2025-05-22 21:44:12,680 - root - INFO - Step: 55 | Loss: 11.64 | Tokens per second: 8579.80 | Training tokens per second (%): 71.37 | MFU (%): 3.58 | TFLOPs: 35.41
2025-05-22 21:44:13,284 - root - INFO - Step: 60 | Loss: 11.52 | Tokens per second: 8503.76 | Training tokens per second (%): 79.02 | MFU (%): 3.55 | TFLOPs: 35.10
2025-05-22 21:44:13,329 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:13,331 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:14,864 - root - INFO - Step: 65 | Loss: 11.62 | Tokens per second: 3242.64 | Training tokens per second (%): 73.18 | MFU (%): 1.35 | TFLOPs: 13.38
2025-05-22 21:44:15,426 - root - INFO - Step: 70 | Loss: 11.46 | Tokens per second: 9134.36 | Training tokens per second (%): 44.98 | MFU (%): 3.81 | TFLOPs: 37.70
2025-05-22 21:44:15,972 - root - INFO - Step: 75 | Loss: 11.35 | Tokens per second: 9398.80 | Training tokens per second (%): 46.62 | MFU (%): 3.92 | TFLOPs: 38.79
2025-05-22 21:44:16,512 - root - INFO - Step: 80 | Loss: 11.40 | Tokens per second: 9514.33 | Training tokens per second (%): 57.97 | MFU (%): 3.97 | TFLOPs: 39.27
2025-05-22 21:44:16,555 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:16,557 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:17,501 - root - INFO - Step: 85 | Loss: 11.35 | Tokens per second: 5184.53 | Training tokens per second (%): 64.18 | MFU (%): 2.16 | TFLOPs: 21.40
2025-05-22 21:44:18,062 - root - INFO - Step: 90 | Loss: 11.26 | Tokens per second: 9165.08 | Training tokens per second (%): 93.67 | MFU (%): 3.83 | TFLOPs: 37.83
2025-05-22 21:44:18,627 - root - INFO - Step: 95 | Loss: 11.19 | Tokens per second: 9075.40 | Training tokens per second (%): 88.40 | MFU (%): 3.79 | TFLOPs: 37.46
2025-05-22 21:44:19,207 - root - INFO - Step: 100 | Loss: 11.19 | Tokens per second: 8852.70 | Training tokens per second (%): 100.00 | MFU (%): 3.69 | TFLOPs: 36.54
2025-05-22 21:44:19,253 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:19,255 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:20,137 - root - INFO - Step: 105 | Loss: 11.24 | Tokens per second: 5516.91 | Training tokens per second (%): 46.11 | MFU (%): 2.30 | TFLOPs: 22.77
2025-05-22 21:44:20,696 - root - INFO - Step: 110 | Loss: 11.19 | Tokens per second: 9176.45 | Training tokens per second (%): 43.05 | MFU (%): 3.83 | TFLOPs: 37.88
2025-05-22 21:44:21,243 - root - INFO - Step: 115 | Loss: 11.04 | Tokens per second: 9391.09 | Training tokens per second (%): 39.90 | MFU (%): 3.92 | TFLOPs: 38.76
2025-05-22 21:44:21,801 - root - INFO - Step: 120 | Loss: 10.96 | Tokens per second: 9203.85 | Training tokens per second (%): 66.80 | MFU (%): 3.84 | TFLOPs: 37.99
2025-05-22 21:44:21,846 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:21,848 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:22,824 - root - INFO - Step: 125 | Loss: 11.25 | Tokens per second: 5011.99 | Training tokens per second (%): 58.54 | MFU (%): 2.09 | TFLOPs: 20.69
2025-05-22 21:44:23,370 - root - INFO - Step: 130 | Loss: 11.23 | Tokens per second: 9408.83 | Training tokens per second (%): 42.27 | MFU (%): 3.93 | TFLOPs: 38.84
2025-05-22 21:44:23,928 - root - INFO - Step: 135 | Loss: 10.83 | Tokens per second: 9206.99 | Training tokens per second (%): 63.54 | MFU (%): 3.84 | TFLOPs: 38.00
2025-05-22 21:44:24,482 - root - INFO - Step: 140 | Loss: 11.02 | Tokens per second: 9269.39 | Training tokens per second (%): 45.02 | MFU (%): 3.87 | TFLOPs: 38.26
2025-05-22 21:44:24,526 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:24,527 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:25,471 - root - INFO - Step: 145 | Loss: 10.79 | Tokens per second: 5180.90 | Training tokens per second (%): 59.90 | MFU (%): 2.16 | TFLOPs: 21.38
2025-05-22 21:44:26,027 - root - INFO - Step: 150 | Loss: 10.97 | Tokens per second: 9237.00 | Training tokens per second (%): 67.87 | MFU (%): 3.86 | TFLOPs: 38.13
2025-05-22 21:44:26,590 - root - INFO - Step: 155 | Loss: 10.93 | Tokens per second: 9128.59 | Training tokens per second (%): 87.15 | MFU (%): 3.81 | TFLOPs: 37.68
2025-05-22 21:44:27,150 - root - INFO - Step: 160 | Loss: 10.51 | Tokens per second: 9168.95 | Training tokens per second (%): 64.86 | MFU (%): 3.83 | TFLOPs: 37.85
2025-05-22 21:44:27,195 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:27,197 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:28,177 - root - INFO - Step: 165 | Loss: 10.69 | Tokens per second: 4989.44 | Training tokens per second (%): 45.74 | MFU (%): 2.08 | TFLOPs: 20.59
2025-05-22 21:44:28,742 - root - INFO - Step: 170 | Loss: 10.88 | Tokens per second: 9090.29 | Training tokens per second (%): 78.38 | MFU (%): 3.79 | TFLOPs: 37.52
2025-05-22 21:44:29,301 - root - INFO - Step: 175 | Loss: 11.01 | Tokens per second: 9193.12 | Training tokens per second (%): 57.73 | MFU (%): 3.84 | TFLOPs: 37.95
2025-05-22 21:44:29,855 - root - INFO - Step: 180 | Loss: 10.84 | Tokens per second: 9270.13 | Training tokens per second (%): 58.32 | MFU (%): 3.87 | TFLOPs: 38.26
2025-05-22 21:44:29,900 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:29,901 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:30,777 - root - INFO - Step: 185 | Loss: 11.02 | Tokens per second: 5557.91 | Training tokens per second (%): 50.92 | MFU (%): 2.32 | TFLOPs: 22.94
2025-05-22 21:44:31,333 - root - INFO - Step: 190 | Loss: 10.80 | Tokens per second: 9241.17 | Training tokens per second (%): 62.42 | MFU (%): 3.86 | TFLOPs: 38.14
2025-05-22 21:44:31,918 - root - INFO - Step: 195 | Loss: 10.57 | Tokens per second: 8782.11 | Training tokens per second (%): 50.66 | MFU (%): 3.67 | TFLOPs: 36.25
2025-05-22 21:44:32,471 - root - INFO - Step: 200 | Loss: 10.93 | Tokens per second: 9285.13 | Training tokens per second (%): 52.85 | MFU (%): 3.88 | TFLOPs: 38.33
2025-05-22 21:44:32,515 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:32,517 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x4007e0280000, PR_ADDR is 0x4007e0000000, PEER_CHECK_ADDR is 0x4007e0080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 2265124132
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x4007e0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 77, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007e0280000, curr_pr_arr is 0x4007e0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007e0280000!
Thread ID: 1, savenvm_thread_nd took 3294.000121 ms
Thread ID: 1, set_cpu took 0.078654 ms
Threads took 3314.986804 ms
MSYNC 9060496528 TOOK 37.738834 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x4007e0180000, curr_checkpoint is 0x4007e0180000
0, 1
Parall_iter 1, Write new metadata at address 0x4007e0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 81, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009fc350000, curr_pr_arr is 0x4009fc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009fc350000!
Thread ID: 2, savenvm_thread_nd took 3293.805695 ms
Thread ID: 2, set_cpu took 0.095005 ms
Threads took 3318.230676 ms
MSYNC 9060496528 TOOK 25.951308 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x4007e0200000, curr_checkpoint is 0x4007e0200000
1, 2
Parall_iter 0, Write new metadata at address 0x4007e0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 84, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007e0280000, curr_pr_arr is 0x4007e0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007e0280000!
Thread ID: 1, savenvm_thread_nd took 2548.945770 ms
Thread ID: 1, set_cpu took 0.071326 ms
Threads took 2549.135524 ms
MSYNC 9060496528 TOOK 15.474012 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x4007e0180000, curr_checkpoint is 0x4007e0180000
0, 3
Parall_iter 1, Write new metadata at address 0x4007e0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 87, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009fc350000, curr_pr_arr is 0x4009fc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009fc350000!
Thread ID: 2, savenvm_thread_nd took 2519.647648 ms
Thread ID: 2, set_cpu took 0.069310 ms
Threads took 2543.172306 ms
MSYNC 9060496528 TOOK 21.349009 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x4007e0200000, curr_checkpoint is 0x4007e0200000
1, 4
Parall_iter 0, Write new metadata at address 0x4007e0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 126, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007e0280000, curr_pr_arr is 0x4007e0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007e0280000!
Thread ID: 1, savenvm_thread_nd took 2555.644005 ms
Thread ID: 1, set_cpu took 0.078910 ms
Threads took 2580.527695 ms
MSYNC 9060496528 TOOK 19.036789 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x4007e0180000, curr_checkpoint is 0x4007e0180000
0, 5
Parall_iter 1, Write new metadata at address 0x4007e0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 1, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009fc350000, curr_pr_arr is 0x4009fc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009fc350000!
Thread ID: 2, savenvm_thread_nd took 2548.237341 ms
Thread ID: 2, set_cpu took 0.057790 ms
Threads took 2571.008644 ms
MSYNC 9060496528 TOOK 14.914605 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x4007e0200000, curr_checkpoint is 0x4007e0200000
1, 6
Parall_iter 0, Write new metadata at address 0x4007e0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 4, parall_iter is 0, num_threads is 1, last counter is 6, curr_counter is 7
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007e0280000, curr_pr_arr is 0x4007e0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007e0280000!
Thread ID: 1, savenvm_thread_nd took 2573.726326 ms
Thread ID: 1, set_cpu took 0.067582 ms
Threads took 2595.301216 ms
MSYNC 9060496528 TOOK 18.944951 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x4007e0180000, curr_checkpoint is 0x4007e0180000
0, 7
Parall_iter 1, Write new metadata at address 0x4007e0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 7, parall_iter is 1, num_threads is 1, last counter is 7, curr_counter is 8
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009fc350000, curr_pr_arr is 0x4009fc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009fc350000!
Thread ID: 2, savenvm_thread_nd took 2520.513639 ms
Thread ID: 2, set_cpu took 0.070046 ms
Threads took 2542.318699 ms
MSYNC 9060496528 TOOK 20.726563 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x4007e0200000, curr_checkpoint is 0x4007e0200000
1, 8
Parall_iter 0, Write new metadata at address 0x4007e0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 32, parall_iter is 0, num_threads is 1, last counter is 8, curr_counter is 9
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007e0280000, curr_pr_arr is 0x4007e0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007e0280000!
Thread ID: 1, savenvm_thread_nd took 2536.888233 ms
Thread ID: 1, set_cpu took 0.069470 ms
Threads took 2559.785421 ms
MSYNC 9060496528 TOOK 20.393068 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x4007e0180000, curr_checkpoint is 0x4007e0180000
0, 9
Parall_iter 1, Write new metadata at address 0x4007e0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 35, par2025-05-22 21:44:33,426 - root - INFO - Step: 205 | Loss: 10.51 | Tokens per second: 5370.19 | Training tokens per second (%): 38.81 | MFU (%): 2.24 | TFLOPs: 22.17
2025-05-22 21:44:33,975 - root - INFO - Step: 210 | Loss: 10.54 | Tokens per second: 9343.91 | Training tokens per second (%): 67.71 | MFU (%): 3.90 | TFLOPs: 38.57
2025-05-22 21:44:34,522 - root - INFO - Step: 215 | Loss: 10.46 | Tokens per second: 9384.51 | Training tokens per second (%): 48.05 | MFU (%): 3.92 | TFLOPs: 38.74
2025-05-22 21:44:35,073 - root - INFO - Step: 220 | Loss: 10.67 | Tokens per second: 9329.51 | Training tokens per second (%): 47.36 | MFU (%): 3.89 | TFLOPs: 38.51
2025-05-22 21:44:35,119 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:35,121 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:36,048 - root - INFO - Step: 225 | Loss: 10.52 | Tokens per second: 5258.27 | Training tokens per second (%): 59.55 | MFU (%): 2.19 | TFLOPs: 21.70
2025-05-22 21:44:36,594 - root - INFO - Step: 230 | Loss: 10.30 | Tokens per second: 9409.86 | Training tokens per second (%): 25.08 | MFU (%): 3.93 | TFLOPs: 38.84
2025-05-22 21:44:37,142 - root - INFO - Step: 235 | Loss: 10.49 | Tokens per second: 9362.28 | Training tokens per second (%): 43.71 | MFU (%): 3.91 | TFLOPs: 38.64
2025-05-22 21:44:37,693 - root - INFO - Step: 240 | Loss: 10.48 | Tokens per second: 9315.54 | Training tokens per second (%): 71.23 | MFU (%): 3.89 | TFLOPs: 38.45
2025-05-22 21:44:37,739 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:37,741 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:38,701 - root - INFO - Step: 245 | Loss: 10.54 | Tokens per second: 5091.26 | Training tokens per second (%): 58.46 | MFU (%): 2.12 | TFLOPs: 21.01
2025-05-22 21:44:39,262 - root - INFO - Step: 250 | Loss: 10.66 | Tokens per second: 9143.28 | Training tokens per second (%): 53.71 | MFU (%): 3.82 | TFLOPs: 37.74
2025-05-22 21:44:39,806 - root - INFO - Step: 255 | Loss: 10.71 | Tokens per second: 9446.60 | Training tokens per second (%): 42.27 | MFU (%): 3.94 | TFLOPs: 38.99
2025-05-22 21:44:40,357 - root - INFO - Step: 260 | Loss: 10.90 | Tokens per second: 9323.61 | Training tokens per second (%): 60.08 | MFU (%): 3.89 | TFLOPs: 38.48
2025-05-22 21:44:40,401 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:40,402 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:41,304 - root - INFO - Step: 265 | Loss: 10.67 | Tokens per second: 5412.77 | Training tokens per second (%): 50.68 | MFU (%): 2.26 | TFLOPs: 22.34
2025-05-22 21:44:41,853 - root - INFO - Step: 270 | Loss: 10.47 | Tokens per second: 9349.17 | Training tokens per second (%): 68.73 | MFU (%): 3.90 | TFLOPs: 38.59
2025-05-22 21:44:42,398 - root - INFO - Step: 275 | Loss: 10.50 | Tokens per second: 9433.96 | Training tokens per second (%): 47.05 | MFU (%): 3.94 | TFLOPs: 38.94
2025-05-22 21:44:42,944 - root - INFO - Step: 280 | Loss: 10.48 | Tokens per second: 9401.64 | Training tokens per second (%): 65.78 | MFU (%): 3.92 | TFLOPs: 38.81
2025-05-22 21:44:42,988 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:42,989 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:43,955 - root - INFO - Step: 285 | Loss: 10.54 | Tokens per second: 5069.63 | Training tokens per second (%): 73.09 | MFU (%): 2.12 | TFLOPs: 20.93
2025-05-22 21:44:44,502 - root - INFO - Step: 290 | Loss: 10.68 | Tokens per second: 9393.54 | Training tokens per second (%): 54.63 | MFU (%): 3.92 | TFLOPs: 38.77
2025-05-22 21:44:45,044 - root - INFO - Step: 295 | Loss: 10.49 | Tokens per second: 9475.59 | Training tokens per second (%): 44.59 | MFU (%): 3.95 | TFLOPs: 39.11
2025-05-22 21:44:45,606 - root - INFO - Step: 300 | Loss: 10.42 | Tokens per second: 9129.07 | Training tokens per second (%): 83.14 | MFU (%): 3.81 | TFLOPs: 37.68
2025-05-22 21:44:45,650 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:45,652 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:46,576 - root - INFO - Step: 305 | Loss: 10.63 | Tokens per second: 5285.45 | Training tokens per second (%): 64.26 | MFU (%): 2.21 | TFLOPs: 21.82
2025-05-22 21:44:47,120 - root - INFO - Step: 310 | Loss: 10.49 | Tokens per second: 9449.80 | Training tokens per second (%): 58.93 | MFU (%): 3.94 | TFLOPs: 39.00
2025-05-22 21:44:47,665 - root - INFO - Step: 315 | Loss: 10.12 | Tokens per second: 9418.12 | Training tokens per second (%): 64.43 | MFU (%): 3.93 | TFLOPs: 38.87
2025-05-22 21:44:48,216 - root - INFO - Step: 320 | Loss: 10.39 | Tokens per second: 9324.73 | Training tokens per second (%): 73.79 | MFU (%): 3.89 | TFLOPs: 38.49
2025-05-22 21:44:48,263 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:48,264 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:49,228 - root - INFO - Step: 325 | Loss: 10.46 | Tokens per second: 5063.13 | Training tokens per second (%): 49.69 | MFU (%): 2.11 | TFLOPs: 20.90
2025-05-22 21:44:49,781 - root - INFO - Step: 330 | Loss: 9.93 | Tokens per second: 9297.94 | Training tokens per second (%): 60.96 | MFU (%): 3.88 | TFLOPs: 38.38
2025-05-22 21:44:50,322 - root - INFO - Step: 335 | Loss: 10.50 | Tokens per second: 9487.49 | Training tokens per second (%): 24.41 | MFU (%): 3.96 | TFLOPs: 39.16
2025-05-22 21:44:50,866 - root - INFO - Step: 340 | Loss: 10.52 | Tokens per second: 9443.30 | Training tokens per second (%): 59.49 | MFU (%): 3.94 | TFLOPs: 38.98
2025-05-22 21:44:50,910 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:50,911 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:51,854 - root - INFO - Step: 345 | Loss: 10.39 | Tokens per second: 5189.35 | Training tokens per second (%): 63.32 | MFU (%): 2.17 | TFLOPs: 21.42
2025-05-22 21:44:52,398 - root - INFO - Step: 350 | Loss: 10.69 | Tokens per second: 9438.79 | Training tokens per second (%): 62.03 | MFU (%): 3.94 | TFLOPs: 38.96
2025-05-22 21:44:52,920 - root - INFO - Step: 355 | Loss: 10.30 | Tokens per second: 9835.66 | Training tokens per second (%): 36.93 | MFU (%): 4.10 | TFLOPs: 40.60
2025-05-22 21:44:53,466 - root - INFO - Step: 360 | Loss: 10.00 | Tokens per second: 9412.46 | Training tokens per second (%): 72.48 | MFU (%): 3.93 | TFLOPs: 38.85
2025-05-22 21:44:53,509 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:53,511 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:54,516 - root - INFO - Step: 365 | Loss: 10.48 | Tokens per second: 4882.63 | Training tokens per second (%): 82.03 | MFU (%): 2.04 | TFLOPs: 20.15
2025-05-22 21:44:55,067 - root - INFO - Step: 370 | Loss: 10.32 | Tokens per second: 9320.01 | Training tokens per second (%): 70.29 | MFU (%): 3.89 | TFLOPs: 38.47
2025-05-22 21:44:55,643 - root - INFO - Step: 375 | Loss: 10.55 | Tokens per second: 8912.52 | Training tokens per second (%): 91.58 | MFU (%): 3.72 | TFLOPs: 36.79
2025-05-22 21:44:56,197 - root - INFO - Step: 380 | Loss: 10.14 | Tokens per second: 9258.07 | Training tokens per second (%): 66.46 | MFU (%): 3.86 | TFLOPs: 38.21
2025-05-22 21:44:56,241 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:56,242 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:44:57,149 - root - INFO - Step: 385 | Loss: 10.39 | Tokens per second: 5387.36 | Training tokens per second (%): 48.44 | MFU (%): 2.25 | TFLOPs: 22.24
2025-05-22 21:44:57,691 - root - INFO - Step: 390 | Loss: 10.21 | Tokens per second: 9487.18 | Training tokens per second (%): 63.48 | MFU (%): 3.96 | TFLOPs: 39.16
2025-05-22 21:44:58,235 - root - INFO - Step: 395 | Loss: 10.31 | Tokens per second: 9439.93 | Training tokens per second (%): 73.14 | MFU (%): 3.94 | TFLOPs: 38.96
2025-05-22 21:44:58,783 - root - INFO - Step: 400 | Loss: 10.18 | Tokens per second: 9368.00 | Training tokens per second (%): 53.57 | MFU (%): 3.91 | TFLOPs: 38.67
2025-05-22 21:44:58,828 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:44:58,829 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
all_iter is 1, num_threads is 1, last counter is 9, curr_counter is 10
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009fc350000, curr_pr_arr is 0x4009fc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009fc350000!
Thread ID: 2, savenvm_thread_nd took 2507.949206 ms
Thread ID: 2, set_cpu took 0.067230 ms
Threads took 2531.695937 ms
MSYNC 9060496528 TOOK 20.071286 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x4007e0200000, curr_checkpoint is 0x4007e0200000
1, 10
Parall_iter 0, Write new metadata at address 0x4007e0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 38, parall_iter is 0, num_threads is 1, last counter is 10, curr_counter is 11
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007e0280000, curr_pr_arr is 0x4007e0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007e0280000!
Thread ID: 1, savenvm_thread_nd took 2543.986169 ms
Thread ID: 1, set_cpu took 0.067294 ms
Threads took 2568.248694 ms
MSYNC 9060496528 TOOK 19.850044 ms
CAS was successful! new counter is 11, is_distributed is 0
******** checkp_info saved in 0x4007e0180000, curr_checkpoint is 0x4007e0180000
0, 11
Parall_iter 1, Write new metadata at address 0x4007e0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 41, parall_iter is 1, num_threads is 1, last counter is 11, curr_counter is 12
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009fc350000, curr_pr_arr is 0x4009fc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009fc350000!
Thread ID: 2, savenvm_thread_nd took 2506.534558 ms
Thread ID: 2, set_cpu took 0.069758 ms
Threads took 2529.719738 ms
MSYNC 9060496528 TOOK 16.054028 ms
CAS was successful! new counter is 12, is_distributed is 0
******** checkp_info saved in 0x4007e0200000, curr_checkpoint is 0x4007e0200000
1, 12
Parall_iter 0, Write new metadata at address 0x4007e0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 44, parall_iter is 0, num_threads is 1, last counter is 12, curr_counter is 13
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007e0280000, curr_pr_arr is 0x4007e0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007e0280000!
Thread ID: 1, savenvm_thread_nd took 2540.766199 ms
Thread ID: 1, set_cpu took 0.066846 ms
Threads took 2561.680852 ms
MSYNC 9060496528 TOOK 18.849851 ms
CAS was successful! new counter is 13, is_distributed is 0
******** checkp_info saved in 0x4007e0180000, curr_checkpoint is 0x4007e0180000
0, 13
Parall_iter 1, Write new metadata at address 0x4007e0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 68, parall_iter is 1, num_threads is 1, last counter is 13, curr_counter is 14
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009fc350000, curr_pr_arr is 0x4009fc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009fc350000!
Thread ID: 2, savenvm_thread_nd took 2516.127911 ms
Thread ID: 2, set_cpu took 0.073342 ms
Threads took 2538.027207 ms
MSYNC 9060496528 TOOK 15.288130 ms
CAS was successful! new counter is 14, is_distributed is 0
******** checkp_info saved in 0x4007e0200000, curr_checkpoint is 0x4007e0200000
1, 14
Parall_iter 0, Write new metadata at address 0x4007e0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 71, parall_iter is 0, num_threads is 1, last counter is 14, curr_counter is 15
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007e0280000, curr_pr_arr is 0x4007e0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007e0280000!
Thread ID: 1, savenvm_thread_nd took 2553.853818 ms
Thread ID: 1, set_cpu took 0.063998 ms
Threads took 2575.770074 ms
MSYNC 9060496528 TOOK 15.852178 ms
CAS was successful! new counter is 15, is_distributed is 0
******** checkp_info saved in 0x4007e0180000, curr_checkpoint is 0x4007e0180000
0, 15
Parall_iter 1, Write new metadata at address 0x4007e0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 92, parall_iter is 1, num_threads is 1, last counter is 15, curr_counter is 16
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009fc350000, curr_pr_arr is 0x4009fc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009fc350000!
Thread ID: 2, savenvm_thread_nd took 2509.787834 ms
Thread ID: 2, set_cpu took 0.075870 ms
Threads took 2534.103732 ms
MSYNC 9060496528 TOOK 17.893749 ms
CAS was successful! new counter is 16, is_distributed is 0
******** checkp_info saved in 0x4007e0200000, curr_checkpoint is 0x4007e0200000
1, 16
Parall_iter 0, Write new metadata at address 0x4007e0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 95, parall_iter is 0, num_threads is 1, last counter is 16, curr_counter is 17
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007e0280000, curr_pr_arr is 0x4007e0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007e0280000!
Thread ID: 1, savenvm_thread_nd took 2558.119767 ms
Thread ID: 1, set_cpu took 0.053182 ms
Threads took 2582.896931 ms
MSYNC 9060496528 TOOK 15.882832 ms
CAS was successful! new counter is 17, is_distributed is 0
******** checkp_info saved in 0x4007e0180000, curr_checkpoint is 0x4007e0180000
0, 17
Parall_iter 1, Write new metadata at address 0x4007e0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 119, parall_iter is 1, num_threads is 1, last counter is 17, curr_counter is 18
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009fc350000, curr_pr_arr is 0x4009fc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009fc350000!
Thread ID: 2, savenvm_thread_nd took 2523.754690 ms
Thread ID: 2, set_cpu took 0.075550 ms
Threads took 2554.338725 ms
MSYNC 9060496528 TOOK 15.406302 ms
CAS was successful! new counter is 18, is_distributed is 0
******** checkp_info saved in 0x4007e0200000, curr_checkpoint is 0x4007e0200000
1, 18
Parall_iter 0, Write new metadata at address 0x4007e0180000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 122, parall_iter is 0, num_threads is 1, last counter is 18, curr_counter is 19
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x4007e0280000, curr_pr_arr is 0x4007e0280000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x4007e0280000!
Thread ID: 1, savetotal_size: 2265124132, bsize: 2265124132, ratio: 2.0
2265124132 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 53.95960807800293 ms
CPU copy took 3358.269691467285 ms
---------------------- [PERF] Single Checkpoint time is 3.432110071182251 sec, average is 3.4321069717407227
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 70.13487815856934 ms
CPU copy took 3349.6320247650146 ms
---------------------- [PERF] Single Checkpoint time is 3.422625780105591 sec, average is 3.42736554145813
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 63.13276290893555 ms
CPU copy took 2589.810609817505 ms
---------------------- [PERF] Single Checkpoint time is 2.653942108154297 sec, average is 3.422624111175537
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 61.9046688079834 ms
CPU copy took 2569.925546646118 ms
---------------------- [PERF] Single Checkpoint time is 2.635200262069702 sec, average is 3.038282632827759
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 57.69515037536621 ms
CPU copy took 2604.9811840057373 ms
---------------------- [PERF] Single Checkpoint time is 2.663053274154663 sec, average is 2.6630516052246094
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 65.92702865600586 ms
CPU copy took 2591.338872909546 ms
---------------------- [PERF] Single Checkpoint time is 2.657683849334717 sec, average is 2.6603671312332153
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 58.75420570373535 ms
CPU copy took 2619.659900665283 ms
---------------------- [PERF] Single Checkpoint time is 2.6789989471435547 sec, average is 2.6630516052246094
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 58.878421783447266 ms
CPU copy took 2568.458318710327 ms
---------------------- [PERF] Single Checkpoint time is 2.627962827682495 sec, average is 2.6603671312332153
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 58.77685546875 ms
CPU copy took 2585.585832595825 ms
---------------------- [PERF] Single Checkpoint time is 2.6452689170837402 sec, average is 2.6576826572418213
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.89575386047363 ms
CPU copy took 2557.2094917297363 ms
---------------------- [PERF] Single Checkpoint time is 2.6190032958984375 sec, average is 2.655811905860901
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 61.47480010986328 ms
CPU copy took 2593.5206413269043 ms
---------------------- [PERF] Single Checkpoint time is 2.6552557945251465 sec, average is 2.65525484085083
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 55.07659912109375 ms
CPU copy took 2551.1772632598877 ms
---------------------- [PERF] Single Checkpoint time is 2.6081416606903076 sec, average is 2.6545979976654053
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.1273307800293 ms
CPU copy took 2585.960865020752 ms
---------------------- [PERF] Single Checkpoint time is 2.645941734313965 sec, average is 2.6539411544799805
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 62.1342658996582 ms
CPU copy took 2558.708667755127 ms
---------------------- [PERF] Single Checkpoint time is 2.621182680130005 sec, average is 2.6499407291412354
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 58.869123458862305 ms
CPU copy took 2597.02467918396 ms
---------------------- [PERF] Single Checkpoint time is 2.6577656269073486 sec, average is 2.6539411544799805
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 59.548139572143555 ms
CPU copy took 2557.4285984039307 ms
---------------------- [PERF] Single Checkpoint time is 2.6174116134643555 sec, average is 2.6499407291412354
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 61.03229522705078 ms
CPU copy took 2604.1970252990723 ms
---------------------- [PERF] Single Checkpoint time is 2.665661096572876 sec, average is 2.6539411544799805
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 58.737754821777344 ms
CPU copy took 2575.1395225524902 ms
---------------------- [PERF] Single Checkpoint time is 2.6344072818756104 sec, average is 2.6499407291412354
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 59.83591079711914 ms
CPU copy took 2607.356071472168 ms
---------------------- [PERF] Single Checkpoint time is 2.667526960372925 sec, average is 2.6539411544799805
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 53.7266731262207 ms
CPU copy took 2574.0625858306885 ms
---------------------- [PERF] Single Checkpoint time is 2.628070831298828 sec, average is 2.6499407291412354
---- exit
nvm_thread_nd took 2560.002399 ms
Thread ID: 1, set_cpu took 0.064414 ms
Threads took 2584.762829 ms
MSYNC 9060496528 TOOK 17.189099 ms
CAS was successful! new counter is 19, is_distributed is 0
******** checkp_info saved in 0x4007e0180000, curr_checkpoint is 0x4007e0180000
0, 19
Parall_iter 1, Write new metadata at address 0x4007e0200000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 125, parall_iter is 1, num_threads is 1, last counter is 19, curr_counter is 20
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x4009fc350000, curr_pr_arr is 0x4009fc350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x4009fc350000!
Thread ID: 2, savenvm_thread_nd took 2556.191119 ms
Thread ID: 2, set_cpu took 0.068350 ms
Threads took 2556.394857 ms
MSYNC 9060496528 TOOK 17.287560 ms
CAS was successful! new counter is 20, is_distributed is 0
******** checkp_info saved in 0x4007e0200000, curr_checkpoint is 0x4007e0200000
1, 20
2025-05-22 21:45:02,865 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
PCCHECK duration: 76 s
==== PCCHECK END ====
---- Total for bf16 / 1024: 242 s ----

==== RUNNING BASELINE FOR 2048 WITH bf16 ====
2025-05-22 21:45:06,484 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_2048/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 21:45:06,486 - root - INFO - Setting up DataLoaders...
2025-05-22 21:45:07,648 - root - INFO - Setting up Model...
2025-05-22 21:45:22,564 - root - INFO - Starting training!
2025-05-22 21:45:23,017 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 4533.09 | Training tokens per second (%): 38.77 | MFU (%): 6.28 | TFLOPs: 62.06
2025-05-22 21:45:23,555 - root - INFO - Step: 5 | Loss: 11.91 | Tokens per second: 15328.66 | Training tokens per second (%): 22.83 | MFU (%): 21.22 | TFLOPs: 209.86
2025-05-22 21:45:24,199 - root - INFO - Step: 10 | Loss: 11.87 | Tokens per second: 15975.24 | Training tokens per second (%): 51.44 | MFU (%): 22.11 | TFLOPs: 218.72
2025-05-22 21:45:24,857 - root - INFO - Step: 15 | Loss: 11.76 | Tokens per second: 15614.64 | Training tokens per second (%): 48.58 | MFU (%): 21.62 | TFLOPs: 213.78
2025-05-22 21:45:25,512 - root - INFO - Step: 20 | Loss: 11.66 | Tokens per second: 15722.77 | Training tokens per second (%): 49.55 | MFU (%): 21.77 | TFLOPs: 215.26
2025-05-22 21:45:32,552 - root - INFO - Checkpoint saved in 7.0404 seconds
2025-05-22 21:45:32,554 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:45:33,258 - root - INFO - Step: 25 | Loss: 11.51 | Tokens per second: 1322.45 | Training tokens per second (%): 36.56 | MFU (%): 1.83 | TFLOPs: 18.11
2025-05-22 21:45:33,910 - root - INFO - Step: 30 | Loss: 11.16 | Tokens per second: 15764.05 | Training tokens per second (%): 50.15 | MFU (%): 21.82 | TFLOPs: 215.83
2025-05-22 21:45:34,547 - root - INFO - Step: 35 | Loss: 11.14 | Tokens per second: 16159.14 | Training tokens per second (%): 27.57 | MFU (%): 22.37 | TFLOPs: 221.23
2025-05-22 21:45:35,182 - root - INFO - Step: 40 | Loss: 11.26 | Tokens per second: 16180.23 | Training tokens per second (%): 19.90 | MFU (%): 22.40 | TFLOPs: 221.52
2025-05-22 21:45:42,099 - root - INFO - Checkpoint saved in 6.9166 seconds
2025-05-22 21:45:42,101 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:45:42,805 - root - INFO - Step: 45 | Loss: 10.67 | Tokens per second: 1343.93 | Training tokens per second (%): 31.17 | MFU (%): 1.86 | TFLOPs: 18.40
2025-05-22 21:45:43,448 - root - INFO - Step: 50 | Loss: 10.78 | Tokens per second: 15996.46 | Training tokens per second (%): 21.87 | MFU (%): 22.14 | TFLOPs: 219.01
2025-05-22 21:45:44,101 - root - INFO - Step: 55 | Loss: 11.02 | Tokens per second: 15753.71 | Training tokens per second (%): 54.01 | MFU (%): 21.81 | TFLOPs: 215.68
2025-05-22 21:45:44,748 - root - INFO - Step: 60 | Loss: 10.69 | Tokens per second: 15895.48 | Training tokens per second (%): 49.63 | MFU (%): 22.00 | TFLOPs: 217.63
2025-05-22 21:45:51,748 - root - INFO - Checkpoint saved in 7.0000 seconds
2025-05-22 21:45:51,749 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:45:52,450 - root - INFO - Step: 65 | Loss: 10.81 | Tokens per second: 1329.97 | Training tokens per second (%): 48.10 | MFU (%): 1.84 | TFLOPs: 18.21
2025-05-22 21:45:53,105 - root - INFO - Step: 70 | Loss: 10.65 | Tokens per second: 15718.76 | Training tokens per second (%): 32.49 | MFU (%): 21.76 | TFLOPs: 215.21
2025-05-22 21:45:53,747 - root - INFO - Step: 75 | Loss: 10.27 | Tokens per second: 16003.01 | Training tokens per second (%): 33.31 | MFU (%): 22.15 | TFLOPs: 219.10
2025-05-22 21:45:54,386 - root - INFO - Step: 80 | Loss: 10.31 | Tokens per second: 16102.65 | Training tokens per second (%): 34.72 | MFU (%): 22.29 | TFLOPs: 220.46
2025-05-22 21:46:01,307 - root - INFO - Checkpoint saved in 6.9206 seconds
2025-05-22 21:46:01,308 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:46:02,019 - root - INFO - Step: 85 | Loss: 10.49 | Tokens per second: 1342.03 | Training tokens per second (%): 32.09 | MFU (%): 1.86 | TFLOPs: 18.37
2025-05-22 21:46:02,683 - root - INFO - Step: 90 | Loss: 10.11 | Tokens per second: 15506.07 | Training tokens per second (%): 76.84 | MFU (%): 21.47 | TFLOPs: 212.29
2025-05-22 21:46:03,358 - root - INFO - Step: 95 | Loss: 10.08 | Tokens per second: 15230.59 | Training tokens per second (%): 76.98 | MFU (%): 21.08 | TFLOPs: 208.52
2025-05-22 21:46:04,049 - root - INFO - Step: 100 | Loss: 10.11 | Tokens per second: 14885.85 | Training tokens per second (%): 100.00 | MFU (%): 20.61 | TFLOPs: 203.80
2025-05-22 21:46:10,959 - root - INFO - Checkpoint saved in 6.9100 seconds
2025-05-22 21:46:10,961 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:46:11,664 - root - INFO - Step: 105 | Loss: 10.19 | Tokens per second: 1345.17 | Training tokens per second (%): 33.06 | MFU (%): 1.86 | TFLOPs: 18.42
2025-05-22 21:46:12,323 - root - INFO - Step: 110 | Loss: 10.33 | Tokens per second: 15604.35 | Training tokens per second (%): 31.52 | MFU (%): 21.60 | TFLOPs: 213.64
2025-05-22 21:46:12,965 - root - INFO - Step: 115 | Loss: 10.13 | Tokens per second: 16030.49 | Training tokens per second (%): 19.95 | MFU (%): 22.19 | TFLOPs: 219.47
2025-05-22 21:46:13,617 - root - INFO - Step: 120 | Loss: 9.95 | Tokens per second: 15765.59 | Training tokens per second (%): 47.53 | MFU (%): 21.82 | TFLOPs: 215.85
2025-05-22 21:46:20,558 - root - INFO - Checkpoint saved in 6.9411 seconds
2025-05-22 21:46:20,561 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:46:21,276 - root - INFO - Step: 125 | Loss: 10.41 | Tokens per second: 1337.59 | Training tokens per second (%): 39.27 | MFU (%): 1.85 | TFLOPs: 18.31
2025-05-22 21:46:21,936 - root - INFO - Step: 130 | Loss: 10.35 | Tokens per second: 15578.01 | Training tokens per second (%): 31.13 | MFU (%): 21.57 | TFLOPs: 213.28
2025-05-22 21:46:22,585 - root - INFO - Step: 135 | Loss: 9.74 | Tokens per second: 15838.54 | Training tokens per second (%): 43.91 | MFU (%): 21.93 | TFLOPs: 216.85
2025-05-22 21:46:23,228 - root - INFO - Step: 140 | Loss: 10.01 | Tokens per second: 15995.60 | Training tokens per second (%): 23.79 | MFU (%): 22.14 | TFLOPs: 219.00
2025-05-22 21:46:30,143 - root - INFO - Checkpoint saved in 6.9144 seconds
2025-05-22 21:46:30,145 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:46:30,858 - root - INFO - Step: 145 | Loss: 9.70 | Tokens per second: 1342.64 | Training tokens per second (%): 40.89 | MFU (%): 1.86 | TFLOPs: 18.38
2025-05-22 21:46:31,506 - root - INFO - Step: 150 | Loss: 10.06 | Tokens per second: 15872.54 | Training tokens per second (%): 39.48 | MFU (%): 21.97 | TFLOPs: 217.31
2025-05-22 21:46:32,166 - root - INFO - Step: 155 | Loss: 10.01 | Tokens per second: 15579.01 | Training tokens per second (%): 59.66 | MFU (%): 21.57 | TFLOPs: 213.29
2025-05-22 21:46:32,819 - root - INFO - Step: 160 | Loss: 9.44 | Tokens per second: 15770.85 | Training tokens per second (%): 42.43 | MFU (%): 21.83 | TFLOPs: 215.92
2025-05-22 21:46:39,735 - root - INFO - Checkpoint saved in 6.9161 seconds
2025-05-22 21:46:39,737 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:46:40,458 - root - INFO - Step: 165 | Loss: 9.67 | Tokens per second: 1340.94 | Training tokens per second (%): 32.87 | MFU (%): 1.86 | TFLOPs: 18.36
2025-05-22 21:46:41,123 - root - INFO - Step: 170 | Loss: 10.05 | Tokens per second: 15470.81 | Training tokens per second (%): 58.68 | MFU (%): 21.42 | TFLOPs: 211.81
2025-05-22 21:46:41,779 - root - INFO - Step: 175 | Loss: 10.08 | Tokens per second: 15661.70 | Training tokens per second (%): 39.18 | MFU (%): 21.68 | TFLOPs: 214.42
2025-05-22 21:46:42,427 - root - INFO - Step: 180 | Loss: 9.73 | Tokens per second: 15880.05 | Training tokens per second (%): 29.38 | MFU (%): 21.98 | TFLOPs: 217.41
2025-05-22 21:46:49,345 - root - INFO - Checkpoint saved in 6.9176 seconds
2025-05-22 21:46:49,347 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:46:50,054 - root - INFO - Step: 185 | Loss: 10.12 | Tokens per second: 1343.05 | Training tokens per second (%): 27.41 | MFU (%): 1.86 | TFLOPs: 18.39
2025-05-22 21:46:50,707 - root - INFO - Step: 190 | Loss: 9.74 | Tokens per second: 15752.49 | Training tokens per second (%): 41.21 | MFU (%): 21.81 | TFLOPs: 215.67
2025-05-22 21:46:51,387 - root - INFO - Step: 195 | Loss: 9.37 | Tokens per second: 15135.92 | Training tokens per second (%): 45.33 | MFU (%): 20.95 | TFLOPs: 207.23
2025-05-22 21:46:52,038 - root - INFO - Step: 200 | Loss: 10.00 | Tokens per second: 15800.88 | Training tokens per second (%): 33.85 | MFU (%): 21.87 | TFLOPs: 216.33
2025-05-22 21:46:58,967 - root - INFO - Checkpoint saved in 6.9294 seconds
2025-05-22 21:46:58,969 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:46:59,678 - root - INFO - Step: 205 | Loss: 9.28 | Tokens per second: 1340.86 | Training tokens per second (%): 19.40 | MFU (%): 1.86 | TFLOPs: 18.36
2025-05-22 21:47:00,327 - root - INFO - Step: 210 | Loss: 9.65 | Tokens per second: 15827.91 | Training tokens per second (%): 38.69 | MFU (%): 21.91 | TFLOPs: 216.70
2025-05-22 21:47:00,969 - root - INFO - Step: 215 | Loss: 9.42 | Tokens per second: 16041.54 | Training tokens per second (%): 24.02 | MFU (%): 22.21 | TFLOPs: 219.62
2025-05-22 21:47:01,613 - root - INFO - Step: 220 | Loss: 9.78 | Tokens per second: 15960.00 | Training tokens per second (%): 24.01 | MFU (%): 22.09 | TFLOPs: 218.51
2025-05-22 21:47:08,530 - root - INFO - Checkpoint saved in 6.9171 seconds
2025-05-22 21:47:08,533 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:47:09,385 - root - INFO - Step: 225 | Loss: 9.41 | Tokens per second: 1318.04 | Training tokens per second (%): 40.32 | MFU (%): 1.82 | TFLOPs: 18.05
2025-05-22 21:47:10,375 - root - INFO - Step: 230 | Loss: 9.29 | Tokens per second: 10379.53 | Training tokens per second (%): 12.54 | MFU (%): 14.37 | TFLOPs: 142.11
2025-05-22 21:47:11,376 - root - INFO - Step: 235 | Loss: 9.50 | Tokens per second: 10260.85 | Training tokens per second (%): 27.69 | MFU (%): 14.20 | TFLOPs: 140.48
2025-05-22 21:47:12,396 - root - INFO - Step: 240 | Loss: 9.50 | Tokens per second: 10065.30 | Training tokens per second (%): 45.88 | MFU (%): 13.93 | TFLOPs: 137.80
2025-05-22 21:47:20,080 - root - INFO - Checkpoint saved in 7.6837 seconds
2025-05-22 21:47:20,089 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:47:21,286 - root - INFO - Step: 245 | Loss: 9.45 | Tokens per second: 1152.23 | Training tokens per second (%): 43.83 | MFU (%): 1.60 | TFLOPs: 15.78
2025-05-22 21:47:22,317 - root - INFO - Step: 250 | Loss: 9.73 | Tokens per second: 9959.74 | Training tokens per second (%): 46.86 | MFU (%): 13.79 | TFLOPs: 136.36
2025-05-22 21:47:23,320 - root - INFO - Step: 255 | Loss: 9.97 | Tokens per second: 10239.54 | Training tokens per second (%): 22.31 | MFU (%): 14.17 | TFLOPs: 140.19
2025-05-22 21:47:24,338 - root - INFO - Step: 260 | Loss: 10.19 | Tokens per second: 10087.13 | Training tokens per second (%): 40.04 | MFU (%): 13.96 | TFLOPs: 138.10
2025-05-22 21:47:32,007 - root - INFO - Checkpoint saved in 7.6692 seconds
2025-05-22 21:47:32,010 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:47:33,191 - root - INFO - Step: 265 | Loss: 9.69 | Tokens per second: 1157.00 | Training tokens per second (%): 25.34 | MFU (%): 1.60 | TFLOPs: 15.84
2025-05-22 21:47:34,199 - root - INFO - Step: 270 | Loss: 9.46 | Tokens per second: 10193.86 | Training tokens per second (%): 34.54 | MFU (%): 14.11 | TFLOPs: 139.56
2025-05-22 21:47:35,205 - root - INFO - Step: 275 | Loss: 9.52 | Tokens per second: 10202.28 | Training tokens per second (%): 26.43 | MFU (%): 14.12 | TFLOPs: 139.68
2025-05-22 21:47:36,221 - root - INFO - Step: 280 | Loss: 9.50 | Tokens per second: 10110.49 | Training tokens per second (%): 45.45 | MFU (%): 14.00 | TFLOPs: 138.42
2025-05-22 21:47:43,882 - root - INFO - Checkpoint saved in 7.6610 seconds
2025-05-22 21:47:43,885 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:47:44,867 - root - INFO - Step: 285 | Loss: 9.68 | Tokens per second: 1184.80 | Training tokens per second (%): 43.17 | MFU (%): 1.64 | TFLOPs: 16.22
2025-05-22 21:47:45,856 - root - INFO - Step: 290 | Loss: 9.49 | Tokens per second: 10377.71 | Training tokens per second (%): 27.31 | MFU (%): 14.37 | TFLOPs: 142.08
2025-05-22 21:47:46,847 - root - INFO - Step: 295 | Loss: 9.45 | Tokens per second: 10362.14 | Training tokens per second (%): 22.29 | MFU (%): 14.34 | TFLOPs: 141.87
2025-05-22 21:47:47,877 - root - INFO - Step: 300 | Loss: 9.29 | Tokens per second: 9974.75 | Training tokens per second (%): 81.27 | MFU (%): 13.81 | TFLOPs: 136.56
2025-05-22 21:47:55,558 - root - INFO - Checkpoint saved in 7.6808 seconds
2025-05-22 21:47:55,560 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:47:56,721 - root - INFO - Step: 305 | Loss: 9.80 | Tokens per second: 1158.20 | Training tokens per second (%): 42.13 | MFU (%): 1.60 | TFLOPs: 15.86
2025-05-22 21:47:57,710 - root - INFO - Step: 310 | Loss: 9.59 | Tokens per second: 10383.91 | Training tokens per second (%): 31.69 | MFU (%): 14.37 | TFLOPs: 142.17
2025-05-22 21:47:58,724 - root - INFO - Step: 315 | Loss: 9.03 | Tokens per second: 10123.81 | Training tokens per second (%): 42.22 | MFU (%): 14.01 | TFLOPs: 138.61
2025-05-22 21:47:59,742 - root - INFO - Step: 320 | Loss: 9.44 | Tokens per second: 10096.41 | Training tokens per second (%): 49.90 | MFU (%): 13.98 | TFLOPs: 138.23
2025-05-22 21:48:07,428 - root - INFO - Checkpoint saved in 7.6858 seconds
2025-05-22 21:48:07,430 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:48:08,592 - root - INFO - Step: 325 | Loss: 9.45 | Tokens per second: 1157.44 | Training tokens per second (%): 34.84 | MFU (%): 1.60 | TFLOPs: 15.85
2025-05-22 21:48:09,616 - root - INFO - Step: 330 | Loss: 8.75 | Tokens per second: 10026.64 | Training tokens per second (%): 45.21 | MFU (%): 13.88 | TFLOPs: 137.27
2025-05-22 21:48:10,610 - root - INFO - Step: 335 | Loss: 9.48 | Tokens per second: 10328.09 | Training tokens per second (%): 12.21 | MFU (%): 14.30 | TFLOPs: 141.40
2025-05-22 21:48:11,592 - root - INFO - Step: 340 | Loss: 9.63 | Tokens per second: 10462.49 | Training tokens per second (%): 33.55 | MFU (%): 14.48 | TFLOPs: 143.24
2025-05-22 21:48:19,279 - root - INFO - Checkpoint saved in 7.6873 seconds
2025-05-22 21:48:19,282 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:48:20,127 - root - INFO - Step: 345 | Loss: 9.40 | Tokens per second: 1200.14 | Training tokens per second (%): 38.32 | MFU (%): 1.66 | TFLOPs: 16.43
2025-05-22 21:48:20,948 - root - INFO - Step: 350 | Loss: 9.62 | Tokens per second: 12515.74 | Training tokens per second (%): 38.50 | MFU (%): 17.33 | TFLOPs: 171.35
2025-05-22 21:48:21,767 - root - INFO - Step: 355 | Loss: 9.30 | Tokens per second: 12550.54 | Training tokens per second (%): 18.47 | MFU (%): 17.37 | TFLOPs: 171.83
2025-05-22 21:48:22,600 - root - INFO - Step: 360 | Loss: 8.92 | Tokens per second: 12341.35 | Training tokens per second (%): 50.04 | MFU (%): 17.08 | TFLOPs: 168.97
2025-05-22 21:48:30,189 - root - INFO - Checkpoint saved in 7.5889 seconds
2025-05-22 21:48:30,192 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:48:31,117 - root - INFO - Step: 365 | Loss: 9.39 | Tokens per second: 1202.73 | Training tokens per second (%): 41.02 | MFU (%): 1.66 | TFLOPs: 16.47
2025-05-22 21:48:31,961 - root - INFO - Step: 370 | Loss: 9.04 | Tokens per second: 12169.18 | Training tokens per second (%): 35.15 | MFU (%): 16.85 | TFLOPs: 166.61
2025-05-22 21:48:32,818 - root - INFO - Step: 375 | Loss: 9.43 | Tokens per second: 11985.50 | Training tokens per second (%): 78.84 | MFU (%): 16.59 | TFLOPs: 164.09
2025-05-22 21:48:33,686 - root - INFO - Step: 380 | Loss: 8.94 | Tokens per second: 11840.05 | Training tokens per second (%): 49.27 | MFU (%): 16.39 | TFLOPs: 162.10
2025-05-22 21:48:41,251 - root - INFO - Checkpoint saved in 7.5647 seconds
2025-05-22 21:48:41,254 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:48:42,171 - root - INFO - Step: 385 | Loss: 9.24 | Tokens per second: 1207.30 | Training tokens per second (%): 34.22 | MFU (%): 1.67 | TFLOPs: 16.53
2025-05-22 21:48:43,029 - root - INFO - Step: 390 | Loss: 9.04 | Tokens per second: 11976.69 | Training tokens per second (%): 41.74 | MFU (%): 16.58 | TFLOPs: 163.97
2025-05-22 21:48:43,890 - root - INFO - Step: 395 | Loss: 9.33 | Tokens per second: 11929.06 | Training tokens per second (%): 45.66 | MFU (%): 16.51 | TFLOPs: 163.32
2025-05-22 21:48:44,765 - root - INFO - Step: 400 | Loss: 8.91 | Tokens per second: 11738.10 | Training tokens per second (%): 36.79 | MFU (%): 16.25 | TFLOPs: 160.71
2025-05-22 21:48:52,329 - root - INFO - Checkpoint saved in 7.5635 seconds
2025-05-22 21:48:52,332 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:48:52,332 - root - INFO - Training completed
Baseline duration: 230 s
==== BASELINE END ====
==== RUNNING PCCHECK FOR 2048 WITH bf16 ====
2025-05-22 21:48:56,472 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=400, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='./checkpointing/checkpoints', loss_file='./results/bf16/sl_2048/loss_trace.csv', checkpoint_freq=20, max_async=1, warmup=0, load_checkpoint=False, non_blocking=False)
2025-05-22 21:48:56,474 - root - INFO - Setting up DataLoaders...
2025-05-22 21:49:07,456 - root - INFO - Setting up Model...
Model size: 2281834496, Optimizer size: 4563669284, Total size: 6845503780
BSIZE IS 6845503780
At checkpoint, bsize is 6845503780
2025-05-22 21:49:31,178 - root - INFO - Checkpointing warmup done
2025-05-22 21:49:31,179 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-22 21:49:31,519 - root - INFO - Step: 1 | Loss: 11.92 | Tokens per second: 6081.25 | Training tokens per second (%): 38.77 | MFU (%): 8.42 | TFLOPs: 83.26
2025-05-22 21:49:32,045 - root - INFO - Step: 5 | Loss: 11.91 | Tokens per second: 15647.12 | Training tokens per second (%): 22.83 | MFU (%): 21.66 | TFLOPs: 214.22
2025-05-22 21:49:32,694 - root - INFO - Step: 10 | Loss: 11.87 | Tokens per second: 15845.85 | Training tokens per second (%): 51.44 | MFU (%): 21.94 | TFLOPs: 216.95
2025-05-22 21:49:33,344 - root - INFO - Step: 15 | Loss: 11.77 | Tokens per second: 15825.65 | Training tokens per second (%): 48.58 | MFU (%): 21.91 | TFLOPs: 216.67
2025-05-22 21:49:34,002 - root - INFO - Step: 20 | Loss: 11.66 | Tokens per second: 15651.03 | Training tokens per second (%): 49.55 | MFU (%): 21.67 | TFLOPs: 214.28
2025-05-22 21:49:34,059 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:49:34,060 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:49:34,901 - root - INFO - Step: 25 | Loss: 11.50 | Tokens per second: 11424.63 | Training tokens per second (%): 36.56 | MFU (%): 15.82 | TFLOPs: 156.41
2025-05-22 21:49:35,598 - root - INFO - Step: 30 | Loss: 11.15 | Tokens per second: 14741.86 | Training tokens per second (%): 50.15 | MFU (%): 20.41 | TFLOPs: 201.83
2025-05-22 21:49:36,293 - root - INFO - Step: 35 | Loss: 11.13 | Tokens per second: 14797.34 | Training tokens per second (%): 27.57 | MFU (%): 20.48 | TFLOPs: 202.59
2025-05-22 21:49:36,981 - root - INFO - Step: 40 | Loss: 11.25 | Tokens per second: 14939.86 | Training tokens per second (%): 19.90 | MFU (%): 20.68 | TFLOPs: 204.54
2025-05-22 21:49:37,048 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:49:37,049 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:49:45,233 - root - INFO - Step: 45 | Loss: 10.66 | Tokens per second: 1241.41 | Training tokens per second (%): 31.17 | MFU (%): 1.72 | TFLOPs: 17.00
2025-05-22 21:49:45,902 - root - INFO - Step: 50 | Loss: 10.77 | Tokens per second: 15367.01 | Training tokens per second (%): 21.87 | MFU (%): 21.27 | TFLOPs: 210.39
2025-05-22 21:49:46,582 - root - INFO - Step: 55 | Loss: 11.01 | Tokens per second: 15135.72 | Training tokens per second (%): 54.01 | MFU (%): 20.95 | TFLOPs: 207.22
2025-05-22 21:49:47,274 - root - INFO - Step: 60 | Loss: 10.68 | Tokens per second: 14857.95 | Training tokens per second (%): 49.63 | MFU (%): 20.57 | TFLOPs: 203.42
2025-05-22 21:49:47,340 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:49:47,343 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:49:55,567 - root - INFO - Step: 65 | Loss: 10.80 | Tokens per second: 1235.17 | Training tokens per second (%): 48.10 | MFU (%): 1.71 | TFLOPs: 16.91
2025-05-22 21:49:56,219 - root - INFO - Step: 70 | Loss: 10.64 | Tokens per second: 15789.31 | Training tokens per second (%): 32.49 | MFU (%): 21.86 | TFLOPs: 216.17
2025-05-22 21:49:56,870 - root - INFO - Step: 75 | Loss: 10.26 | Tokens per second: 15807.84 | Training tokens per second (%): 33.31 | MFU (%): 21.88 | TFLOPs: 216.43
2025-05-22 21:49:57,516 - root - INFO - Step: 80 | Loss: 10.30 | Tokens per second: 15907.20 | Training tokens per second (%): 34.72 | MFU (%): 22.02 | TFLOPs: 217.79
2025-05-22 21:49:57,580 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:49:57,581 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:50:04,052 - root - INFO - Step: 85 | Loss: 10.48 | Tokens per second: 1567.48 | Training tokens per second (%): 32.09 | MFU (%): 2.17 | TFLOPs: 21.46
2025-05-22 21:50:04,735 - root - INFO - Step: 90 | Loss: 10.10 | Tokens per second: 15055.40 | Training tokens per second (%): 76.84 | MFU (%): 20.84 | TFLOPs: 206.12
2025-05-22 21:50:05,420 - root - INFO - Step: 95 | Loss: 10.07 | Tokens per second: 15014.18 | Training tokens per second (%): 76.98 | MFU (%): 20.78 | TFLOPs: 205.56
2025-05-22 21:50:06,123 - root - INFO - Step: 100 | Loss: 10.10 | Tokens per second: 14626.42 | Training tokens per second (%): 100.00 | MFU (%): 20.25 | TFLOPs: 200.25
2025-05-22 21:50:06,188 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:50:06,190 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:50:12,591 - root - INFO - Step: 105 | Loss: 10.18 | Tokens per second: 1584.02 | Training tokens per second (%): 33.06 | MFU (%): 2.19 | TFLOPs: 21.69
2025-05-22 21:50:13,256 - root - INFO - Step: 110 | Loss: 10.33 | Tokens per second: 15475.98 | Training tokens per second (%): 31.52 | MFU (%): 21.42 | TFLOPs: 211.88
2025-05-22 21:50:13,906 - root - INFO - Step: 115 | Loss: 10.12 | Tokens per second: 15831.64 | Training tokens per second (%): 19.95 | MFU (%): 21.92 | TFLOPs: 216.75
2025-05-22 21:50:14,567 - root - INFO - Step: 120 | Loss: 9.94 | Tokens per second: 15562.36 | Training tokens per second (%): 47.53 | MFU (%): 21.54 | TFLOPs: 213.06
2025-05-22 21:50:14,633 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:50:14,634 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:50:21,033 - root - INFO - Step: 125 | Loss: 10.40 | Tokens per second: 1584.25 | Training tokens per second (%): 39.27 | MFU (%): 2.19 | TFLOPs: 21.69
2025-05-22 21:50:21,688 - root - INFO - Step: 130 | Loss: 10.34 | Tokens per second: 15696.59 | Training tokens per second (%): 31.13 | MFU (%): 21.73 | TFLOPs: 214.90
2025-05-22 21:50:22,346 - root - INFO - Step: 135 | Loss: 9.73 | Tokens per second: 15654.01 | Training tokens per second (%): 43.91 | MFU (%): 21.67 | TFLOPs: 214.32
2025-05-22 21:50:22,998 - root - INFO - Step: 140 | Loss: 10.00 | Tokens per second: 15774.96 | Training tokens per second (%): 23.79 | MFU (%): 21.84 | TFLOPs: 215.98
2025-05-22 21:50:23,062 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:50:23,064 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:50:29,590 - root - INFO - Step: 145 | Loss: 9.69 | Tokens per second: 1554.16 | Training tokens per second (%): 40.89 | MFU (%): 2.15 | TFLOPs: 21.28
2025-05-22 21:50:30,239 - root - INFO - Step: 150 | Loss: 10.05 | Tokens per second: 15841.83 | Training tokens per second (%): 39.48 | MFU (%): 21.93 | TFLOPs: 216.89
2025-05-22 21:50:30,902 - root - INFO - Step: 155 | Loss: 10.01 | Tokens per second: 15508.36 | Training tokens per second (%): 59.66 | MFU (%): 21.47 | TFLOPs: 212.33
2025-05-22 21:50:31,560 - root - INFO - Step: 160 | Loss: 9.43 | Tokens per second: 15644.36 | Training tokens per second (%): 42.43 | MFU (%): 21.66 | TFLOPs: 214.19
2025-05-22 21:50:31,624 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:50:31,625 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:50:38,032 - root - INFO - Step: 165 | Loss: 9.66 | Tokens per second: 1582.94 | Training tokens per second (%): 32.87 | MFU (%): 2.19 | TFLOPs: 21.67
2025-05-22 21:50:38,694 - root - INFO - Step: 170 | Loss: 10.04 | Tokens per second: 15534.67 | Training tokens per second (%): 58.68 | MFU (%): 21.51 | TFLOPs: 212.69
2025-05-22 21:50:39,349 - root - INFO - Step: 175 | Loss: 10.07 | Tokens per second: 15704.30 | Training tokens per second (%): 39.18 | MFU (%): 21.74 | TFLOPs: 215.01
2025-05-22 21:50:40,001 - root - INFO - Step: 180 | Loss: 9.73 | Tokens per second: 15774.77 | Training tokens per second (%): 29.37 | MFU (%): 21.84 | TFLOPs: 215.97
2025-05-22 21:50:40,066 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:50:40,067 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:50:46,613 - root - INFO - Step: 185 | Loss: 10.11 | Tokens per second: 1549.56 | Training tokens per second (%): 27.41 | MFU (%): 2.15 | TFLOPs: 21.22
2025-05-22 21:50:47,278 - root - INFO - Step: 190 | Loss: 9.73 | Tokens per second: 15458.50 | Training tokens per second (%): 41.21 | MFU (%): 21.40 | TFLOPs: 211.64
2025-05-22 21:50:47,959 - root - INFO - Step: 195 | Loss: 9.36 | Tokens per second: 15115.10 | Training tokens per second (%): 45.33 | MFU (%): 20.92 | TFLOPs: 206.94
2025-05-22 21:50:48,611 - root - INFO - Step: 200 | Loss: 9.99 | Tokens per second: 15768.13 | Training tokens per second (%): 33.85 | MFU (%): 21.83 | TFLOPs: 215.88
2025-05-22 21:50:48,676 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:50:48,677 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
PR_ADDR_DATA is 0x400e00280000, PR_ADDR is 0x400e00000000, PEER_CHECK_ADDR is 0x400e00080000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 6845503780
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400e00180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 99, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e00280000, curr_pr_arr is 0x400e00280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e00280000!
Thread ID: 1, savenvm_thread_nd took 10077.239000 ms
Thread ID: 1, set_cpu took 0.081821 ms
Threads took 10096.541149 ms
MSYNC 27382015120 TOOK 42.121633 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400e00180000, curr_checkpoint is 0x400e00180000
0, 1
Parall_iter 1, Write new metadata at address 0x400e00200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 102, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401460410000, curr_pr_arr is 0x401460410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401460410000!
Thread ID: 2, savenvm_thread_nd took 10071.006160 ms
Thread ID: 2, set_cpu took 0.073918 ms
Threads took 10095.773588 ms
MSYNC 27382015120 TOOK 49.326126 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400e00200000, curr_checkpoint is 0x400e00200000
1, 2
Parall_iter 0, Write new metadata at address 0x400e00180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 19, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e00280000, curr_pr_arr is 0x400e00280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e00280000!
Thread ID: 1, savenvm_thread_nd took 8215.142959 ms
Thread ID: 1, set_cpu took 0.081342 ms
Threads took 8235.309883 ms
MSYNC 27382015120 TOOK 19.296229 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400e00180000, curr_checkpoint is 0x400e00180000
0, 3
Parall_iter 1, Write new metadata at address 0x400e00200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 49, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401460410000, curr_pr_arr is 0x401460410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401460410000!
Thread ID: 2, savenvm_thread_nd took 8285.243157 ms
Thread ID: 2, set_cpu took 0.074366 ms
Threads took 8305.414081 ms
MSYNC 27382015120 TOOK 13.771468 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400e00200000, curr_checkpoint is 0x400e00200000
1, 4
Parall_iter 0, Write new metadata at address 0x400e00180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 71, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e00280000, curr_pr_arr is 0x400e00280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e00280000!
Thread ID: 1, savenvm_thread_nd took 8174.787172 ms
Thread ID: 1, set_cpu took 0.078845 ms
Threads took 8199.554575 ms
MSYNC 27382015120 TOOK 19.889526 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400e00180000, curr_checkpoint is 0x400e00180000
0, 5
Parall_iter 1, Write new metadata at address 0x400e00200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 94, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401460410000, curr_pr_arr is 0x401460410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401460410000!
Thread ID: 2, savenvm_thread_nd took 8326.746985 ms
Thread ID: 2, set_cpu took 0.066590 ms
Threads took 8346.902807 ms
MSYNC 27382015120 TOOK 19.373414 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400e00200000, curr_checkpoint is 0x400e00200000
1, 6
Parall_iter 0, Write new metadata at address 0x400e00180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 113, parall_iter is 0, num_threads is 1, last counter is 6, curr_counter is 7
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e00280000, curr_pr_arr is 0x400e00280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e00280000!
Thread ID: 1, savenvm_thread_nd took 8160.226930 ms
Thread ID: 1, set_cpu took 0.069022 ms
Threads took 8180.391808 ms
MSYNC 27382015120 TOOK 18.951250 ms
CAS was successful! new counter is 7, is_distributed is 0
******** checkp_info saved in 0x400e00180000, curr_checkpoint is 0x400e00180000
0, 7
Parall_iter 1, Write new metadata at address 0x400e00200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 8, parall_iter is 1, num_threads is 1, last counter is 7, curr_counter is 8
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401460410000, curr_pr_arr is 0x401460410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401460410000!
Thread ID: 2, savenvm_thread_nd took 8350.107225 ms
Thread ID: 2, set_cpu took 0.066558 ms
Threads took 8374.741188 ms
MSYNC 27382015120 TOOK 17.947119 ms
CAS was successful! new counter is 8, is_distributed is 0
******** checkp_info saved in 0x400e00200000, curr_checkpoint is 0x400e00200000
1, 8
Parall_iter 0, Write new metadata at address 0x400e00180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 11, parall_iter is 0, num_threads is 1, last counter is 8, curr_counter is 9
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e00280000, curr_pr_arr is 0x400e00280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e00280000!
Thread ID: 1, savenvm_thread_nd took 8198.044183 ms
Thread ID: 1, set_cpu took 0.053694 ms
Threads took 8218.191429 ms
MSYNC 27382015120 TOOK 21.274861 ms
CAS was successful! new counter is 9, is_distributed is 0
******** checkp_info saved in 0x400e00180000, curr_checkpoint is 0x400e00180000
0, 9
Parall_iter 1, Write new metadata at address 0x400e00200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew2025-05-22 21:50:55,082 - root - INFO - Step: 205 | Loss: 9.27 | Tokens per second: 1583.13 | Training tokens per second (%): 19.40 | MFU (%): 2.19 | TFLOPs: 21.67
2025-05-22 21:50:55,736 - root - INFO - Step: 210 | Loss: 9.64 | Tokens per second: 15745.08 | Training tokens per second (%): 38.69 | MFU (%): 21.80 | TFLOPs: 215.57
2025-05-22 21:50:56,383 - root - INFO - Step: 215 | Loss: 9.42 | Tokens per second: 15894.16 | Training tokens per second (%): 24.02 | MFU (%): 22.00 | TFLOPs: 217.61
2025-05-22 21:50:57,032 - root - INFO - Step: 220 | Loss: 9.77 | Tokens per second: 15847.89 | Training tokens per second (%): 24.01 | MFU (%): 21.94 | TFLOPs: 216.97
2025-05-22 21:50:57,096 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:50:57,098 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:51:03,696 - root - INFO - Step: 225 | Loss: 9.40 | Tokens per second: 1537.38 | Training tokens per second (%): 40.32 | MFU (%): 2.13 | TFLOPs: 21.05
2025-05-22 21:51:04,344 - root - INFO - Step: 230 | Loss: 9.29 | Tokens per second: 15879.02 | Training tokens per second (%): 12.54 | MFU (%): 21.98 | TFLOPs: 217.40
2025-05-22 21:51:04,997 - root - INFO - Step: 235 | Loss: 9.50 | Tokens per second: 15750.06 | Training tokens per second (%): 27.69 | MFU (%): 21.80 | TFLOPs: 215.63
2025-05-22 21:51:05,653 - root - INFO - Step: 240 | Loss: 9.49 | Tokens per second: 15663.07 | Training tokens per second (%): 45.88 | MFU (%): 21.68 | TFLOPs: 214.44
2025-05-22 21:51:05,719 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:51:05,721 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:51:12,126 - root - INFO - Step: 245 | Loss: 9.44 | Tokens per second: 1582.80 | Training tokens per second (%): 43.83 | MFU (%): 2.19 | TFLOPs: 21.67
2025-05-22 21:51:12,796 - root - INFO - Step: 250 | Loss: 9.72 | Tokens per second: 15348.70 | Training tokens per second (%): 46.86 | MFU (%): 21.25 | TFLOPs: 210.14
2025-05-22 21:51:13,445 - root - INFO - Step: 255 | Loss: 9.96 | Tokens per second: 15849.44 | Training tokens per second (%): 22.31 | MFU (%): 21.94 | TFLOPs: 216.99
2025-05-22 21:51:14,107 - root - INFO - Step: 260 | Loss: 10.18 | Tokens per second: 15535.70 | Training tokens per second (%): 40.04 | MFU (%): 21.51 | TFLOPs: 212.70
2025-05-22 21:51:14,173 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:51:14,175 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:51:20,779 - root - INFO - Step: 265 | Loss: 9.69 | Tokens per second: 1535.53 | Training tokens per second (%): 25.34 | MFU (%): 2.13 | TFLOPs: 21.02
2025-05-22 21:51:21,428 - root - INFO - Step: 270 | Loss: 9.46 | Tokens per second: 15843.58 | Training tokens per second (%): 34.54 | MFU (%): 21.93 | TFLOPs: 216.91
2025-05-22 21:51:22,075 - root - INFO - Step: 275 | Loss: 9.52 | Tokens per second: 15904.32 | Training tokens per second (%): 26.43 | MFU (%): 22.02 | TFLOPs: 217.75
2025-05-22 21:51:22,730 - root - INFO - Step: 280 | Loss: 9.50 | Tokens per second: 15701.68 | Training tokens per second (%): 45.45 | MFU (%): 21.74 | TFLOPs: 214.97
2025-05-22 21:51:22,794 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:51:22,796 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:51:29,277 - root - INFO - Step: 285 | Loss: 9.67 | Tokens per second: 1564.98 | Training tokens per second (%): 43.17 | MFU (%): 2.17 | TFLOPs: 21.43
2025-05-22 21:51:29,927 - root - INFO - Step: 290 | Loss: 9.48 | Tokens per second: 15827.79 | Training tokens per second (%): 27.31 | MFU (%): 21.91 | TFLOPs: 216.70
2025-05-22 21:51:30,577 - root - INFO - Step: 295 | Loss: 9.44 | Tokens per second: 15819.67 | Training tokens per second (%): 22.29 | MFU (%): 21.90 | TFLOPs: 216.59
2025-05-22 21:51:31,255 - root - INFO - Step: 300 | Loss: 9.28 | Tokens per second: 15162.55 | Training tokens per second (%): 81.27 | MFU (%): 20.99 | TFLOPs: 207.59
2025-05-22 21:51:31,320 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:51:31,321 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:51:37,859 - root - INFO - Step: 305 | Loss: 9.79 | Tokens per second: 1551.30 | Training tokens per second (%): 42.13 | MFU (%): 2.15 | TFLOPs: 21.24
2025-05-22 21:51:38,509 - root - INFO - Step: 310 | Loss: 9.59 | Tokens per second: 15832.91 | Training tokens per second (%): 31.69 | MFU (%): 21.92 | TFLOPs: 216.77
2025-05-22 21:51:39,168 - root - INFO - Step: 315 | Loss: 9.03 | Tokens per second: 15602.38 | Training tokens per second (%): 42.22 | MFU (%): 21.60 | TFLOPs: 213.61
2025-05-22 21:51:39,828 - root - INFO - Step: 320 | Loss: 9.43 | Tokens per second: 15604.40 | Training tokens per second (%): 49.90 | MFU (%): 21.60 | TFLOPs: 213.64
2025-05-22 21:51:39,893 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:51:39,894 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:51:46,420 - root - INFO - Step: 325 | Loss: 9.45 | Tokens per second: 1554.09 | Training tokens per second (%): 34.84 | MFU (%): 2.15 | TFLOPs: 21.28
2025-05-22 21:51:47,075 - root - INFO - Step: 330 | Loss: 8.74 | Tokens per second: 15700.77 | Training tokens per second (%): 45.21 | MFU (%): 21.74 | TFLOPs: 214.96
2025-05-22 21:51:47,721 - root - INFO - Step: 335 | Loss: 9.48 | Tokens per second: 15922.49 | Training tokens per second (%): 12.21 | MFU (%): 22.04 | TFLOPs: 217.99
2025-05-22 21:51:48,374 - root - INFO - Step: 340 | Loss: 9.62 | Tokens per second: 15746.60 | Training tokens per second (%): 33.55 | MFU (%): 21.80 | TFLOPs: 215.59
2025-05-22 21:51:48,439 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:51:48,440 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:51:55,033 - root - INFO - Step: 345 | Loss: 9.39 | Tokens per second: 1538.57 | Training tokens per second (%): 38.32 | MFU (%): 2.13 | TFLOPs: 21.06
2025-05-22 21:51:55,689 - root - INFO - Step: 350 | Loss: 9.62 | Tokens per second: 15668.49 | Training tokens per second (%): 38.50 | MFU (%): 21.69 | TFLOPs: 214.52
2025-05-22 21:51:56,338 - root - INFO - Step: 355 | Loss: 9.29 | Tokens per second: 15860.41 | Training tokens per second (%): 18.47 | MFU (%): 21.96 | TFLOPs: 217.14
2025-05-22 21:51:56,993 - root - INFO - Step: 360 | Loss: 8.91 | Tokens per second: 15702.13 | Training tokens per second (%): 50.04 | MFU (%): 21.74 | TFLOPs: 214.98
2025-05-22 21:51:57,057 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:51:57,059 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
2025-05-22 21:52:03,455 - root - INFO - Step: 365 | Loss: 9.38 | Tokens per second: 1585.34 | Training tokens per second (%): 41.02 | MFU (%): 2.19 | TFLOPs: 21.70
2025-05-22 21:52:04,105 - root - INFO - Step: 370 | Loss: 9.03 | Tokens per second: 15834.37 | Training tokens per second (%): 35.15 | MFU (%): 21.92 | TFLOPs: 216.79
2025-05-22 21:52:04,780 - root - INFO - Step: 375 | Loss: 9.42 | Tokens per second: 15249.58 | Training tokens per second (%): 78.84 | MFU (%): 21.11 | TFLOPs: 208.78
2025-05-22 21:52:05,461 - root - INFO - Step: 380 | Loss: 8.93 | Tokens per second: 15098.53 | Training tokens per second (%): 49.27 | MFU (%): 20.90 | TFLOPs: 206.71
2025-05-22 21:52:05,527 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:52:05,528 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
, tid is 54, parall_iter is 1, num_threads is 1, last counter is 9, curr_counter is 10
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401460410000, curr_pr_arr is 0x401460410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401460410000!
Thread ID: 2, savenvm_thread_nd took 8361.694724 ms
Thread ID: 2, set_cpu took 0.069662 ms
Threads took 8386.384012 ms
MSYNC 27382015120 TOOK 20.081649 ms
CAS was successful! new counter is 10, is_distributed is 0
******** checkp_info saved in 0x400e00200000, curr_checkpoint is 0x400e00200000
1, 10
Parall_iter 0, Write new metadata at address 0x400e00180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 78, parall_iter is 0, num_threads is 1, last counter is 10, curr_counter is 11
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e00280000, curr_pr_arr is 0x400e00280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e00280000!
Thread ID: 1, savenvm_thread_nd took 8183.090993 ms
Thread ID: 1, set_cpu took 0.072797 ms
Threads took 8205.467709 ms
MSYNC 27382015120 TOOK 13.258586 ms
CAS was successful! new counter is 11, is_distributed is 0
******** checkp_info saved in 0x400e00180000, curr_checkpoint is 0x400e00180000
0, 11
Parall_iter 1, Write new metadata at address 0x400e00200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 103, parall_iter is 1, num_threads is 1, last counter is 11, curr_counter is 12
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401460410000, curr_pr_arr is 0x401460410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401460410000!
Thread ID: 2, savenvm_thread_nd took 8395.484996 ms
Thread ID: 2, set_cpu took 0.068126 ms
Threads took 8415.639827 ms
MSYNC 27382015120 TOOK 20.920602 ms
CAS was successful! new counter is 12, is_distributed is 0
******** checkp_info saved in 0x400e00200000, curr_checkpoint is 0x400e00200000
1, 12
Parall_iter 0, Write new metadata at address 0x400e00180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 125, parall_iter is 0, num_threads is 1, last counter is 12, curr_counter is 13
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e00280000, curr_pr_arr is 0x400e00280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e00280000!
Thread ID: 1, savenvm_thread_nd took 8237.992381 ms
Thread ID: 1, set_cpu took 0.062655 ms
Threads took 8258.143183 ms
MSYNC 27382015120 TOOK 18.236137 ms
CAS was successful! new counter is 13, is_distributed is 0
******** checkp_info saved in 0x400e00180000, curr_checkpoint is 0x400e00180000
0, 13
Parall_iter 1, Write new metadata at address 0x400e00200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 21, parall_iter is 1, num_threads is 1, last counter is 13, curr_counter is 14
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401460410000, curr_pr_arr is 0x401460410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401460410000!
Thread ID: 2, savenvm_thread_nd took 8320.134262 ms
Thread ID: 2, set_cpu took 0.072542 ms
Threads took 8340.294503 ms
MSYNC 27382015120 TOOK 18.345318 ms
CAS was successful! new counter is 14, is_distributed is 0
******** checkp_info saved in 0x400e00200000, curr_checkpoint is 0x400e00200000
1, 14
Parall_iter 0, Write new metadata at address 0x400e00180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 48, parall_iter is 0, num_threads is 1, last counter is 14, curr_counter is 15
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e00280000, curr_pr_arr is 0x400e00280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e00280000!
Thread ID: 1, savenvm_thread_nd took 8294.167023 ms
Thread ID: 1, set_cpu took 0.068638 ms
Threads took 8314.320769 ms
MSYNC 27382015120 TOOK 22.223412 ms
CAS was successful! new counter is 15, is_distributed is 0
******** checkp_info saved in 0x400e00180000, curr_checkpoint is 0x400e00180000
0, 15
Parall_iter 1, Write new metadata at address 0x400e00200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 51, parall_iter is 1, num_threads is 1, last counter is 15, curr_counter is 16
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401460410000, curr_pr_arr is 0x401460410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401460410000!
Thread ID: 2, savenvm_thread_nd took 8346.806280 ms
Thread ID: 2, set_cpu took 0.068254 ms
Threads took 8366.960794 ms
MSYNC 27382015120 TOOK 17.321668 ms
CAS was successful! new counter is 16, is_distributed is 0
******** checkp_info saved in 0x400e00200000, curr_checkpoint is 0x400e00200000
1, 16
Parall_iter 0, Write new metadata at address 0x400e00180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 93, parall_iter is 0, num_threads is 1, last counter is 16, curr_counter is 17
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e00280000, curr_pr_arr is 0x400e00280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e00280000!
Thread ID: 1, savenvm_thread_nd took 8169.180604 ms
Thread ID: 1, set_cpu took 0.066174 ms
Threads took 8189.320303 ms
MSYNC 27382015120 TOOK 18.620383 ms
CAS was successful! new counter is 17, is_distributed is 0
******** checkp_info saved in 0x400e00180000, curr_checkpoint is 0x400e00180000
0, 17
Parall_iter 1, Write new metadata at address 0x400e00200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 122, parall_iter is 1, num_threads is 1, last counter is 17, curr_counter is 18
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401460410000, curr_pr_arr is 0x401460410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401460410000!
Thread ID: 2, savenvm_thread_nd took 8326.211108 ms
Thread ID: 2, set_cpu took 0.064030 ms
Threads took 8346.367990 ms
MSYNC 27382015120 TOOK 16.973550 ms
CAS was successful! new counter is 18, is_distributed is 0
******** checkp_info saved in 0x400e00200000, curr_checkpoint is 0x400e00200000
1, 18
Parall_iter 0, Write new metadata at address 0x400e00180000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 21, parall_iter is 0, num_threads is 1, last counter is 18, curr_counter is 19
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x400e00280000, curr_pr_arr is 0x400e00280000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x400e002025-05-22 21:52:12,045 - root - INFO - Step: 385 | Loss: 9.24 | Tokens per second: 1555.92 | Training tokens per second (%): 34.22 | MFU (%): 2.15 | TFLOPs: 21.30
2025-05-22 21:52:12,700 - root - INFO - Step: 390 | Loss: 9.03 | Tokens per second: 15712.83 | Training tokens per second (%): 41.74 | MFU (%): 21.75 | TFLOPs: 215.12
2025-05-22 21:52:13,355 - root - INFO - Step: 395 | Loss: 9.32 | Tokens per second: 15712.40 | Training tokens per second (%): 45.66 | MFU (%): 21.75 | TFLOPs: 215.12
2025-05-22 21:52:14,021 - root - INFO - Step: 400 | Loss: 8.91 | Tokens per second: 15428.00 | Training tokens per second (%): 36.79 | MFU (%): 21.36 | TFLOPs: 211.22
2025-05-22 21:52:14,086 - root - INFO - Random states checkpoint saved to ./checkpointing/checkpoints/rng_states.pt
2025-05-22 21:52:14,088 - root - INFO - Checkpoint saved to ./checkpointing/checkpoints
total_size: 6845503780, bsize: 6845503780, ratio: 2.0
6845503780 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 195.451021194458 ms
CPU copy took 10164.426803588867 ms
---------------------- [PERF] Single Checkpoint time is 10.379511594772339 sec, average is 10.379508018493652
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 198.45151901245117 ms
CPU copy took 10150.609493255615 ms
---------------------- [PERF] Single Checkpoint time is 10.349593877792358 sec, average is 10.36454975605011
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 197.7088451385498 ms
CPU copy took 8274.930953979492 ms
---------------------- [PERF] Single Checkpoint time is 8.473180294036865 sec, average is 10.349591493606567
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 199.66554641723633 ms
CPU copy took 8343.581438064575 ms
---------------------- [PERF] Single Checkpoint time is 8.543922662734985 sec, average is 9.446756720542908
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 199.61881637573242 ms
CPU copy took 8224.884510040283 ms
---------------------- [PERF] Single Checkpoint time is 8.425009965896606 sec, average is 8.543921947479248
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 198.6687183380127 ms
CPU copy took 8371.732711791992 ms
---------------------- [PERF] Single Checkpoint time is 8.570825338363647 sec, average is 8.557372808456421
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 198.1942653656006 ms
CPU copy took 8223.673582077026 ms
---------------------- [PERF] Single Checkpoint time is 8.422406911849976 sec, average is 8.543921947479248
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 199.38969612121582 ms
CPU copy took 8398.131132125854 ms
---------------------- [PERF] Single Checkpoint time is 8.59800124168396 sec, average is 8.557372808456421
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 199.8922824859619 ms
CPU copy took 8260.103464126587 ms
---------------------- [PERF] Single Checkpoint time is 8.460519075393677 sec, average is 8.543921947479248
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 199.4302272796631 ms
CPU copy took 8411.960363388062 ms
---------------------- [PERF] Single Checkpoint time is 8.611762046813965 sec, average is 8.557372808456421
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 199.38206672668457 ms
CPU copy took 8224.180936813354 ms
---------------------- [PERF] Single Checkpoint time is 8.423950672149658 sec, average is 8.543921947479248
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 199.85365867614746 ms
CPU copy took 8459.08236503601 ms
---------------------- [PERF] Single Checkpoint time is 8.659380435943604 sec, average is 8.557372808456421
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 199.91636276245117 ms
CPU copy took 8298.681735992432 ms
---------------------- [PERF] Single Checkpoint time is 8.498961687088013 sec, average is 8.543921947479248
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 199.62215423583984 ms
CPU copy took 8381.617069244385 ms
---------------------- [PERF] Single Checkpoint time is 8.581632852554321 sec, average is 8.557372808456421
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 196.17390632629395 ms
CPU copy took 8360.806941986084 ms
---------------------- [PERF] Single Checkpoint time is 8.557325839996338 sec, average is 8.557324409484863
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 199.8593807220459 ms
CPU copy took 8406.663179397583 ms
---------------------- [PERF] Single Checkpoint time is 8.607050895690918 sec, average is 8.564074039459229
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 200.0718116760254 ms
CPU copy took 8232.31029510498 ms
---------------------- [PERF] Single Checkpoint time is 8.432835102081299 sec, average is 8.557324409484863
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 198.35281372070312 ms
CPU copy took 8385.951042175293 ms
---------------------- [PERF] Single Checkpoint time is 8.584813833236694 sec, average is 8.564074039459229
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 198.34423065185547 ms
CPU copy took 8294.947624206543 ms
---------------------- [PERF] Single Checkpoint time is 8.49371337890625 sec, average is 8.557324409484863
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 194.0324306488037 ms
CPU copy took 8401.827096939087 ms
---------------------- [PERF] Single Checkpoint time is 8.59620189666748 sec, average is 8.564074039459229
---- exit
280000!
Thread ID: 1, savenvm_thread_nd took 8250.477903 ms
Thread ID: 1, set_cpu took 0.063486 ms
Threads took 8272.430988 ms
MSYNC 27382015120 TOOK 17.101387 ms
CAS was successful! new counter is 19, is_distributed is 0
******** checkp_info saved in 0x400e00180000, curr_checkpoint is 0x400e00180000
0, 19
Parall_iter 1, Write new metadata at address 0x400e00200000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 42, parall_iter is 1, num_threads is 1, last counter is 19, curr_counter is 20
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401460410000, curr_pr_arr is 0x401460410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401460410000!
Thread ID: 2, savenvm_thread_nd took 8383.809870 ms
Thread ID: 2, set_cpu took 0.080381 ms
Threads took 8384.045767 ms
MSYNC 27382015120 TOOK 17.404706 ms
CAS was successful! new counter is 20, is_distributed is 0
******** checkp_info saved in 0x400e00200000, curr_checkpoint is 0x400e00200000
1, 20
2025-05-22 21:52:30,293 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
PCCHECK duration: 218 s
==== PCCHECK END ====
---- Total for bf16 / 2048: 448 s ----

Benchmarking complete in 1784 s
